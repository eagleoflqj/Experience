# C++ Primer
## 1
* é»˜è®¤`cerr`å’Œ`clog`å®šå‘è‡³æ ‡å‡†é”™è¯¯ï¼›`cerr`ä¸ç¼“å†²ï¼Œ`clog`ç¼“å†²
* `endl`æ¢è¡Œå¹¶åˆ·æ–°ç¼“å†²åŒºï¼Œä¿è¯ç¨‹åºå´©æºƒæ—¶ä¸ä¸¢å¤±è¾“å‡º
* æ ‡å‡†åº“å®šä¹‰çš„åç§°å…¨éƒ¨ä½äº`std`å‘½åç©ºé—´
* `if(cin >> value)`æ£€æµ‹æµçŠ¶æ€ï¼Œå½“é‡åˆ°EOFæˆ–éæ³•è¾“å…¥æ—¶æ¡ä»¶ä¸ºå‡
* æ— åˆå€¼å®ä¾‹åˆå§‹åŒ–ç”±ç±»å†³å®šï¼Œæ— åˆå€¼å±€éƒ¨è‡ªåŠ¨å†…ç½®ç±»å‹å˜é‡åˆå€¼æœªå®šä¹‰
## 2
### å†…ç½®ç±»å‹
* `wchar_t`è‡³å°‘2å­—èŠ‚ï¼Œä¿è¯èƒ½è¦†ç›–æœºå™¨çš„æœ€å¤§å­—ç¬¦é›†ï¼ˆUnicode 4å­—èŠ‚ï¼‰ï¼Œliteralå‰ç¼€`L`
* `char16_t`ã€`char32_t`å­˜å‚¨Unicodeå­—èŠ‚ï¼Œliteralå‰ç¼€ä¸º`u`ã€`U`
* `long double`ä¸€èˆ¬ç”¨äºä¸“ç”¨æµ®ç‚¹ç¡¬ä»¶
* å¯¹`bool`èµ‹éé›¶å€¼ç»“æœä¸º`true`
* å¯¹æ— ç¬¦å·ç±»å‹è¶…èŒƒå›´èµ‹å€¼å¯¼è‡´å–æ¨¡ï¼Œå¯¹æœ‰ç¬¦å·ç±»å‹è¶…èŒƒå›´èµ‹å€¼ç»“æœæœªå®šä¹‰
* decimal literalç±»å‹ä¸º`int`ã€`long`ã€`long long`ä¸­æœ€å°èƒ½å®¹çº³å…¶å€¼çš„ï¼Œoctalã€hex literalç±»å‹ä¸º`int`ã€`unsigned`ã€`long`ã€`unsigned long`ã€`long long`ã€`unsigned long long`ä¸­æœ€å°èƒ½å®¹çº³å…¶å€¼çš„
* string literalçš„ç±»å‹ä¸º`const char []`

ğŸ˜€ï¼ˆU+1F600ï¼‰çš„å‰ç¼€|å¯èƒ½çš„å­—ç¬¦sizeof|å¯èƒ½çš„å­—ç¬¦ä¸²sizeof
-|-|-
æ— |æº¢å‡º|5
u8|éæ³•|5
L|4|8
u|æº¢å‡º|6
U|4|8
### åˆ—è¡¨åˆå§‹åŒ–
```cpp
int a = 0;
int a(0);
int a = {0};
int a{0};
```
* åä¸¤ç§æ–¹å¼ï¼Œè‹¥åˆå€¼è½¬æ¢ä¸ºç±»å‹å¯èƒ½ä¸¢å¤±ç²¾åº¦ï¼Œç¼–è¯‘å™¨å°†æŠ¥é”™
### å…¨å±€å˜é‡
* å…¨å±€`int a;`ä¸ºå®šä¹‰ï¼Œå£°æ˜å¿…é¡»åŠ `extern`
* ä¸ºé¿å…ä¸æ ‡å‡†åº“çš„åç§°å†²çªï¼Œæ ‡è¯†ç¬¦ä¸åº”åŒ…å«ä¸¤ä¸ªè¿ç»­çš„`_`ï¼Œä¸åº”ä»¥`_`+å¤§å†™å­—æ¯å¼€å¤´ï¼Œå…¨å±€å˜é‡ä¸åº”ä»¥`_`å¼€å¤´
* `::å˜é‡`å–åŒåå…¨å±€å˜é‡
* å…¨å±€`const`é»˜è®¤æ–‡ä»¶ä½œç”¨åŸŸï¼Œ`extern const`å®šä¹‰å…¨å±€ä½œç”¨åŸŸ
* å¯ä»¥è°ƒç”¨å‡½æ•°åˆå§‹åŒ–å…¨å±€å˜é‡ï¼Œä½†è‹¥å‡½æ•°æœ‰çŠ¶æ€ï¼Œä¸åŒç¼–è¯‘å•å…ƒå†…çš„å…¨å±€å˜é‡å€¼ä¸ç¡®å®šï¼ˆåˆå§‹åŒ–é¡ºåºä¸ç¡®å®šï¼‰
### å¼•ç”¨å’ŒæŒ‡é’ˆ
* `int &ref = var;`å¼•ç”¨ä¸å¯æ›´æ”¹ç»‘å®šï¼Œå¿…é¡»è¢«åˆå§‹åŒ–
* å¼•ç”¨ä¸æ˜¯å¯¹è±¡ï¼Œåªæ˜¯å¦ä¸€ä¸ªå˜é‡çš„åˆ«åï¼Œæ‰€ä»¥ä¸èƒ½å®šä¹‰å¼•ç”¨çš„å¼•ç”¨ã€å¼•ç”¨çš„æŒ‡é’ˆ
* æŒ‡é’ˆå€¼å¯ä¸ºå˜é‡åœ°å€ã€å˜é‡åçš„ä½ç½®ã€`nullptr`ã€æ— æ•ˆå€¼ï¼Œåä¸‰è€…æ—¶è§£å¼•ç”¨ç»“æœæœªå®šä¹‰
### const
* é`const &`åªèƒ½ç»‘å®šåŒ¹é…ç±»å‹çš„å˜é‡
* `const &`å¯ä»¥ç»‘å®šåˆ°ä»»ä½•èƒ½è½¬æ¢æˆå¯¹åº”ç±»å‹çš„è¡¨è¾¾å¼ï¼Œæ­¤æ—¶ç»‘å®šçš„æ˜¯ä¸€ä¸ªä¸´æ—¶å¯¹è±¡
* `const &`å¯ä»¥ç»‘å®šåˆ°å¯¹åº”ç±»å‹çš„æ™®é€šå˜é‡ï¼Œæ­¤æ—¶å¯¹å˜é‡çš„ä¿®æ”¹å¯ä»¥ååº”åˆ°å¼•ç”¨ä¸Š
* é¡¶å±‚`const`ï¼šä¸å¯ä¿®æ”¹å†…å­˜å€¼ï¼›åº•å±‚`const`ï¼šä¸å¯ä¿®æ”¹æŒ‡å‘çš„å†…å­˜å€¼
* `l = r`å¯¹è±¡å¤åˆ¶æ—¶`r`çš„é¡¶å±‚`const`å±æ€§è¢«å¿½ç•¥ï¼Œåº•å±‚`const`å±æ€§ä¸å¯å¿½ç•¥
### constexpr
* å¸¸é‡è¡¨è¾¾å¼ï¼š`const`ä¸”ç¼–è¯‘æœŸå€¼ç¡®å®š
* `constexpr int a = å¸¸é‡è¡¨è¾¾å¼`ï¼Œ`a`å¯ç”¨äºéœ€è¦å¸¸é‡è¡¨è¾¾å¼çš„åœ°æ–¹ï¼Œ`constexpr`å¯¼è‡´é¡¶å±‚`const`
* å¸¸é‡è¡¨è¾¾å¼å¿…é¡»ä¸ºå­—é¢ç±»å‹ï¼šå¯ä»¥æ˜¯ç®—æœ¯ç±»å‹ã€æŒ‡é’ˆã€å¼•ç”¨ã€å­—é¢ç±»ï¼Œä½†æŒ‡é’ˆ/å¼•ç”¨å¿…é¡»æŒ‡å‘/ç»‘å®šåˆ°å›ºå®šåœ°å€
### åˆ«å
```c++
typedef int i_t, *p_t; // å®šä¹‰äº†intå’Œint*çš„åˆ«å
const p_t p; // int *const p;
const p_t *pp; // int *const *pp;
using integer = int;
```
### auto
* `auto [ä¿®é¥°ç¬¦1]å˜é‡1 = åˆå€¼1[, ...];`
* åˆå€¼åº”å…·æœ‰ç›¸åŒåŸºæœ¬ç±»å‹
* `auto`ä¸€èˆ¬å¿½ç•¥åˆå€¼çš„å¼•ç”¨ç±»å‹å’Œé¡¶å±‚`const`å±æ€§
* `auto &`ä¿ç•™åˆå€¼çš„é¡¶å±‚`const`å±æ€§
* `const auto`å£°æ˜é¡¶å±‚`const`
```c++
const int ci = 0;
auto &r1 = ci; // const int &r1 = ci;
// auto &r2 = 0; // é”™è¯¯ï¼š0æ¨æ–­ä¸ºintï¼Œä½†int&ä¸å¯ç»‘å®šå¸¸é‡ï¼Œéœ€è¦const auto &r2 = 0;
```
### decltype
* `decltype(è¡¨è¾¾å¼) [ä¿®é¥°ç¬¦1]å˜é‡1[ = åˆå€¼1][, ...];`æ¨æ–­ç±»å‹ä½†ä¸æ±‚å€¼
* `decltype(å˜é‡)`ä¿ç•™å˜é‡çš„å¼•ç”¨ç±»å‹å’Œé¡¶å±‚`const`ï¼Œè¿™æ˜¯ä½¿ç”¨å¼•ç”¨ä¸ä½œä¸ºå˜é‡åˆ«åçš„å”¯ä¸€åœºæ™¯
* `decltype(éå˜é‡çš„è¡¨è¾¾å¼)`è‹¥ä¸ºå·¦å€¼åˆ™ä¸ºå¼•ç”¨ç±»å‹
```c++
const int a = 0, &r = a, *p = &a;
decltype(a) b = 0; // const int b = 0;
decltype(r) c = a; // const int &c = a;
decltype((a)) d = a; // const int &d = a;
decltype(*p) e = a; // const int &e = a;
```
* `=`èµ‹å€¼è¡¨è¾¾å¼è¿”å›å·¦å€¼
### struct
* ç±»å†…åˆå§‹åŒ–å¯ä»¥ä½¿ç”¨`=`æˆ–`{}`ï¼Œä¸å¯ä½¿ç”¨`()`
## 3
### using
* `using std::cin;`
* å¤´æ–‡ä»¶ä¸åº”åŒ…å«`using`
### stringæ„é€ 
```c++
#include <string>
string s1; // ""
string s2(s1); // å¤åˆ¶s1
string s2 = s1; // ç­‰ä»·
string s3("a"); // å¤åˆ¶å­—ç¬¦ä¸²å¸¸é‡
string s3 = "a"; // ç­‰ä»·
string s4(3, 'a'); // "aaa"
string s4 = string(3, 'a'); // ç­‰ä»·
```
### stringæ“ä½œ
```c++
os << s
is >> s // éç©ºç™½å­—ç¬¦ä¸²
getline(is, s) // ä¸ä¿å­˜'\n'ï¼Œè¿”å›is
s.empty()
string::size_type s.size() // å­—èŠ‚æ•°
s[n] // n >= 0 && n < s.size()ï¼Œå¦åˆ™ç»“æœæœªå®šä¹‰
s1 + s2
s1 = s2 // æ·±æ‹·è´
s1 == s2
!=, <, <=, >, >=
```
* ä½¿ç”¨`cname`ç‰ˆæœ¬çš„Cåº“ï¼ˆå‡½æ•°ä½äº`std`ï¼‰ï¼Œè€Œä¸æ˜¯`name.h`
```c++
for (auto c : s) // å¤åˆ¶
for (auto &c : s) // å¯ä¿®æ”¹
for (decltype(s.size()) i = 0; i != s.size(); ++i)
```
### vectoræ„é€ 
```c++
#include <vector>
vector<vector<string>> vv;
vector<int> v1; // ç©ºå‘é‡
vector<int> v2(v1);
vector<int> v2 = v1; // ç­‰ä»·
vector<int> v3 = {3, 1};
vector<int> v3{3, 1}; // ç­‰ä»·
vector<int> v4(3, 1); // {1, 1, 1}ï¼›æ„é€ åˆå§‹åŒ–
vector<int> v5(2); // {0, 0}ï¼›å€¼åˆå§‹åŒ–
vector<int> v6{2}; // {2}ï¼›å°è¯•è§£é‡Šä¸ºåˆ—è¡¨åˆå§‹åŒ–
vector<string> v7{2, "1"}; // {"1", "1"}ï¼›æ— æ³•è§£é‡Šä¸ºåˆ—è¡¨åˆå§‹åŒ–ï¼Œå°è¯•è§£é‡Šä¸ºæ„é€ åˆå§‹åŒ–
vector<string> v7 = {2, "1"}; // ç­‰ä»·
```
* å€¼åˆå§‹åŒ–ï¼šç±»å¯¹è±¡è‹¥æœ‰åˆæˆé»˜è®¤æ„é€ å‡½æ•°åˆ™é›¶åˆå§‹åŒ–åé»˜è®¤åˆå§‹åŒ–ï¼Œå¦åˆ™é»˜è®¤åˆå§‹åŒ–ï¼›æ•°ç»„å¯¹è±¡çš„æ¯ä¸ªå…ƒç´ å€¼åˆå§‹åŒ–ï¼›å…¶ä»–å¯¹è±¡é›¶åˆå§‹åŒ–
### vectoræ“ä½œ
```c++
v1.push_back(1);
v.empty()
vector<int>::size_type v1.size()
v[n]
v1 = v2 // æ·±æ‹·è´
v = {1, 2} // ç”¨å…ƒç´ çš„å‰¯æœ¬é‡å»ºå‘é‡
v1 == v2 // é•¿åº¦ç›¸åŒï¼Œå¯¹åº”å…ƒç´ ç›¸ç­‰ï¼ˆéœ€è¦å…ƒç´ ç±»å‹æ”¯æŒæ¯”è¾ƒï¼Œä¸‹åŒï¼‰
v1 != v2
<, <=, >, >= // å­—å…¸åº
```
* ä¸ºäº†æ•ˆç‡ä¸åº”æŒ‡å®šå‘é‡åˆå§‹å¤§å°ï¼Œé™¤éæ‰€æœ‰å…ƒç´ å€¼ç›¸åŒ
* å¯¹å‘é‡èŒƒå›´foræ—¶ä¸å¯å¢åˆ å…ƒç´ 
### è¿­ä»£å™¨
* åˆæ³•è¿­ä»£å™¨æŒ‡å‘å…ƒç´ æˆ–å…¶åçš„ä½ç½®
* ä½¿ç”¨è¿­ä»£å™¨æ—¶ä¸å¯å¢åˆ å…ƒç´ 
```c++
auto b = v.begin(), e = v.end(); // b == eç­‰ä»·äºvç©º
*iter
iter->æˆå‘˜
++iter
--iter
iter1 == iter2
iter1 != iter2
```
### è¿­ä»£å™¨ç±»å‹
```c++
vector<int>::iterator it1;
vector<int>::const_iterator it2; // åªè¯»
vector<int> v;
const vector<int> cv;
auto it3 = v.cbegin(), it4 = cv.begin(); // vector<int>::const_iterator
```
### vectorå’Œstringçš„è¿­ä»£å™¨ç®—æœ¯
```c++
iter + n
iter - n
iter += n
iter -= n
?::difference_type iter1 - iter2 // æœ‰ç¬¦å·
<, <=, >, >=
```
### äºŒåˆ†æœç´¢
```c++
auto beg = v.begin(), end = v.end();
auto mid = beg + (end - beg) / 2;
while (mid != end && *mid != value) {
    if (*mid < value)
        beg = mid + 1;
    else
        end = mid;
    mid = beg + (end - beg) / 2;
}
```
### æ•°ç»„
* ä¸å¯ç”¨`auto`å£°æ˜
* é•¿åº¦å¿…é¡»ä¸ºæ­£çš„å¸¸é‡è¡¨è¾¾å¼
* é»˜è®¤åˆå§‹åŒ–ï¼šå†…ç½®ç±»å‹å˜é‡åˆå€¼æœªå®šä¹‰ï¼Œç±»å˜é‡è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°
* å±€éƒ¨éé™æ€æ•°ç»„ï¼Œæ— åˆå€¼åˆ™å…ƒç´ é»˜è®¤åˆå§‹åŒ–
```c++
int a[3] = {}; // {0, 0, 0}ï¼›å€¼åˆå§‹åŒ–
int (*pa)[3] = &a;
int (&ra)[3] = a;
auto b(a); // int *
decltype(a) c; // int[3]
int *beg = begin(a), *last = end(a);
ptrdiff_t diff = end - beg;
```
* `size_t`ã€`ptrdiff_t`ä½äº`cstddef`
* æ•°ç»„å¯ä»¥ä½¿ç”¨èŒƒå›´for
* å†…ç½®ç±»å‹`[]`å¯ä»¥æ¥å—è´Ÿä¸‹æ ‡ï¼Œåº“ç±»å‹`[]`åªæ¥å—éè´Ÿä¸‹æ ‡
### æ—§ä»£ç æ¥å£
```c++
string s;
char c_s[] = "hi";
s = c_s
s += c_s;
const char *p = s.c_str(); // å¯¹sçš„åç»­ä¿®æ”¹å¯èƒ½ä¼šä½¿pæ— æ•ˆ
strlen(p) == s.size(); // så†…éƒ¨æœ‰'\0'æ—¶ä¸ç­‰
```
* C++11ä¿è¯`string`è¿ç»­å­˜å‚¨ä¸”ä»¥'\0'ç»“å°¾
```c++
int a[] = {0, 1, 2, 3, 4};
vector<int> v(a + 1, a + 3); // {1, 2}
```
### é«˜ç»´æ•°ç»„
```c++
int a[3][2][1] = {{1}, {2}, {3}}; // {1, 0, 2, 0, 3, 0}
for (auto &row : a) // int (&row)[2][1]
for (auto row : a) // int (*row)[1]ï¼Œä¸‹ä¸€å±‚æ— æ³•èŒƒå›´for
```
## 4
### è¿ç®—ç¬¦
* å‰ç½®`++`ã€`--`è¿”å›å·¦å€¼ï¼Œåç½®è¿”å›å³å€¼ï¼ˆç±»å¯¹è±¡å¯èƒ½æœ‰æ€§èƒ½æŸå¤±ï¼‰
* `&&`ã€`||`ã€`?:`ã€`,`è§„å®šæ±‚å€¼é¡ºåº
* æ±‚å€¼é¡ºåºç‹¬ç«‹äºä¼˜å…ˆçº§ã€ç»“åˆå¾‹
* `m/n`å‘0å–æ•´ï¼Œ`m%n`å’Œ`m`åŒå·
```c++
int i;
i = {1};
string s = "s";
// i = {3.14}; // é”™è¯¯ï¼Œä¸¢å¤±ç²¾åº¦
i = {}; // 0ï¼›ç±»ä¼¼å€¼åˆå§‹åŒ–ï¼Œä¸‹åŒ
s = {}; // ""
```
* `?:`çš„ä¸¤ä¸ªç»“æœè¡¨è¾¾å¼éƒ½æ˜¯å·¦å€¼æ—¶è¿”å›å·¦å€¼
* æœ‰ç¬¦å·æ•°å³ç§»æ—¶ç¬¦å·ä½çš„å¤„ç†æœºå™¨ç›¸å…³ï¼Œå·¦ç§»æ—¶æ”¹å˜ç¬¦å·ä½ç»“æœæœªå®šä¹‰
```c++
sizeof char == 1 // size_t
sizeof(int) == sizeof(int&)
int i, *p;
sizeof i
sizeof *p // ä¸æ±‚å€¼
sizeof ç±»::å­—æ®µ
char a[10];
sizeof(1, a) // 10ï¼š,è¡¨è¾¾å¼å¦‚æœå³ä¾§æ˜¯å·¦å€¼åˆ™ç»“æœä¸ºå·¦å€¼
```
### éšå¼ç±»å‹è½¬æ¢
* å°æ•´å‹å¦‚æœæ­£å€¼èŒƒå›´åŒ…å«äº`int`åˆ™è¿ç®—æ—¶æå‡ä¸º`int`ï¼Œå¦åˆ™ä¸º`unsigned`
* `wchar_t`ã€`char16_t`ã€`char32_t`æŒ‰æ­£å€¼èŒƒå›´æå‡åˆ°`int`ã€`unsigned`ã€`long`ã€`unsigned long`ã€`long long`ã€`unsigned long long`ä¸­æœ€å°çš„
* å°unsignedå’Œå¤§signedç›¸é‡ï¼Œè‹¥unsignedèŒƒå›´åŒ…å«äºsignedï¼ˆLinux amd64çš„unsignedå’Œlong longï¼‰åˆ™è½¬æ¢ä¸ºå¤§signedï¼Œå¦åˆ™ï¼ˆLinux amd64çš„unsigned longå’Œlong longï¼‰éƒ½è½¬æ¢ä¸ºå¤§unsigned
### æ˜¾å¼ç±»å‹è½¬æ¢
* `è½¬æ¢å<ç±»å‹>(è¡¨è¾¾å¼)`ï¼Œç±»å‹ä¸ºå¼•ç”¨æ—¶ç»“æœä¸ºå·¦å€¼
* `static_cast`è½¬æ¢æ•°å€¼ç±»å‹ï¼Œæˆ–æŠŠ`void *`è½¬æˆå…·ä½“ç±»å‹ï¼ˆå¿…é¡»å®é™…ä¸ºè¯¥ç±»å‹ï¼Œå¦åˆ™ç»“æœæœªå®šä¹‰ï¼‰
* `const_cast`ä»…å¯ç”¨äºä¿®æ”¹åº•å±‚`const`ï¼Œä½†è‹¥å¯¹è±¡æœ¬èº«ä¸º`const`ï¼Œå¯¹å…¶å†™å…¥ç»“æœæœªå®šä¹‰ï¼›å…¶ä»–castä¸å¯ä¿®æ”¹åº•å±‚`const`
* `reinterpret_cast`ä¿ç•™åº•å±‚bitï¼Œè½¬æ¢è§£é‡Šæ–¹å¼
* `const_cast`ä¸»è¦ç”¨äºé‡è½½å‡½æ•°ï¼Œæ…ç”¨`reinterpret_cast`
* æ—§å¼ç±»å‹è½¬æ¢å°è¯•`const_cast`æˆ–`static_cast`ï¼Œè‹¥éƒ½ä¸åˆæ³•åˆ™é‡‡ç”¨`reinterpret_cast`
```c++
int i;
char *p = (char *)&i; // reinterpret_cast<char *>
```
## 5
```c++
if (int i = get_num()) { // whileã€switch
    // å¯ä½¿ç”¨i
} else {
    // å¯ä½¿ç”¨i
}
```
* `switch`éæœ€åä¸€ä¸ªåˆ†æ”¯ä¸å¯ä»¥åˆå§‹åŒ–ï¼ˆåŒ…æ‹¬é»˜è®¤åˆå§‹åŒ–ï¼‰å˜é‡ï¼Œåªå¯ä»¥å£°æ˜ï¼›è‹¥åˆå§‹åŒ–å˜é‡åˆ™éœ€åŒ…å«åœ¨`{}`
* `do while`æ¡ä»¶ä¸å¯å®šä¹‰å˜é‡ï¼Œå‡ºç°çš„å˜é‡å¿…é¡»åœ¨å¾ªç¯ä½“å¤–å®šä¹‰
* `goto`çš„æ ‡ç­¾å’Œå…¶ä»–æ ‡è¯†ç¬¦ä¸å†²çªï¼ŒåŒ`switch`ä¸€æ ·`goto`ä¸å¯è·³è¿‡å˜é‡åˆå§‹åŒ–åˆ°è¾¾å˜é‡ä½œç”¨åŸŸå†…
### å¼‚å¸¸
```c++
try {
    int i;
    throw std::runtime_error("reason");
} catch (std::runtime_error err) {
    cout << err.what(); // const char *
} catch (std::exception) { // åŸºç±»å¼‚å¸¸é å
    // ä¸å¯ä½¿ç”¨i
}
```
* è‹¥å¼‚å¸¸æœ€ç»ˆä¸è¢«æ•è·ï¼Œè‡ªåŠ¨è°ƒç”¨åº“å‡½æ•°`terminate`ï¼ˆ`exception`å¤´æ–‡ä»¶å®šä¹‰ï¼‰ç»ˆæ­¢ç¨‹åº
* `exception`å¤´æ–‡ä»¶å®šä¹‰åŸºç±»`exception`
* `stdexcept`å¤´æ–‡ä»¶å®šä¹‰`runtime_error`ã€`logic_error`åŠå…¶æ´¾ç”Ÿç±»

runtime_erroræ´¾ç”Ÿç±»|æ„ä¹‰|æ ‡å‡†åº“ç¤ºä¾‹
-|-|-
range_error|ç»“æœè¶…å‡ºæœ‰æ„ä¹‰èŒƒå›´|`wstring_convert::from_bytes`, `wstring_convert::to_bytes`
overflow_error|ç»“æœä¸Šæº¢|`bitset::to_ulong`, `bitset::to_ullong`
underflow_error|ç»“æœä¸‹æº¢|æ— 

logic_erroræ´¾ç”Ÿç±»|æ„ä¹‰|æ ‡å‡†åº“ç¤ºä¾‹
-|-|-
domain_error|å‚æ•°ä¸åœ¨å®šä¹‰åŸŸ|æ— 
invalid_argument|éæ³•å‚æ•°|`stoi("x")`
length_error|è¯•å›¾åˆ›å»ºè¶…é•¿å¯¹è±¡|`v.reserve(v.max_size() + 1)`
out_of_range|å‚æ•°è¶…é™|`stoi("2147483648")`
* `new`å¤´æ–‡ä»¶å®šä¹‰`bad_alloc`
* `type_info`å¤´æ–‡ä»¶å®šä¹‰`bad_cast`
* `exception`ã€`bad_alloc`ã€`bad_cast`åªèƒ½é»˜è®¤åˆå§‹åŒ–ï¼ˆ`what`è¿”å›å€¼ç”±ç¼–è¯‘å™¨å†³å®šï¼‰ï¼Œå…¶ä»–å¼‚å¸¸åªèƒ½ç”¨å­—ç¬¦ä¸²æˆ–å­—ç¬¦æ•°ç»„åˆå§‹åŒ–
## 6
### å‚æ•°
* å½¢å‚å¯ä»¥ä¸å‘½å
* å±€éƒ¨é™æ€å˜é‡åœ¨æ§åˆ¶æµç¬¬ä¸€æ¬¡åˆ°è¾¾å…¶å®šä¹‰å‰åˆå§‹åŒ–
* åœ¨å‡½æ•°å†…ä¸æ›´æ”¹çš„å¼•ç”¨å‚æ•°åº”å£°æ˜ä¸ºå¸¸å¼•ç”¨ï¼ŒæŒ‡é’ˆåŒç†
* `argv[0]`å¯èƒ½ä¸º`""`
### initializer_list
```c++
#include <initializer_list>
initializer_list<int> l1; // ç©ºåˆ—è¡¨
auto l2 = {1, 2, 3};
auto l3(l2); // ä¸å¤åˆ¶å…ƒç´ ï¼Œä¸‹åŒ
l1 = l2
const int *beg = l1.begin(), *last = l1.end();
void f(initializer_list<string> l, int i) {
    for(auto &s : l)
        cout << s;
}
f({"1", "2", "3"}, 1);
```
### è¿”å›å€¼
* voidå‡½æ•°`return`åçš„è¡¨è¾¾å¼åªèƒ½ä¸ºvoidå‡½æ•°çš„è°ƒç”¨
* ç¼–è¯‘å™¨å¯èƒ½æ— æ³•æ£€æµ‹évoidå‡½æ•°ç»“å°¾æœ‰`return`
* ä¸å¯è¿”å›å±€éƒ¨å¯¹è±¡çš„æŒ‡é’ˆï¼ˆå¦‚ä¸´æ—¶çš„`initializer_list`ï¼‰æˆ–å¼•ç”¨
* å¼•ç”¨è¿”å›å€¼æ˜¯å·¦å€¼ï¼Œå…¶ä»–ä¸ºå³å€¼
```c++
vector<int> f() {
    return {1, 2, 3}; // è¿”å›ç±»å¯¹è±¡ï¼Œç±»å†³å®šåˆå§‹åŒ–åˆ—è¡¨çš„è§£é‡Šæ–¹å¼
}
int g() {
    return {3}; // ä¸å¯ä»¥{3.0}
}
```
* `main`å¯ä¸è¿”å›å€¼ï¼Œé»˜è®¤è¿”å›0
```c++
int a[3];
int (*f(int i))[3];
auto f(int i) -> int (*)[3];
decltype(a) *f(int i);
```
### å‡½æ•°é‡è½½
* ä¸å¯å®šä¹‰ä»…è¿”å›å€¼ä¸åŒçš„é‡è½½å‡½æ•°
* ä¸åŒºåˆ†å‚æ•°é¡¶å±‚`const`ï¼ŒåŒºåˆ†åº•å±‚`const`
* éåº•å±‚`const`å¯¹è±¡ä¼˜å…ˆåŒ¹é…å¸¦éåº•å±‚`const`å‚æ•°çš„å‡½æ•°
```c++
const string &f(const string &s) {
    return s;
}
string &f(string &s) {
    auto &r = f(const_cast<const string &>(s));
    return const_cast<string &>(r);
}
```
* é‡è½½å‡½æ•°çš„è°ƒç”¨å¯èƒ½æœ‰å”¯ä¸€æœ€ä½³åŒ¹é…ã€æ— åŒ¹é…ã€å¤šé‡åŒ¹é…ï¼Œåä¸¤è€…æŠ¥é”™
```c++
void f(double);
void f(string);
int main() {
    void f(int); // ç³Ÿç³•å®è·µï¼šå±€éƒ¨å£°æ˜å‡½æ•°
    f(3.14); // å¤–éƒ¨å£°æ˜è¢«å±è”½ï¼Œè°ƒç”¨f(int)
}
```
### é»˜è®¤å‚æ•°
```c++
char g();
double h = 1;
void f(int i, double d, char c = g());
void f(int, double = h, char); // åœ¨æ—§å£°æ˜åŸºç¡€ä¸Šå¢åŠ äº†ä¸€ä¸ªé»˜è®¤å‚æ•°
int main() {
    h = 2; // æ”¹å˜é»˜è®¤å€¼
    int h = 3; // å±è”½å…¨å±€å˜é‡ï¼Œä¸å½±å“é»˜è®¤å€¼
    f(0); // f(0, 2.0, g())
}
```
### å†…è”å‡½æ•°
* è¿”å›å€¼å‰åŠ `inline`ï¼Œç¼–è¯‘å™¨ä¸ä¿è¯å±•å¼€
### constexprå‡½æ•°
* å‚æ•°å’Œè¿”å›å€¼ä¸ºå­—é¢ç±»å‹ï¼Œå‡½æ•°ä½“æ°å¥½æ˜¯ä¸€ä¸ª`return`
* `constexpr`å‡½æ•°éšå«ä¸ºå†…è”å‡½æ•°
* ä¼ é€’é`constexpr`å‚æ•°æ—¶ï¼Œè¿”å›é`constexpr`å€¼
```c++
constexpr int f(int i) { return i+1; }
int a[f(1)];
int i = 2;
// int b[f(i)]; // é”™è¯¯ï¼Œä½†æœ‰çš„ç¼–è¯‘å™¨æ”¯æŒ
```
* å†…è”å‡½æ•°ã€`constexpr`å‡½æ•°å¯é‡å¤å®šä¹‰ï¼Œä½†å®šä¹‰å¿…é¡»ä¸€è‡´ï¼Œä¸”ç¼–è¯‘å™¨éœ€è¦å®šä¹‰æ‰èƒ½å±•å¼€ï¼Œå› æ­¤å¸¸äºå¤´æ–‡ä»¶å®šä¹‰
### è°ƒè¯•
* `cassert`å¤´æ–‡ä»¶å®šä¹‰å®`assert`ï¼Œå½“è¡¨è¾¾å¼ä¸ºå‡æ—¶ç»ˆæ­¢ç¨‹åº
* è‹¥å®šä¹‰äº†`NDEGUG`ï¼Œåˆ™`assert`ä¸èµ·ä½œç”¨
* `__func__`ä¸ºå½“å‰å‡½æ•°åï¼Œç±»å‹`static const char[]`
* `__FILE__`ã€`__LINE__`ã€`__TIME__`ã€`__DATE__`å®šä¹‰åŒC
### å‡½æ•°åŒ¹é…
* å€™é€‰å‡½æ•°ï¼šå£°æ˜å¯è§ï¼Œå‡½æ•°ååŒ¹é…
* å¯è¡Œå‡½æ•°ï¼šå€™é€‰å‡½æ•°ä¸­å¯ç”¨ç»™å®šå‚æ•°è°ƒç”¨çš„
* æœ€ä½³åŒ¹é…ï¼šç›¸å¯¹äºå…¶ä»–å¯è¡Œå‡½æ•°ï¼Œæ¯ä¸ªå‚æ•°çš„è½¬æ¢ç¨‹åº¦ç›¸åŒæˆ–æ›´ä¼˜ï¼Œä¸”æœ‰å‚æ•°çš„è½¬æ¢ç¨‹åº¦æ›´ä¼˜
* æœ‰å”¯ä¸€æœ€ä½³åŒ¹é…æ—¶ï¼Œè°ƒç”¨æ— æ­§ä¹‰ï¼Œå¦åˆ™æŠ¥é”™
* è‹¥éœ€è¦å¯¹å‚æ•°å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œåˆ™é‡è½½å‡½æ•°è®¾è®¡æœ‰é—®é¢˜
* è½¬æ¢ç¨‹åº¦æ’åºï¼šç²¾ç¡®åŒ¹é…ï¼ˆç›¸åŒç±»å‹ã€æ•°ç»„/å‡½æ•°->ç›¸åº”æŒ‡é’ˆã€åªå·®é¡¶å±‚`const`ï¼‰ï¼Œåº•å±‚`const`è½¬æ¢ï¼Œæ•´å‹æå‡ï¼Œç®—æœ¯/æŒ‡é’ˆç±»å‹è½¬æ¢ï¼Œç±»è½¬æ¢
### å‡½æ•°æŒ‡é’ˆ
* å£°æ˜ä¸ºå‡½æ•°çš„å‚æ•°è‡ªåŠ¨ä¸ºå‡½æ•°æŒ‡é’ˆ
* è¿”å›å‡½æ•°æŒ‡é’ˆæ—¶ä¸èƒ½å£°æ˜è¿”å›å€¼ä¸ºå‡½æ•°
```c++
double f(int);
decltype(f) g; // å‡½æ•°
decltype(f) *p; // å‡½æ•°æŒ‡é’ˆ
```
## 7
### æˆå‘˜å‡½æ•°
* æˆå‘˜å‡½æ•°å¿…é¡»åœ¨ç±»å†…å£°æ˜ï¼Œå¯åœ¨ç±»å¤–å®šä¹‰ï¼ˆå‡½æ•°åå‰åŠ `ç±»::`ï¼›è‹¥è¿”å›ç±»å‹ä¹Ÿæ˜¯ç±»æˆå‘˜ï¼Œç”±äºå‡ºç°åœ¨å‡½æ•°åå‰ï¼Œä¹Ÿéœ€è¦åŠ `ç±»::`ï¼‰
* ç±»å†…å®šä¹‰çš„å‡½æ•°éšå«ä¸ºå†…è”å‡½æ•°
* æˆå‘˜å‡½æ•°ä¸­`this`ä¸ºæŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆå¸¸é‡ï¼ˆé¡¶å±‚`const`ï¼‰
* æˆå‘˜å‡½æ•°å‚æ•°è¡¨åæ¥`const`åˆ™`this`ä¸ºå¸¸é‡æŒ‡é’ˆï¼ˆåº•å±‚`const`ï¼‰
* è‹¥è¦è¿”å›`*this`ï¼Œåˆ™å¯æ ¹æ®`const`é‡è½½æˆå‘˜å‡½æ•°ï¼Œé`const`å¯¹è±¡ä¼˜å…ˆè°ƒç”¨é`const`æˆå‘˜å‡½æ•°
* æˆå‘˜å‡½æ•°æœ€åç¼–è¯‘ï¼Œå› æ­¤å¯å‡ºç°åœ¨å…¶ä½¿ç”¨çš„æˆå‘˜å®šä¹‰ä¹‹å‰
* æˆå‘˜å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡å±è”½åŒåæˆå‘˜å˜é‡ï¼Œä½¿ç”¨åè€…åº”ç”¨`this->`æˆ–`ç±»::`
### æ„é€ å‡½æ•°
* æ„é€ å‡½æ•°ä¸èƒ½ä¸º`const`
* æœªå®šä¹‰æ„é€ å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆé»˜è®¤æ„é€ å‡½æ•°ï¼šå¯¹æœ‰åˆå€¼çš„æˆå‘˜å˜é‡ç±»å†…åˆå§‹åŒ–ï¼Œå¯¹å…¶ä»–æˆå‘˜å˜é‡é»˜è®¤åˆå§‹åŒ–
* `ç±»() {}`ä¸åˆæˆé»˜è®¤æ„é€ å‡½æ•°è¯­ä¹‰ç›¸åŒä½†å½±å“ç±»å±æ€§ï¼ˆ`is_trival`ã€`is_pod`ã€å€¼åˆå§‹åŒ–ï¼‰
* æ˜¾å¼å®šä¹‰åˆæˆé»˜è®¤æ„é€ å‡½æ•°ï¼š`ç±»() = default;`
* åˆå§‹åŒ–åˆ—è¡¨ï¼š`ç±»(...) : æˆå‘˜1(...), æˆå‘˜2{...} ... {...}`ï¼Œåˆå§‹åŒ–é¡ºåºåŒå£°æ˜é¡ºåºï¼ˆä¸åˆå§‹åŒ–åˆ—è¡¨çš„é¡ºåºæ— å…³ï¼‰ï¼Œæœªåœ¨åˆå§‹åŒ–åˆ—è¡¨å‡ºç°çš„æˆå‘˜å˜é‡ç±»å†…åˆå§‹åŒ–æˆ–é»˜è®¤åˆå§‹åŒ–ï¼Œæ‰€æœ‰æˆå‘˜å˜é‡åˆå§‹åŒ–å®Œæˆåæ„é€ å‡½æ•°ä½“æ‰§è¡Œ
* å§”æ‰˜æ„é€ ï¼šæ„é€ å‡½æ•°çš„åˆå§‹åŒ–åˆ—è¡¨ä¸ºå¯¹å¦ä¸€ä¸ªæ„é€ å‡½æ•°çš„è°ƒç”¨
### è®¿é—®é™å®š
* è®¿é—®é™å®šç¬¦å¯å‡ºç°ä»»æ„å¤šæ¬¡
* `class`å’Œ`struct`çš„å”¯ä¸€åŒºåˆ«æ˜¯ç¬¬ä¸€ä¸ªè®¿é—®é™å®šç¬¦å‰çš„æˆå‘˜å£°æ˜æ˜¯`private`è¿˜æ˜¯`public`
### å‹å…ƒ
* å‹å…ƒå‡½æ•°ï¼šç±»å†…å£°æ˜ï¼Œè¿”å›å€¼å‰åŠ `friend`ï¼Œå‡½æ•°ä½“å¯è®¿é—®ç±»çš„é`public`æˆå‘˜
* å‹å…ƒå‡½æ•°ä¸æ˜¯æˆå‘˜å‡½æ•°ï¼Œå¯åœ¨ç±»çš„ä»»æ„ä½ç½®å£°æ˜ï¼Œä¸å—è®¿é—®é™å®šç¬¦å½±å“
* ç±»å†…å£°æ˜çš„å‹å…ƒå‡½æ•°åªè´Ÿè´£è®¿é—®æ§åˆ¶ï¼Œåº”åœ¨ç±»æ‰€åœ¨å¤´æ–‡ä»¶å†æ¬¡å£°æ˜ï¼ˆä¸€äº›ç¼–è¯‘å™¨ä¸ä½œæ­¤è¦æ±‚ï¼‰
* `friend class å‹å…ƒç±»;`ï¼Œå‹å…ƒç±»çš„æ‰€æœ‰æˆå‘˜å‡½æ•°å¯è®¿é—®æœ¬ç±»ç§æœ‰æˆå‘˜ï¼›å‹å…ƒç±»ä¸å¯ä¼ é€’
* `friend è¿”å›ç±»å‹ å…¶ä»–ç±»::æˆå‘˜å‡½æ•°(...);`ï¼Œä»…è¯¥æˆå‘˜å‡½æ•°å¯è®¿é—®
```c++
class A;
struct B {
    void modifyA(A &);
};
class A {
    int x;
    friend void B::modifyA(A &); // å¿…é¡»æå‰å£°æ˜
    friend void f(); // å¯ä¸æå‰å£°æ˜ï¼Œä¸‹åŒ
    friend class C;
};
void B::modifyA(A &a) {
    a.x = 0;
}
```
### æ‚é¡¹
* å¯ç”¨`typedef`æˆ–`using`å®šä¹‰ç±»å‹æˆå‘˜ï¼Œéµå¾ªè®¿é—®é™å®šï¼Œä¸”å¿…é¡»å…ˆå®šä¹‰åä½¿ç”¨ï¼›ä¸å¯ä¸ç±»å¤–çš„ç±»å‹é‡åï¼ˆä¸€äº›ç¼–è¯‘å™¨ä¸ä½œæ­¤è¦æ±‚ï¼‰
* æˆå‘˜å˜é‡å£°æ˜ä¸º`mutable`ï¼Œåˆ™`const`å¯¹è±¡ä¹Ÿå¯ä¿®æ”¹è¯¥æˆå‘˜
* æ‹¥æœ‰ç›¸åŒæˆå‘˜çš„ç±»æ˜¯ä¸åŒçš„ç±»
* å£°æ˜ç±»å¯¹è±¡å¯ä»¥åƒCä¸€æ ·åœ¨ç±»åå‰åŠ `struct`æˆ–`class`
* å‰å‘å£°æ˜ï¼š`class ç±»;`ï¼Œç”¨äºå®šä¹‰æŒ‡é’ˆæˆ–å¼•ç”¨ã€å£°æ˜ï¼ˆä½†ä¸æ˜¯å®šä¹‰ï¼‰ä»¥è¯¥ç±»å¯¹è±¡ä¸ºå‚æ•°æˆ–è¿”å›å€¼çš„å‡½æ•°
* ä¸æä¾›ç›¸åº”å‡½æ•°æ—¶ï¼Œæ‰§è¡Œé»˜è®¤çš„å¤åˆ¶ã€èµ‹å€¼ã€ææ„
### éšå¼ç±»å‹è½¬æ¢
* å¯ç”¨å•å‚æ•°è°ƒç”¨çš„æ„é€ å‡½æ•°å®šä¹‰äº†ä»å‚æ•°ç±»å‹åˆ°è¯¥ç±»çš„éšå¼è½¬æ¢
* ç±»å†…å£°æ˜æ—¶`explicit`ç¦ç”¨éšå¼è½¬æ¢ï¼ˆå¦‚`vector`æ¥å—å…ƒç´ ä¸ªæ•°å‚æ•°çš„æ„é€ å‡½æ•°ï¼‰ï¼Œç±»å¤–å®šä¹‰ä¸é‡å¤å£°æ˜`explicit`
```c++
struct A {
    A(const string &s) {}
    explicit A(int i);
};
A::A(int i) {}
void f(const A &a) {}
int main() {
    string s;
    A a1 = s;
    f(s);
    // f(""); // é”™è¯¯ï¼Œéšå¼è½¬æ¢æœ€å¤šä¸€æ¬¡
    // f(0); // é”™è¯¯
    // A a2 = 0; // é”™è¯¯ï¼Œå¿…é¡»ç›´æ¥åˆå§‹åŒ–
    A a3 = static_cast<A>(0);
}
```
### èšåˆç±»
* æ‰€æœ‰æˆå‘˜å˜é‡éƒ½æ˜¯`public`ï¼Œä¸”æ²¡æœ‰åˆå€¼
* æ²¡æœ‰å®šä¹‰æ„é€ å‡½æ•°
* æ²¡æœ‰åŸºç±»å’Œè™šå‡½æ•°
```c++
struct A {
    int i;
    string s;
    double d;
};
A a = {1, "a"}; // å‰©ä½™å…ƒç´ å€¼åˆå§‹åŒ–
```
### å­—é¢ç±»
* æ‰€æœ‰æˆå‘˜å˜é‡éƒ½æ˜¯å­—é¢ç±»å‹
* å¯¹äºéèšåˆç±»è¿˜éœ€æ»¡è¶³ï¼šè‡³å°‘æœ‰ä¸€ä¸ª`constexpr`æ„é€ å‡½æ•°ï¼›æœ‰åˆå€¼çš„å†…ç½®ç±»å‹æˆå‘˜å˜é‡åˆå€¼ä¸º`constexpr`ï¼Œæœ‰åˆå€¼çš„ç±»æˆå‘˜å˜é‡ä½¿ç”¨è¯¥æˆå‘˜æ‰€å±ç±»çš„`constexpr`æ„é€ å‡½æ•°ï¼›ä½¿ç”¨é»˜è®¤çš„ææ„å‡½æ•°
* `constexpr`æ„é€ å‡½æ•°å¯ä»¥æ˜¯`=default`æˆ–`{}`ï¼Œåˆå§‹åŒ–åˆ—è¡¨éœ€åŒ…å«æ‰€æœ‰æ— åˆå€¼çš„æˆå‘˜å˜é‡ä¸”æä¾›`constexpr`åˆå€¼
### é™æ€æˆå‘˜
* ä½œç”¨åŸŸå¤–è®¿é—®æ–¹å¼ï¼š`ç±»::é™æ€æˆå‘˜`ï¼Œ`å¯¹è±¡æˆ–å¼•ç”¨.é™æ€æˆå‘˜`ï¼Œ`æŒ‡é’ˆ->é™æ€æˆå‘˜`
* `static constexpr`æˆå‘˜å˜é‡å¿…é¡»ç±»å†…åˆå§‹åŒ–ï¼Œ`static const`æ•´å‹æˆå‘˜å˜é‡å¯åœ¨ç±»å†…åˆå§‹åŒ–ï¼ˆåˆå€¼å¿…é¡»ä¸º`constexpr`ï¼‰ï¼Œå…¶ä»–`static`æˆå‘˜å˜é‡å¿…é¡»åœ¨ç±»å¤–å®šä¹‰
```c++
struct A {
    static int i1;
    static const int i2 = 0;
    static constexpr double d = 0;
};
int A::i1 = 0;
const int A::i2; // ç”±äºä¸èƒ½å°†æ‰€æœ‰i2çš„å‡ºç°æ›¿æ¢ä¸ºå¸¸é‡ï¼Œå¿…é¡»åœ¨ç±»å¤–å®šä¹‰
void f(const int &i) {}
int main() {
    f(A::i2);
}
```
* `static`æˆå‘˜å˜é‡å¯ä»¥ä¸ºè¯¥ç±»ç±»å‹ï¼Œå¯ä»¥ä½œä¸ºæˆå‘˜å‡½æ•°å‚æ•°é»˜è®¤å€¼
## 8
### IOç±»
* `iostream`å¤´æ–‡ä»¶å®šä¹‰`istream`ã€`ostream`ã€`iostream`
* `fstream`å¤´æ–‡ä»¶å®šä¹‰`ifstream`ã€`ofstream`ã€`fstream`
* `sstream`å¤´æ–‡ä»¶å®šä¹‰`istringstream`ã€`ostringstream`ã€`stringstream`
* ä¸Šè¿°ç±»éƒ½æœ‰å¯¹åº”çš„`w*`ç±»å¤„ç†`wchar_t`
* `fstream`ã€`stringstream`ç­‰ç±»ç»§æ‰¿è‡ªå¯¹åº”çš„`iostream`ç±»
* IOå¯¹è±¡ä¸å¯å¤åˆ¶ã€èµ‹å€¼
### æµçŠ¶æ€
```c++
strm::iostate // æœºå™¨ç›¸å…³æ•´æ•°ç±»å‹
strm::badbit // ä¸å¯æ¢å¤é”™è¯¯ä½
strm::failbit // å¯æ¢å¤é”™è¯¯ä½
strm::eofbit // æµç»“æŸä½ï¼ŒåŒæ—¶è®¾ç½®failbit
strm::goodbit // 0
bool s.eof() // eofbitç½®ä½åˆ™ä¸ºtrue
bool s.fail() // failbitæˆ–badbitç½®ä½åˆ™ä¸ºtrueï¼Œif(s)ç­‰ä»·äºif(!s.fail())
bool s.bad() // badbitç½®ä½åˆ™ä¸ºtrue
bool s.good() // é”™è¯¯ä½å‡æœªç½®ä½åˆ™ä¸ºtrue
void s.clear() // é‡ç½®æ‰€æœ‰é”™è¯¯ä½
void s.clear(flags) // è®¾ç½®ä¸ºç»™å®šé”™è¯¯ä½
void s.setstate(flags) // ç½®ä½ç»™å®šé”™è¯¯ä½
strm::iostate s.rdstate() // è¿”å›å½“å‰çŠ¶æ€
```
### è¾“å‡ºç¼“å†²
* åˆ·æ–°è¾“å‡ºç¼“å†²åŒºçš„æ¡ä»¶ï¼šç¨‹åºæ­£å¸¸ç»ˆæ­¢ã€ç¼“å†²åŒºæ»¡ã€æ˜¾å¼åˆ·æ–°ã€`unitbuf`ï¼ˆå¦‚`cerr`ï¼‰ã€ç›¸å…³çš„å¦ä¸€ä¸ªæµæœ‰è¯»å†™è¡Œä¸ºï¼ˆè¯»å–`cin`æˆ–å†™å…¥`cerr`ä¼šåˆ·æ–°`cout`ï¼‰
```c++
cout << "1" << flush; // åˆ·æ–°
cout << "2" << ends; // å†™ç©ºå­—ç¬¦å¹¶åˆ·æ–°
cout << unitbuf; // ç¦ç”¨ç¼“å†²
cout << nounitbuf; // æ¢å¤ç¼“å†²
is.tie() // è¿”å›æŒ‡é’ˆï¼ŒæŒ‡å‘è¾“å…¥æµç»‘å®šçš„è¾“å‡ºæµï¼›è¾“å…¥æµã€è¾“å‡ºæµå¤šå¯¹ä¸€
is.tie(&os) // è¿”å›æ—§æŒ‡é’ˆï¼Œç»‘å®šæ–°è¾“å‡ºæµï¼Œè¯»å–isåˆ·æ–°os
```
### fstream
```c++
fstrm fs; // æœªç»‘å®šæ–‡ä»¶
fstrm fs(s); // æ‰“å¼€æ–‡ä»¶ï¼Œsä¸ºstringæˆ–Cå­—ç¬¦ä¸²ï¼Œå¤±è´¥ç½®ä½failbit
fstrm fs(s, mode); // æŒ‡å®šæ¨¡å¼
void fs.open(s) // è‹¥fså·²æ‰“å¼€æ–‡ä»¶åˆ™å¤±è´¥
void fs.open(s, mode)
void fs.close() // fsé”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨close
bool fs.is_open()
```
mode|æ„ä¹‰
-|-
fstrm::in|è¾“å…¥ï¼Œifstreamã€fstreamé»˜è®¤
out|è¾“å‡ºï¼Œofstreamã€fstreamé»˜è®¤
app|è¿½åŠ ï¼Œä¸truncå†²çªï¼Œéšå«out
ate|ç«‹å³æŒ‡å‘æ–‡ä»¶å°¾ï¼Œä¸å…¶ä»–æ¨¡å¼ä¸å†²çª
trunc|æˆªæ–­ï¼Œå¿…é¡»åŒæ—¶æŒ‡å®šout
binary|äºŒè¿›åˆ¶æ¨¡å¼ï¼Œä¸å…¶ä»–æ¨¡å¼ä¸å†²çª
* `ofstream`ä¸æŒ‡å®š`in`æˆ–`app`åˆ™éšå«`trunc`
### stringstream
```c++
sstrm ss; // æœªç»‘å®šå­—ç¬¦ä¸²
sstrm ss(s); // ç»‘å®šsçš„å‰¯æœ¬
string ss.str() // ç»‘å®šå­—ç¬¦ä¸²çš„å‰¯æœ¬
void ss.str(s) // ç»‘å®šæ–°å­—ç¬¦ä¸²ï¼Œä¸æ”¹å˜æµçŠ¶æ€
```
## 9
### å®¹å™¨æ“ä½œ
ç±»å‹åˆ«å|æ„ä¹‰
-|-
iterator|è¿­ä»£å™¨
const_iterator|åªè¯»è¿­ä»£å™¨
size_type|unsignedå¤§å°
difference_type|signedè·ç¦»
value_type|å…ƒç´ 
reference|value_type&
const_reference|const value_type&

æ„é€ |æ„ä¹‰
-|-
C c|ç©ºå®¹å™¨ï¼ˆé™¤arrayï¼‰
C c1(c2)|å¤åˆ¶
C c(b, e)|è¿­ä»£å™¨èŒƒå›´å¤åˆ¶ï¼ˆä¸é€‚ç”¨arrayï¼‰ï¼Œå®¹å™¨ç±»å‹å¯ä¸åŒï¼Œå…ƒç´ ç±»å‹å¯ä»¥è½¬æ¢
C c{a, b, ...}|åˆ—è¡¨åˆå§‹åŒ–

èµ‹å€¼å’Œäº¤æ¢|æ„ä¹‰
-|-
c1 = c2|ç”¨c2çš„å…ƒç´ æ›¿æ¢c1
c1 = {a, b, ...}|ç”¨åˆ—è¡¨å…ƒç´ æ›¿æ¢c1
a.swap(b)|äº¤æ¢aå’Œbçš„å…ƒç´ 
swap(a, b)|åŒa.swap(b)

å¤§å°|æ„ä¹‰
-|-
c.size()|å…ƒç´ ä¸ªæ•°ï¼ˆä¸é€‚ç”¨forward_listï¼‰
c.max_size()|å…ƒç´ ä¸ªæ•°æœ€å¤§å€¼
c.empty()|æ˜¯å¦ä¸ºç©º

æ’å…¥/åˆ é™¤å…ƒç´ |æ„ä¹‰ï¼ˆä¸é€‚ç”¨arrayï¼‰
-|-
c.insert(args)|æ’å…¥
c.emplace(inits)|æ„é€ å¹¶æ’å…¥
c.erase(args)|åˆ é™¤
void c.clear()|åˆ é™¤å…¨éƒ¨

æ¯”è¾ƒ|æ„ä¹‰
-|-
==ã€!=|é€‚ç”¨å…¨éƒ¨å®¹å™¨
<ã€<=ã€>ã€>=|ç±»ä¼¼å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œä¸é€‚ç”¨æ— åºå…³è”å®¹å™¨

è¿­ä»£å™¨|æ„ä¹‰
-|-
c.begin()ã€c.end()|iterator
c.cbegin()ã€c.cend()|const_iterator

ååºè¿­ä»£å™¨|æ„ä¹‰ï¼ˆä¸é€‚ç”¨forward_listï¼‰
-|-
c.rbegin()ã€c.rend()|reverse_iterator
c.crbegin()ã€c.crend()|const_reverse_iterator
### åºåˆ—å®¹å™¨æ“ä½œ
åºåˆ—å®¹å™¨åˆå§‹åŒ–|æ„ä¹‰
-|-
seq(n)|nä¸ªå€¼åˆå§‹åŒ–å…ƒç´ 
seq(n, v)|nä¸ªå…ƒç´ v
```c++
array<int, 3> a1; // é»˜è®¤åˆå§‹åŒ–
array<int ,3> a2 = {1, 2}; // {1, 2, 0}ï¼›å€¼åˆå§‹åŒ–
```
åºåˆ—å®¹å™¨èµ‹å€¼|æ„ä¹‰ï¼ˆä¸é€‚ç”¨arrayï¼‰
-|-
seq.assign(b, e)|ç±»ä¼¼è¿­ä»£å™¨åˆå§‹åŒ–ï¼Œbã€eä¸å¯ä¸ºseqçš„è¿­ä»£å™¨
seq.assign(il)|ç”¨initializer_listä¸­çš„å…ƒç´ ä»£æ›¿
seq.assign(n, t)|nä¸ªå…ƒç´ v
* èµ‹å€¼ä½¿è¢«èµ‹å€¼å®¹å™¨çš„è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆ
* äº¤æ¢ä¸ä½¿å®¹å™¨çš„è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆï¼ˆstringé™¤å¤–ï¼‰ï¼Œå®ƒä»¬éƒ½è½¬è€ŒæŒ‡å‘å¦ä¸€ä¸ªå®¹å™¨ï¼ˆarrayé™¤å¤–ï¼‰

åºåˆ—å®¹å™¨æ’å…¥|æ„ä¹‰
-|-
void seq.push_back(v)ã€void seq.emplace_back(args)|å°¾éƒ¨æ’å…¥/æ„é€ ï¼Œä¸é€‚ç”¨forward_list
void seq.push_front(v)ã€void seq.emplace_front(args)|å¤´éƒ¨æ’å…¥/æ„é€ ï¼Œä¸é€‚ç”¨vectorã€string
seq.insert(iter, v)ã€seq.emplace(iter, args)|åœ¨iterå‰æ’å…¥/æ„é€ 
seq.insert(iter, n, v)|åœ¨iterå‰æ’å…¥nä¸ªv
seq.insert(iter, b, e)|åœ¨iterå‰æ’å…¥båˆ°eçš„å…ƒç´ ï¼ˆbã€eä¸å¯ä¸ºseqçš„è¿­ä»£å™¨ï¼‰
seq.insert(iter, il)|åœ¨iterå‰æ’å…¥åˆå§‹åŒ–åˆ—è¡¨é‡çš„å…ƒç´ 
* insertã€emplaceä¸é€‚ç”¨forward_list
* insertã€emplaceè¿”å›æŒ‡å‘æ’å…¥çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ï¼Œè‹¥insertæœªæ’å…¥ä»»ä½•å…ƒç´ åˆ™è¿”å›iter
* æ’å…¥vectorã€stringä½¿è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆ
* æ’å…¥dequeé™¤å¤´å°¾çš„ä½ç½®ä½¿è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆï¼›æ’å…¥dequeå¤´å°¾ä½¿è¿­ä»£å™¨å¤±æ•ˆï¼Œä½†å…ƒç´ å¼•ç”¨/æŒ‡é’ˆä»æœ‰æ•ˆ
* emplaceåœ¨å®¹å™¨å†…æ„é€ ï¼Œä¸äº§ç”Ÿä¸´æ—¶å¯¹è±¡

åºåˆ—å®¹å™¨è®¿é—®å…ƒç´ |æ„ä¹‰
-|-
seq.back()|æœ€åä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œä¸é€‚ç”¨forward_listï¼Œå¯¹ç©ºå®¹å™¨æœªå®šä¹‰
seq.front()|ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œå¯¹ç©ºå®¹å™¨æœªå®šä¹‰
seq\[n]|ä¸‹æ ‡nå…ƒç´ çš„å¼•ç”¨ï¼Œå¯¹è¶Šç•Œæœªå®šä¹‰
seq.at(n)|ä¸‹æ ‡nå…ƒç´ çš„å¼•ç”¨ï¼Œè¶Šç•ŒæŠ›å‡ºout_of_rangeå¼‚å¸¸
* ä¸‹æ ‡ã€atåªé€‚ç”¨stringã€vectorã€dequeã€array

åºåˆ—å®¹å™¨åˆ é™¤|æ„ä¹‰
-|-
void seq.pop_back()|å°¾éƒ¨åˆ é™¤ï¼Œä¸é€‚ç”¨forward_list
void seq.pop_front()|å¤´éƒ¨åˆ é™¤ï¼Œä¸é€‚ç”¨vectorã€string
seq.erase(iter)|åˆ é™¤iteræ‰€æŒ‡å…ƒç´ ï¼Œiterä¸ºendæ—¶ç»“æœæœªå®šä¹‰
seq.erase(b, e)|åˆ é™¤båˆ°eçš„å…ƒç´ 
* eraseä¸é€‚ç”¨forward_list
* eraseè¿”å›æŒ‡å‘åˆ é™¤çš„æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„è¿­ä»£å™¨
* åˆ é™¤dequeå¤´ã€å°¾å¤–çš„å…ƒç´ ä½¿æ‰€æœ‰è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆï¼›åˆ é™¤dequeå°¾ä½¿endå¤±æ•ˆ
* åˆ é™¤vectorã€stringçš„å…ƒç´ ä½¿å…¶åçš„è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆ

forward_listæ“ä½œ|æ„ä¹‰
-|-
lst.before_begin()ã€lst.cbefore_begin()|æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ å‰çš„è¿­ä»£å™¨ï¼Œä¸å¯è§£å¼•ç”¨
lst.insert_after(iter, v)ã€lst.insert_after(iter, n, v)ã€lst.insert_after(iter, b, e)ã€lst.insert_after(iter, il)|åœ¨iteråæ’å…¥ï¼ˆbã€eä¸å¯ä¸ºlstçš„è¿­ä»£å™¨ï¼‰
lst.emplace_after(iter, args)|åœ¨iteråæ„é€ 
lst.erase_after(iter)|åˆ é™¤iterä¹‹åçš„å…ƒç´ ï¼Œiteræˆ–++iterä¸ºendæ—¶ç»“æœæœªå®šä¹‰
lst.erase_after(b, e)|åˆ é™¤++båˆ°eçš„å…ƒç´ 
* insert_afterã€emplace_afterè¿”å›æŒ‡å‘æ’å…¥çš„æœ€åä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ï¼Œè‹¥insertæœªæ’å…¥ä»»ä½•å…ƒç´ åˆ™è¿”å›iterï¼Œè‹¥iterä¸ºendåˆ™ç»“æœæœªå®šä¹‰
* erase_afterè¿”å›æŒ‡å‘åˆ é™¤çš„æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„è¿­ä»£å™¨

åºåˆ—å®¹å™¨æ›´æ”¹å¤§å°|æ„ä¹‰
-|-
void seq.resize(n)|å°¾éƒ¨ç¼©å®¹ï¼Œæˆ–æ‰©å®¹å¹¶å€¼åˆå§‹åŒ–
void seq.resize(n, v)|å°¾éƒ¨ç¼©å®¹ï¼Œæˆ–æ‰©å®¹å¹¶æ·»åŠ v
* vectorã€stringã€dequeçš„æ‰€æœ‰è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆ

vectorã€stringå®¹é‡|æ„ä¹‰
-|-
v.capacity()|å®¹é‡
v.reserve(n)|å½“å®¹é‡ä¸è¶³næ—¶æ‰©å……å®¹é‡è‡³å°‘åˆ°n
v.shrink_to_fit()|è¯·æ±‚ä½†ä¸ä¿è¯å°†capacityå‡å°‘åˆ°sizeï¼ŒåŒæ—¶é€‚ç”¨deque
* å¢é•¿ç­–ç•¥å®ç°ç›¸å…³ï¼Œä½†ä»…å½“capacityæ— æ³•å®¹çº³sizeæ—¶æ‰é‡æ–°åˆ†é…ç©ºé—´
### å­—ç¬¦ä¸²æ“ä½œ
å­—ç¬¦ä¸²æ„é€ |æ„ä¹‰
-|-
s(ca, n)|å­—ç¬¦æ•°ç»„caçš„å‰nä¸ªå­—ç¬¦ï¼Œæ•°ç»„è‡³å°‘é•¿n
s(str, i[, len])|å­—ç¬¦ä¸²strä»ä¸‹æ ‡iå¼€å§‹ï¼ˆè‡³å¤šé•¿lenï¼‰çš„å­ä¸²ï¼Œi>str.size()æ—¶æŠ›å‡ºout_of_rangeå¼‚å¸¸

å­—ç¬¦ä¸²å­ä¸²|æ„ä¹‰
-|-
s.substr(i, len)|ç±»ä¼¼å­ä¸²æ„é€ å‡½æ•°ï¼Œié»˜è®¤0ï¼Œlené»˜è®¤å‰©ä½™é•¿åº¦

å­—ç¬¦ä¸²æ›´æ”¹|æ„ä¹‰
-|-
s.insert(i, args)|åœ¨ä½ç½®å‰æ’å…¥å…ƒç´ 
s.erase(i[, len])|ä»ièµ·åˆ é™¤ï¼ˆæœ€å¤šlenä¸ªï¼‰å…ƒç´ 
s.assign(args)|æ›¿æ¢
s.append(args)|è¿½åŠ 
s.replace(range, args)|æ›¿æ¢rangeæŒ‡ä»£çš„å­ä¸²
* ä¸Šè¿°å‡½æ•°å‡è¿”å›sçš„å¼•ç”¨
* argsè¿‡äºå¤æ‚ï¼Œè§æ–‡æ¡£

å­—ç¬¦ä¸²æœç´¢|æ„ä¹‰
-|-
s.find(args)|ç¬¬ä¸€æ¬¡å‡ºç°
s.rfind(args)|æœ€åä¸€æ¬¡å‡ºç°
s.find_first_of(args)|ç¬¬ä¸€æ¬¡å‡ºç°argsä¸­ä»»æ„å­—ç¬¦
s.find_last_of(args)|æœ€åä¸€æ¬¡å‡ºç°argsä¸­ä»»æ„å­—ç¬¦
s.find_first_not_of(args)|ç¬¬ä¸€æ¬¡å‡ºç°argså¤–ä»»æ„å­—ç¬¦
s.find_last_not_of(args)|æœ€åä¸€æ¬¡å‡ºç°argså¤–ä»»æ„å­—ç¬¦

æœç´¢å‡½æ•°çš„args|æ„ä¹‰
-|-
c, i=0|ä»s\[i]å¼€å§‹ï¼Œå¯»æ‰¾å­—ç¬¦c
s2, i=0|ä»s\[i]å¼€å§‹ï¼Œå¯»æ‰¾å­—ç¬¦ä¸²s2
cs, i=0|ä»s\[i]å¼€å§‹ï¼Œå¯»æ‰¾Cå­—ç¬¦ä¸²cs
ca, i, n|ä»s\[i]å¼€å§‹ï¼Œå¯»æ‰¾å­—ç¬¦æ•°ç»„caçš„å‰nä¸ªå­—ç¬¦
* ä¸Šè¿°å‡½æ•°æ— åŒ¹é…åˆ™è¿”å›`string::npos`ï¼Œå³`(string::size_type)-1`

s.compare(args)|æ„ä¹‰
-|-
s2|så’Œs2
i, len, s2|s.substr(i, len)å’Œs2
i, len, s2, i2, len2|s.substr(i, len)å’Œs2.substr(i2, len2)
cs|så’ŒCå­—ç¬¦ä¸²cs
i, len, cs|s.substr(i, len)å’Œcs
i, len, ca, n|s.substr(i, len)å’Œå­—ç¬¦æ•°ç»„caçš„å‰nä¸ªå­—ç¬¦

æ•°å€¼è½¬æ¢|æ„ä¹‰
-|-
to_string(v)|å°†æµ®ç‚¹æ•°æˆ–intåŠä»¥ä¸Šçš„æ•´æ•°è½¬ä¸ºå­—ç¬¦ä¸²
sto{i,l,ul,ll,ull}(s, size_t \*p = 0, b = 10)|å°†sçš„å¤´éƒ¨è½¬ä¸ºæ•´æ•°ï¼Œè‹¥pé0åˆ™å°†*pè®¾ä¸ºä¸‹ä¸€ä¸ªå­—ç¬¦çš„ä¸‹æ ‡ï¼Œbè¿›åˆ¶
sto{f,d,ld}(s, size_t *p = 0)|å°†sçš„å¤´éƒ¨è½¬ä¸ºæµ®ç‚¹æ•°
* éæ³•å­—ç¬¦ä¸²æŠ›å‡ºinvalid_argumentå¼‚å¸¸ï¼Œè¶…å‡ºè¡¨ç¤ºèŒƒå›´æŠ›å‡ºout_of_rangeå¼‚å¸¸
### å®¹å™¨é€‚é…å™¨
å…¬å…±æ¥å£|æ„ä¹‰
-|-
size_type|å¤§å°ç±»å‹
value_type|å…ƒç´ ç±»å‹
container_type|åº•å±‚å®¹å™¨ç±»å‹
A a;|ç©ºé€‚é…å™¨
A a(c);|ä»¥cä¸ºåº•å±‚å®¹å™¨çš„é€‚é…å™¨
a.empty()|æ˜¯å¦ä¸ºç©º
a.size()|å…ƒç´ ä¸ªæ•°
swap(a, b)ã€a.swap(b)|äº¤æ¢å…ƒç´ ï¼Œè¦æ±‚åº•å±‚å®¹å™¨ç±»å‹ä¹Ÿç›¸åŒ

é€‚é…å™¨|åº•å±‚å®¹å™¨|é»˜è®¤
-|-|-
stack|vectorã€dequeã€list|deque
queue|listã€deque|deque
priority_queue|vectorã€deque|vector
```c++
stack<string> stk(deq);
stack<int, vector<int>> stk2;
```
* ä¸å¯ä½¿ç”¨åº•å±‚å®¹å™¨æ¥å£
* priority_queueä½¿ç”¨å…ƒç´ ç±»å‹çš„<è¿ç®—ç¬¦

stackæ“ä½œ|æ„ä¹‰
-|-
void stk.push(v)|å…¥æ ˆ
void stk.emplace(args)|æ„é€ å¹¶å…¥æ ˆ
stk.top()|å–æ ˆé¡¶å…ƒç´ 
void stk.pop()|å‡ºæ ˆ

é˜Ÿåˆ—æ“ä½œ|æ„ä¹‰
-|-
void q.pop()|å‡ºé˜Ÿåˆ—
q.front()ã€q.back()|å–queueå¤´ã€å°¾å…ƒç´ 
q.top()|å–priority_queueå¤´å…ƒç´ 
q.push(v)|å…¥é˜Ÿåˆ—
q.emplace(args)|æ„é€ å¹¶å…¥é˜Ÿåˆ—
## 10
* ç®—æ³•ä½¿ç”¨è¿­ä»£å™¨ï¼Œä¸ä½¿ç”¨å®¹å™¨æ“ä½œ
* ä½äºå¤´æ–‡ä»¶algorithmå’Œnumeric

ç®—æ³•|æ„ä¹‰
-|-
find(b, e, v)|è¿”å›ç¬¬ä¸€æ¬¡å‡ºç°vçš„è¿­ä»£å™¨æˆ–e
find_if(b, e, pred)|è¿”å›ç¬¬ä¸€æ¬¡predéé›¶çš„è¿­ä»£å™¨æˆ–e
count(b, e, v)|è¿”å›vå‡ºç°çš„æ¬¡æ•°
count_if(b, e, pred)|è¿”å›predéé›¶çš„æ¬¡æ•°
T acumulate(b, e, T v)|è¿”å›båˆ°eç´¯åŠ åˆ°vä¸Šçš„ç»“æœï¼Œè¦æ±‚å®ç°v+*b
bool equal(b, e, b2)|båˆ°eæ˜¯å¦ç­‰äºä»b2å¼€å§‹çš„åºåˆ—ï¼Œè¦æ±‚å®ç°\*b==*b2ï¼Œä¸”ç¬¬ä¸€ä¸ªåºåˆ—ä¸çŸ­äºç¬¬äºŒä¸ª
void fill(b, e, v)|båˆ°eéƒ½èµ‹å€¼ä¸ºv
fill_n(b, n, v)|bå¼€å§‹çš„nä¸ªå…ƒç´ èµ‹å€¼ä¸ºvï¼Œè¿”å›å°¾è¿­ä»£å™¨
copy(b, e, dest)|båˆ°eå¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
copy_if(b, e, dest, pred)|båˆ°eä¸­predéé›¶å…ƒç´ å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
remove_if(b, e, pred)|æŒ¤å‹båˆ°eä¸­predéé›¶å…ƒç´ ï¼Œè¿”å›å°¾è¿­ä»£å™¨ï¼ˆå…¶åå…ƒç´ å€¼ä¸ç¡®å®šï¼‰
remove_copy_if(b, e, dest, pred)|båˆ°eä¸­é™¤predéé›¶å…ƒç´ å¤–å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
void replace(b, e, v, v2)|båˆ°eçš„væ›¿æ¢ä¸ºv2
void replace_if(b, e, pred, v2)|båˆ°eä¸­predéé›¶å…ƒç´ æ›¿æ¢ä¸ºv2
replace_copy(b, e, dest, v, v2)|båˆ°eçš„væ›¿æ¢ä¸ºv2å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
replace_copy_if(b, e, dest, pred, v2)|båˆ°eä¸­predéé›¶å…ƒç´ æ›¿æ¢ä¸ºv2å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
void reverse(b, e)|åè½¬båˆ°e
void reverse_copy(b, e, dest)|åè½¬båˆ°eå¤åˆ¶åˆ°dest
void sort(b, e[, cmp])|æ’åºbåˆ°eï¼Œè¦æ±‚å®ç°\*b<*b
void stable_sort(b, e[, cmp])|ç¨³å®šæ’åº
unique(b, e[, cmp])|æŒ¤å‹ç›¸é‚»é‡å¤å…ƒç´ ï¼Œè¿”å›å°¾è¿­ä»£å™¨ï¼ˆå…¶åå…ƒç´ å€¼ä¸ç¡®å®šï¼‰ï¼Œè¦æ±‚å®ç°\*b==*b
unique_copy(b, e, dest)|æŒ¤å‹ç›¸é‚»é‡å¤å…ƒç´ å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
partition(b, e, pred)|å°†båˆ°eä¹‹é—´predéé›¶çš„å…ƒç´ æ”¾åœ¨å‰é¢ï¼Œè¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªfalseçš„è¿­ä»£å™¨
stable_partition(b, e, pred)|ç¨³å®šåˆ†å‰²
for_each(b, e, f)|å¯¹båˆ°eè°ƒç”¨f
transform(b, e, dest, f)|å¯¹båˆ°eè°ƒç”¨få¹¶å†™å…¥destï¼Œdestå¯ç­‰äºb
### lambda
\[æ•è·åˆ—è¡¨](å½¢å‚è¡¨) mutable -> è¿”å›ç±»å‹ { å‡½æ•°ä½“ }
* `(å½¢å‚è¡¨)`å’Œ`->è¿”å›ç±»å‹`å¯çœç•¥ï¼Œçœç•¥è¿”å›ç±»å‹æ—¶è‹¥å‡½æ•°ä½“ä»…å«ä¸€ä¸ª`return`åˆ™è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦åˆ™è¿”å›`void`ï¼ˆæ­¤è§„åˆ™ä¸ºdefectï¼‰
* lambdaç±»å‹ç”±ç¼–è¯‘å™¨ç”Ÿæˆï¼Œå˜é‡èµ‹å€¼éœ€ç”¨`auto`ï¼›æ•è·çš„å˜é‡ä½œä¸ºå…¶ç±»å‹æˆå‘˜
* å‚æ•°æ— é»˜è®¤å€¼
* æ•è·åˆ—è¡¨é€‚ç”¨äºå±€éƒ¨éé™æ€å˜é‡
* æŒ‰å€¼æ•è·ï¼šå¤åˆ¶åˆ›å»ºlambdaæ—¶çš„å˜é‡å€¼ï¼Œè€Œéè°ƒç”¨æ—¶çš„å˜é‡å€¼
* è‹¥è¦æ”¹å˜æŒ‰å€¼æ•è·çš„å˜é‡ï¼Œä¸å¯çœç•¥å½¢å‚è¡¨ï¼Œå…¶åè·Ÿ`mutable`
* æŒ‰å¼•ç”¨æ•è·ï¼šlambdaæ‰§è¡Œæ—¶è¢«å¼•ç”¨çš„å˜é‡å¿…é¡»å­˜åœ¨ï¼ˆå¤–å±‚å‡½æ•°æœªè¿”å›ï¼‰ï¼Œå› æ­¤å¤–å±‚å‡½æ•°ä¸èƒ½è¿”å›æ•è·å¼•ç”¨çš„lambda

æ•è·åˆ—è¡¨|æ„ä¹‰
-|-
[]|ä¸æ•è·å˜é‡
\[å˜é‡åˆ—è¡¨]|`å˜é‡`æŒ‰å€¼ï¼Œ`&å˜é‡`æŒ‰å¼•ç”¨ï¼Œ`,`åˆ†éš”
\[=]|å‡½æ•°ä½“å‡ºç°çš„å˜é‡æŒ‰å€¼
\[&]|å‡½æ•°ä½“å‡ºç°çš„å˜é‡æŒ‰å¼•ç”¨
\[=, å˜é‡åˆ—è¡¨]|åˆ—è¡¨ä¸­çš„å˜é‡ï¼ˆå¸¦`&`ï¼‰æŒ‰å¼•ç”¨ï¼Œå…¶ä½™æŒ‰å€¼
\[&, å˜é‡åˆ—è¡¨]|åˆ—è¡¨ä¸­çš„å˜é‡ï¼ˆä¸å¸¦`&`ï¼‰æŒ‰å€¼ï¼Œå…¶ä½™æŒ‰å¼•ç”¨
### bind
* `function`å¤´æ–‡ä»¶å®šä¹‰`bind`ã€`placeholders`ã€`ref`ã€`cref`
```c++
using namespace std::placeholders;
void old_callable(int a, int b, int c);
void f(int d) {
    auto new_callable = bind(old_callable, _2, d, _1); // å¤åˆ¶dçš„å€¼
    new_callable(3, 4); // old_callable(4, d, 3);
}
void print(ostream &os, char c);
void g(ostream &os) {
    auto ref_bind = bind(print, ref(os), _1); // ä¸å¯å¤åˆ¶çš„å¯¹è±¡å¿…é¡»ä¼ é€’å¼•ç”¨
    ref_bind('x');
}
```
### insert iterator
```c++
#include <iterator>
back_insert_iterator<T> back_inserter(T c) // push_backï¼Œè¿ç»­èµ‹å€¼åæ’
front_insert_iterator<T> front_inserter(T c) // push_frontï¼Œè¿ç»­èµ‹å€¼å‰æ’
insert_iterator<T> inserter(T c, iter) // insertï¼Œè¿ç»­èµ‹å€¼åæ’
iter = v // æ’å…¥
*iter, ++iter, iter++ // ç®€å•è¿”å›iter
```
### istream iterator
```c++
istream_iterator<int> int_iter(cin); // å®ç°å…è®¸æƒ°æ€§æ±‚å€¼ï¼Œå³æ¨è¿Ÿåˆ°*int_iteræ—¶è¯»å–è¾“å…¥æµ
istream_iterator<int> int_eof; // é»˜è®¤åˆå§‹åŒ–ä¸ºeof
// ç‰ˆæœ¬1
vector<int> v;
while(int_iter != int_eof)
    v.push_back(*int_iter++);
// ç‰ˆæœ¬2
vector<int> v(int_iter, int_eof);
```
### ostream iterator
```c++
ostream_iterator<int> iter(cout[, " "]); // ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»ä¸ºCå­—ç¬¦ä¸²
iter = 0; // è¾“å‡º
*iter, ++iter, iter++ // ç®€å•è¿”å›iter
```
### reverse iterator
```c++
reverse_iterator<vector<int>::iterator> rb(vec.end()); // vec.rbegin()
rb.base() == vec.end()
```
### 5ç§è¿­ä»£å™¨ç±»å‹
* input
* output
* forward
* bidirectional
* random-access
### åˆ—è¡¨ç‰¹å®šç®—æ³•
* ä¸ç”¨äº¤æ¢å…ƒç´ ï¼Œæ•ˆç‡é«˜äºé€šç”¨ç®—æ³•

listã€forward_listç®—æ³•|æ„ä¹‰
-|-
lst.merge(lst2[, cmp])|å½’å¹¶lst2è‡³lstï¼ˆæ¸…ç©ºlst2ï¼‰ï¼Œè¦æ±‚ä¸¤ä¸ªåˆ—è¡¨æœ‰åºï¼Œä½¿ç”¨<æˆ–cmp
lst.remove(v)ã€lst.remove_if(pred)|è°ƒç”¨eraseåˆ é™¤==væˆ–predéé›¶çš„å…ƒç´ 
lst.reverse()|åˆ—è¡¨åè½¬
lst.sort(\[cmp])|åˆ—è¡¨æ’åºï¼Œä½¿ç”¨<æˆ–cmp
lst.unique(\[pred])|è°ƒç”¨eraseåˆ é™¤ç›¸é‚»==æˆ–pred(l, r)éé›¶å…ƒç´ 

lst.spliceæˆ–flst.splice_afterçš„å‚æ•°|æ„ä¹‰
-|-
p, lst2|å°†lst2æˆ–flst2æ’å…¥lstçš„på‰æˆ–flstçš„påï¼Œæ¸…ç©ºlst2ï¼ˆå¿…é¡»ä¸ºä¸åŒåˆ—è¡¨ï¼‰
p, lst2, p2|å°†lst2çš„p2ç§»åŠ¨åˆ°lstçš„på‰ï¼Œæˆ–å°†flst2çš„p2åçš„å…ƒç´ ç§»åŠ¨åˆ°flstçš„påï¼ˆå¯ä»¥ä¸ºç›¸åŒåˆ—è¡¨ï¼‰
p, lst2, b, e|å°†lst2çš„båˆ°eç§»åŠ¨åˆ°lstçš„på‰æˆ–flstçš„påï¼ˆå¯ä»¥ä¸ºç›¸åŒåˆ—è¡¨ä½†på¿…é¡»åœ¨bã€eä¹‹å¤–ï¼‰
* ä¸Šè¿°å‡½æ•°å‡è¿”å›void
## 11
* `map`å¤´æ–‡ä»¶å®šä¹‰`map`ã€`multimap`ï¼Œ`set`å¤´æ–‡ä»¶å®šä¹‰`set`ã€`multiset`ï¼Œ`unorderd_*`å¤´æ–‡ä»¶å®šä¹‰å®ƒä»¬çš„æ•£åˆ—ç‰ˆæœ¬
* å…³è”å®¹å™¨è¿­ä»£å™¨ä¸ºbidirectional
* æœ‰åºå…³è”å®¹å™¨çš„é”®ç±»å‹å¿…é¡»æ”¯æŒ<æˆ–æŒ‡å®šæ¯”è¾ƒå‡½æ•°ï¼Œæ²¡æœ‰<å…³ç³»çš„ä¸¤ä¸ªå¯¹è±¡è®¤ä¸ºç›¸ç­‰
```c++
set<string> stop = {"a", "an", "the"};
map<string, int> count = {{"he", 3}, {"she", 2}};
bool cmp(int a, int b);
std::multiset<int, decltype(cmp) *> s(cmp); // ç¬¬äºŒä¸ªæ¨¡æ¿å‚æ•°ä¸ºå‡½æ•°æŒ‡é’ˆ
```
### pair
```c++
#include <utility>
pair<string, int> p1; // å€¼åˆå§‹åŒ–
pair<string, int> p2{"a", 1};
auto p3 = make_pair("a", 1);
auto p4 = pair<string, int>("a", 1);
p.first
p.second
p1 op p2 // å­—å…¸åº
```
### å…³è”å®¹å™¨æ“ä½œ
* set::key_type = set::value_type
* map::value_type = pair<const key_type, mapped_type>
* è¿­ä»£å™¨è§£å¼•ç”¨å¾—åˆ°value_type&
* setçš„è¿­ä»£å™¨ä¸ºconst
* å…³è”å®¹å™¨ä¸€èˆ¬ä¸ä½¿ç”¨ä½æ•ˆçš„é€šç”¨ç®—æ³•ï¼Œä½†å¯ä½œä¸ºé€šç”¨ç®—æ³•çš„æºæˆ–ç›®çš„å®¹å™¨

æ’å…¥|æ„ä¹‰
-|-
c.insert(v)ã€c.emplace(args)|æ’å…¥/æ„é€ ï¼Œå¯¹mapå’Œsetä»…å½“é”®ä¸å­˜åœ¨æ—¶æ‰§è¡Œæ’å…¥ï¼Œè¿”å›pair&lt;iterator, bool>ï¼ˆfirstæŒ‡å‘è¯¥é”®å…³è”å…ƒç´ ï¼Œè‹¥è¯¥é”®å·²å­˜åœ¨åˆ™secondä¸ºfalseï¼‰ï¼›å¯¹multimapå’Œmultisetæ‰§è¡Œæ’å…¥å¹¶è¿”å›æŒ‡å‘æ’å…¥å…ƒç´ çš„è¿­ä»£å™¨
c.insert(iter, v)ã€c.emplace(iter, args)|æ’å…¥ä½ç½®å¾ˆå¯èƒ½ä½äºiterå‰ï¼Œå¯¹mapå’Œsetè¿”å›æŒ‡å‘è¯¥é”®å…³è”å…ƒç´ çš„è¿­ä»£å™¨ï¼Œå¯¹multimapå’Œmultisetè¿”å›æŒ‡å‘æ’å…¥å…ƒç´ çš„è¿­ä»£å™¨
void c.insert(b, e)|bã€eä¸ºæŒ‡å‘value_typeçš„è¿­ä»£å™¨
void c.insert(il)|ilä¸ºvalue_typeçš„åˆå§‹åŒ–åˆ—è¡¨

åˆ é™¤|æ„ä¹‰
-|-
c.erase(key)|åˆ é™¤keyå…³è”çš„æ‰€æœ‰å…ƒç´ ï¼Œè¿”å›åˆ é™¤çš„ä¸ªæ•°
c.erase(iter)ã€c.erase(b, e)|åˆ é™¤iteræŒ‡å‘çš„/båˆ°eçš„å…ƒç´ ï¼Œè¿”å›æŒ‡å‘åˆ é™¤çš„æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„è¿­ä»£å™¨

mapã€unorderd_mapç´¢å¼•|æ„ä¹‰
-|-
mapped_type& m\[key]|è¿”å›keyå…³è”çš„å€¼çš„å¼•ç”¨ï¼ˆä¸é€‚ç”¨constå®¹å™¨ï¼‰ï¼Œè‹¥keyä¸å­˜åœ¨åˆ™æ·»åŠ keyå¹¶å€¼åˆå§‹åŒ–å€¼
mapped_type& m.at(key)|è‹¥keyå­˜åœ¨åˆ™è¿”å›å…³è”çš„å€¼å¼•ç”¨ï¼Œå¦åˆ™æŠ›å‡ºout_of_rangeå¼‚å¸¸

è®¿é—®å…ƒç´ |æ„ä¹‰
-|-
c.find(key)|è¿”å›æŒ‡å‘keyçš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨æˆ–end
c.count(key)|è¿”å›keyçš„å…ƒç´ ä¸ªæ•°
c.lower_bound(key)|è¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªé”®ä¸å°äºkeyçš„å…ƒç´ çš„è¿­ä»£å™¨
c.upper_bound(key)|è¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªé”®å¤§äºkeyçš„å…ƒç´ çš„è¿­ä»£å™¨
pair&lt;iterator, iterator> c.equal_range(key)|è¿”å›keyçš„å…ƒç´ èŒƒå›´æˆ–{end, end}
* lower_boundã€upper_boundä¸é€‚ç”¨unorderedï¼Œå¯ä½œä¸ºæ’å…¥keyçš„hint
### æ— åºå…³è”å®¹å™¨
ç®¡ç†æ“ä½œ|æ„ä¹‰
-|-
c.bucket_count()|å½“å‰æ¡¶ä¸ªæ•°
c.max_bucket_count()|æ¡¶ä¸ªæ•°æœ€å¤§å€¼
c.bucket_size(n)|nå·æ¡¶å…ƒç´ ä¸ªæ•°
c.bucket(key)|keyæ‰€åœ¨çš„æ¡¶å·
local_iterator|æ¡¶å†…è¿­ä»£å™¨ç±»å‹
const_local_iterator|æ¡¶å†…åªè¯»è¿­ä»£å™¨ç±»å‹
c.begin(n)ã€c.end(n)ã€c.cbegin(n)ã€c.cend(n)|nå·æ¡¶å†…è¿­ä»£å™¨
float c.load_factor()|å¹³å‡æ¯æ¡¶å…ƒç´ æ•°
c.max_load_factor()|è¯•å›¾ç»´æŒçš„å¹³å‡æ¯æ¡¶å…ƒç´ æ•°çš„ä¸Šé™
c.rehash(n)|é‡æ–°ç»„ç»‡ï¼Œä½¿æ¡¶ä¸ªæ•°>=nä¸”>size/max_load_factor
c.reserve(n)|é‡æ–°ç»„ç»‡ï¼Œä½¿å…ƒç´ æ•°ä¸è¶…è¿‡næ—¶æ— éœ€rehash
* å†…ç½®ç±»å‹ï¼ˆåŒ…æ‹¬æŒ‡é’ˆï¼‰ã€stringã€æ™ºèƒ½æŒ‡é’ˆå¯ç›´æ¥ç”¨ä½œkey
```c++
struct A {
    int i;
};
size_t hasher(const A &a) {
    return hash<int>()(a.i);
}
bool eq(const A &a, const A &b) {
    return a.i == b.i;
}
using A_set = unordered_set<A, decltype(hasher) *, decltype(eq) *>
A_set s(0, hasher, eq); // è‹¥Aé‡è½½äº†==åˆ™å¯çœç•¥eq
```
## 12
* `memory`å¤´æ–‡ä»¶å®šä¹‰shared_ptrã€unique_ptrã€weak_ptrã€allocator

shared_ptrã€unique_ptrå…¬å…±æ“ä½œ|æ„ä¹‰
-|-
shared_ptr&lt;T> sp; unique_ptr&lt;T> up;|æŒ‡å‘ç±»å‹Tçš„ç©ºæŒ‡é’ˆ
p|ï¼ˆä½œä¸ºæ¡ä»¶ï¼‰æ˜¯å¦éç©º
*p|è§£å¼•ç”¨
p.get()|è¿”å›è£¸æŒ‡é’ˆ
p.swap(q)ã€swap(p, q)|äº¤æ¢pã€qä¸­çš„æŒ‡é’ˆ
### shared_ptr
```c++
shared_ptr<int> p1 = make_shared<int>(); // åŠ¨æ€åˆ†é…å†…å­˜å¹¶å€¼åˆå§‹åŒ–
auto p2 = make_shared<string>(3, 'a');
auto p3(p2); // p3å’Œp2æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¼•ç”¨è®¡æ•°+1
auto p4 = make_shared<int>(1);
shared_ptr<int> p5(new int(2)); // explicit
shared_ptr<T> p6(uniq_ptr); // ä½¿uniq_pträ¸ºç©º
shared_ptr<T> p7(raw_ptr, callable); // é”€æ¯*raw_ptræ—¶ä»¥callableå–ä»£delete
p1 = p4; // p1å¼•ç”¨è®¡æ•°ä¸º0ï¼Œè‡ªåŠ¨é”€æ¯å¯¹è±¡å¹¶é‡Šæ”¾å†…å­˜
p.unique() // å¼•ç”¨è®¡æ•°æ˜¯å¦ä¸º1
p.use_count() // å¼•ç”¨è®¡æ•°ï¼Œå¯èƒ½è¾ƒæ…¢
p.reset() // ç½®ç©º
p.reset(raw_ptr[, callable])
```
* æ˜¯å¦ä½¿ç”¨å¼•ç”¨è®¡æ•°ç”±å®ç°å†³å®š
* å¤åˆ¶ã€å¤åˆ¶æ„é€ ã€è£¸æŒ‡é’ˆæ„é€ éœ€è¦æŒ‡é’ˆç±»å‹å¯è½¬æ¢
* è‡ªå®šä¹‰deleteré€‚ç”¨äºæˆå‘˜ä½¿ç”¨äº†åŠ¨æ€å†…å­˜ä½†æ— ææ„å‡½æ•°çš„å¯¹è±¡ï¼ˆå¦‚Cå¯¹è±¡ï¼‰
### å†…å­˜ç®¡ç†
```c++
string *ps1 = new string; // é»˜è®¤åˆå§‹åŒ–
string ps2 = new string(3, 'a');
int *pi = new int(); // å€¼åˆå§‹åŒ–
vector<int> *pv = new vector<int>{1, 2, 3};
auto p = new auto(obj); // å¤åˆ¶æ„é€ ï¼Œä¸å¯ç”¨{}
const int *cpi = new const int(3);
int *pn = new (nothrow) int; // å¤±è´¥è¿”å›ç©ºæŒ‡é’ˆï¼Œé»˜è®¤æŠ›å‡ºbad_allocå¼‚å¸¸
delete ps1; // ææ„+é‡Šæ”¾å†…å­˜ï¼Œå¯ä»¥æ¥å—ç©ºæŒ‡é’ˆ
```
* `new`å¤´æ–‡ä»¶å®šä¹‰nothrow
* deleteéåŠ¨æ€åˆ†é…å†…å­˜æˆ–é‡å¤deleteæ˜¯æœªå®šä¹‰è¡Œä¸º
* è‹¥ç”¨è£¸æŒ‡é’ˆåˆå§‹åŒ–shared_ptrï¼Œä¸åº”ç»§ç»­ä½¿ç”¨è£¸æŒ‡é’ˆ
* ä¸¥ç¦å¯¹getçš„æŒ‡é’ˆdeleteæˆ–åˆå§‹åŒ–å…¶ä»–æ™ºèƒ½æŒ‡é’ˆ
```c++
{
    // int *p = new int(); // æ— æ³•é‡Šæ”¾
    shared_ptr<int> p = make_shared<int>(); // æ­£å¸¸é‡Šæ”¾
    throw runtime_error();
}
```
### unique_ptr
```c++
unique_ptr<int> p1(new int(1));
// unique_ptr<int> p2(p1); // ä¸å¯å¤åˆ¶æ„é€ 
// p2 = p1; // ä¸å¯å¤åˆ¶
unique_ptr<T, D> p3, p4(raw_ptr, callable);
p = nullptr // é”€æ¯å¯¹è±¡å¹¶ç½®ç©ºp
p.release() // æ”¾å¼ƒæ‰€æœ‰æƒï¼Œè¿”å›å¯¹è±¡è£¸æŒ‡é’ˆå¹¶ç½®ç©ºp
p.reset([raw_ptr]) // é”€æ¯å¯¹è±¡ï¼Œè½¬è€ŒæŒæœ‰raw_ptræˆ–ç©º
```
* ä¸å¯å¤åˆ¶çš„ä¾‹å¤–ï¼šå‡½æ•°å¯ä»¥è¿”å›å³å°†é”€æ¯çš„unique_ptr
### weak_ptr
```c++
weak_ptr<T> p1;
weak_ptr<T> p2(sp); // ä¸shared_ptrå…±äº«å¯¹è±¡ä½†ä¸å¢åŠ å¼•ç”¨è®¡æ•°
p = wpæˆ–sp // å¯ç”¨weak_ptræˆ–shared_ptrèµ‹å€¼
p.reset() // ç½®ç©º
p.use_count() // shared_ptræ•°
p.expired() // use_countæ˜¯å¦ä¸º0
p.lock() // è‹¥expiredï¼Œè¿”å›ç©ºçš„shared_ptrï¼Œå¦åˆ™è¿”å›æŒ‡å‘è¯¥å¯¹è±¡çš„shared_ptr
```
### åŠ¨æ€æ•°ç»„
```c++
typedef string arr[10];
int *p = new arr; // æŒ‡é’ˆç±»å‹ï¼Œä¸å¯ä½¿ç”¨èŒƒå›´forã€begin/end
int *p1 = new int[3]; // é»˜è®¤åˆå§‹åŒ–
int *p2 = new int[3](); // å€¼åˆå§‹åŒ–
int *p3 = new int[3]{1, 2}; // {1, 2, 0}ï¼›å€¼åˆå§‹åŒ–
// int *p = new int[1]{1, 2}; // æŠ›å‡ºbad_array_new_lengthå¼‚å¸¸
int *p4 = new int[0];
delete[] p; // ä»åå‘å‰é”€æ¯å¯¹è±¡
unique_ptr<int[]> up(new int[3]);
up[1] // ä¸å¯ä½¿ç”¨*ã€->
shared_ptr<int> sp(new int[3], [](int *p) { delete[] p; }); // C++17æ‰å¯ä½¿ç”¨int[]
sp.get()[i]
```
* []å’Œå¾…é‡Šæ”¾æŒ‡é’ˆä¸åŒ¹é…æ˜¯æœªå®šä¹‰è¡Œä¸º
### allocator
* æŒ‰éœ€æ„é€ ï¼›é¿å…é‡å¤èµ‹å€¼ï¼›é€‚ç”¨æ— é»˜è®¤æ„é€ å‡½æ•°çš„ç±»
```c++
allocator<string> a;
auto const p = a.allocate(n); // å¯å­˜æ”¾nä¸ªstringï¼Œæœªæ„é€ 
a.construct(p + i, args) // ç”¨argsæ„é€ p[i]ï¼Œå…¶ä»–æ–¹å¼ä½¿ç”¨è¯¥å†…å­˜æ˜¯æœªå®šä¹‰è¡Œä¸º
a.destroy(p + i) // ææ„p[i]
a.deallocate(p, n) // é‡Šæ”¾å†…å­˜ï¼Œå¿…é¡»å…ˆææ„æ„é€ çš„æ‰€æœ‰å¯¹è±¡
```
* `construct`ã€`destroy`åœ¨C++17è¿‡æ—¶ï¼Œåœ¨C++20ç§»é™¤

æ„é€ ç®—æ³•|æ„ä¹‰
-|-
uninitialized_copy(b, e, dest)|båˆ°eå¤åˆ¶åˆ°æœªåˆå§‹åŒ–çš„destï¼Œè¿”å›å°¾è¿­ä»£å™¨
uninitialized_copy_n(b, n, dest)|å¤åˆ¶ä»bå¼€å§‹çš„nä¸ªå¯¹è±¡åˆ°æœªåˆå§‹åŒ–çš„destï¼Œè¿”å›å°¾è¿­ä»£å™¨
void uninitialized_fill(b, e, v)|æœªåˆå§‹åŒ–çš„båˆ°eéƒ½èµ‹å€¼ä¸ºv
uninitialized_fill_n(b, n, v)|æœªåˆå§‹åŒ–çš„bå¼€å§‹çš„nä¸ªå…ƒç´ èµ‹å€¼ä¸ºvï¼Œè¿”å›å°¾è¿­ä»£å™¨
## 13
### å¤åˆ¶æ„é€ å‡½æ•°
* ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¯¥ç±»å‹çš„å¼•ç”¨ï¼ˆå¦åˆ™ä¼ å‚ä¹Ÿéœ€è¦å¤åˆ¶æ„é€ ï¼Œæ²¡æœ‰å°½å¤´ï¼‰ï¼Œå…¶ä»–å‚æ•°æœ‰é»˜è®¤å€¼
* ç¬¬ä¸€ä¸ªå‚æ•°é€šå¸¸ä¸º`const`ï¼Œå‡½æ•°é€šå¸¸ä¸`explicit`
* æœªå®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆå¤åˆ¶æ„é€ å‡½æ•°ï¼Œé€æˆå‘˜å¤åˆ¶ï¼šç±»å˜é‡è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°ï¼Œå†…ç½®ç±»å‹å˜é‡ç›´æ¥å¤åˆ¶ï¼Œæ•°ç»„é€å…ƒç´ å¤åˆ¶ï¼ˆç±»å…ƒç´ å¤åˆ¶æ„é€ ï¼‰
### å¤åˆ¶åˆå§‹åŒ–
```c++
string s1(3, 'a'); // ç›´æ¥åˆå§‹åŒ–
string s2(s1); // ç›´æ¥åˆå§‹åŒ–ï¼Œè°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°
string s3 = s1; // å¤åˆ¶åˆå§‹åŒ–
string s4 = "x"; // éšå¼ç±»å‹è½¬æ¢+å¤åˆ¶åˆå§‹åŒ–
string s5 = string(3, 'a'); // å¤åˆ¶åˆå§‹åŒ–
```
* å¤åˆ¶åˆå§‹åŒ–è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°æˆ–ç§»åŠ¨æ„é€ å‡½æ•°
* é™¤ä½¿ç”¨`=`å®šä¹‰å˜é‡å¤–ï¼Œå¤åˆ¶åˆå§‹åŒ–è¿˜å‘ç”Ÿåœ¨ä¼ é€’éå¼•ç”¨å‚æ•°ã€è¿”å›éå¼•ç”¨å¯¹è±¡ã€åˆ—è¡¨åˆå§‹åŒ–æ•°ç»„å…ƒç´ /èšåˆç±»æˆå‘˜
* ä¸€äº›ç±»å¯¹å…¶åˆ†é…çš„å¯¹è±¡å¤åˆ¶åˆå§‹åŒ–ï¼Œå¦‚åˆå§‹åŒ–å®¹å™¨æˆ–è°ƒç”¨insertã€pushï¼Œè€Œemplaceé‡‡ç”¨ç›´æ¥åˆå§‹åŒ–
* å…è®¸ç¼–è¯‘å™¨å°†å¤åˆ¶åˆå§‹åŒ–è½¬æ¢ä¸ºç›´æ¥åˆå§‹åŒ–ï¼ˆè·³è¿‡å¤åˆ¶/ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä½†å®ƒä»¬å¿…é¡»å­˜åœ¨ä¸”å¯è®¿é—®ï¼‰
### å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦
* `ç±»& operator=(const ç±»&)`ï¼Œé€šå¸¸è¿”å›å¼•ç”¨
* æœªå®šä¹‰å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆå¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼šé€æˆå‘˜å¤åˆ¶èµ‹å€¼å¹¶è¿”å›è¢«èµ‹å€¼å¯¹è±¡çš„å¼•ç”¨
* å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ä¸€èˆ¬åŒ…å«ææ„å‡½æ•°å’Œå¤åˆ¶æ„é€ å‡½æ•°çš„åŠŸèƒ½
### ææ„å‡½æ•°
* `~ç±»() {}`ï¼Œå…ˆæ‰§è¡Œå‡½æ•°ä½“ï¼ˆä¸»è¦ä¸ºé‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼‰ï¼Œå†é”€æ¯æˆå‘˜ï¼šå†…ç½®ç±»å‹æˆå‘˜æ— åŠ¨ä½œï¼Œç±»æˆå‘˜è°ƒç”¨å…¶ææ„å‡½æ•°
* ææ„å‡½æ•°è°ƒç”¨æ—¶æœºï¼šå˜é‡ä½œç”¨åŸŸç»“æŸï¼Œæˆå‘˜æ‰€å±å¯¹è±¡é”€æ¯ï¼Œå…ƒç´ æ‰€å±å®¹å™¨é”€æ¯ï¼ŒåŠ¨æ€å†…å­˜çš„æŒ‡é’ˆdeleteï¼Œä¸´æ—¶å¯¹è±¡åˆ›å»ºçš„è¯­å¥ç»“æŸ
* æœªå®šä¹‰ææ„å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆææ„å‡½æ•°ï¼Œä¸ç©ºå‡½æ•°ä½“ææ„å‡½æ•°è¯­ä¹‰ç›¸åŒ
* åˆ†é…åŠ¨æ€å†…å­˜çš„ç±»éœ€è¦å®šä¹‰ææ„å‡½æ•°ï¼Œä¹Ÿéœ€è¦å®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°ã€å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼ˆå¦åˆ™å¤šä¸ªæŒ‡é’ˆå€¼ç›¸åŒï¼Œé”™è¯¯/å¤šæ¬¡é‡Šæ”¾å†…å­˜ï¼‰ï¼›ä¸ºé¿å…ä¸å¿…è¦çš„å¤åˆ¶å¼€é”€ï¼Œä¸€èˆ¬éœ€è¦å®šä¹‰ç§»åŠ¨æ„é€ å‡½æ•°ã€ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦
* éœ€è¦å¤åˆ¶æ„é€ å‡½æ•°çš„ç±»æœªå¿…éœ€è¦å®šä¹‰ææ„å‡½æ•°ï¼ˆå¦‚å¸¦ç‹¬ç‰¹åºå·çš„å¯¹è±¡ï¼‰ï¼Œä½†ä¸€èˆ¬éœ€è¦å®šä¹‰å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼Œåä¹‹äº¦ç„¶
### åˆæˆå‡½æ•°
* é»˜è®¤æ„é€ å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°ã€å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ã€ææ„å‡½æ•°å¯ç”¨`=default`æ˜¾å¼è®©ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆå‡½æ•°ï¼Œç±»å¤–`=default`åˆ™ä¸å†…è”
* ä»»ä½•å‡½æ•°å¯ç”¨`=delete`è®©ç¼–è¯‘å™¨ä¸å®šä¹‰è¯¥å‡½æ•°ï¼Œå¿…é¡»åœ¨ç±»å†…ï¼Œä¸€èˆ¬ç”¨äºç¦æ­¢å¤åˆ¶å¯¹è±¡
* è‹¥ææ„å‡½æ•°`=delete`ï¼Œåˆ™åªèƒ½åŠ¨æ€æ„é€ å¯¹è±¡ï¼Œä¸”ä¸èƒ½é”€æ¯
* è‹¥ç±»æœ‰æˆå‘˜çš„ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œåˆ™åˆæˆææ„å‡½æ•°`=delete`
* è‹¥ç±»æœ‰æˆå‘˜çš„å¤åˆ¶æ„é€ å‡½æ•°æˆ–ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œåˆ™åˆæˆå¤åˆ¶æ„é€ å‡½æ•°`=delete`
* è‹¥ç±»æœ‰æˆå‘˜çš„å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œæˆ–æœ‰æˆå‘˜ä¸º`const`æˆ–å¼•ç”¨ï¼Œåˆ™åˆæˆå¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦`=delete`
* è‹¥ç±»æœ‰æˆå‘˜çš„ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œæˆ–æœ‰æˆå‘˜ä¸ºå¼•ç”¨ä½†æ²¡æœ‰ç±»å†…åˆå€¼ï¼Œæˆ–æœ‰æˆå‘˜ä¸º`const`ä½†æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ä¸”æ²¡æœ‰ç±»å†…åˆå€¼ï¼Œåˆ™åˆæˆå¤åˆ¶æ„é€ å‡½æ•°`=delete`
* C++11å‰é€šè¿‡å£°æ˜å‡½æ•°ä¸º`private`ä½†ä¸æä¾›å®šä¹‰ï¼Œå¯è¾¾åˆ°`=delete`æ•ˆæœï¼ˆç±»å†…ã€å‹å…ƒä½¿ç”¨è¯¥å‡½æ•°äº§ç”Ÿé“¾æ¥é”™è¯¯ï¼‰
### æ·±æ‹·è´
```c++
class A {
    string *p;
public:
    A(const string &s = string()): p(new string(s)) {}
    A(const A &a): p(new string(*a.p)) {}
    A& operator=(const A &a) {
        auto temp = new string(*a.p); // å¤„ç†a=açš„æƒ…å†µï¼Œä¸”ä¸åœ¨å¼‚å¸¸å‘ç”Ÿå‰ä¿®æ”¹this
        delete p;
        p = temp;
        return *this;
    }
    ~A() {
        delete p;
    }
    friend void swap(A &a, A &b);
    A(A &&a) noexcept;
    A& operator=(A &&a) noexcept;
};
inline void swap(A &a, A &b) { // é¿å…3æ¬¡æ·±æ‹·è´
    using std::swap; // åç»­swapè°ƒç”¨è‡ªåŠ¨é€‰æ‹©åº“/è‡ªå®šä¹‰ç‰ˆæœ¬
    swap(a.p, b.p);
}
```
### æµ…æ‹·è´ï¼ˆå¼•ç”¨è®¡æ•°ï¼‰
```c++
class A {
    string *p;
    size_t *count;
public:
    A(const string &s = string()): p(new string(s)), count(new size_t(1)) {}
    A(const A &a): p(a.p), count(a.count) { ++*count; }
    A& operator=(const A &a) {
        ++*a.count;
        if(--*count == 0) {
            delete p;
            delete count;
        }
        p = a.p;
        count = a.count;
        return *this;
    }
    ~A() {
        if(--*count == 0) {
            delete p;
            delete count;
        }
    }
};
```
### swapå®ç°å¤åˆ¶/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦
```c++
A& operator=(A a) { // å¤åˆ¶/ç§»åŠ¨æ„é€ ï¼Œè‡ªåŠ¨è§£å†³a=aå’Œå¼‚å¸¸é—®é¢˜
    swap(*this, a);
    return *this;
}
```
### å³å€¼å¼•ç”¨
```c++
int i = 0;
int &&r1 = i * 1; // å³å€¼
// int &&r2 = i; // é”™è¯¯ï¼šä¸å¯ç»‘å®šå·¦å€¼
// int &&r3 = r1; // é”™è¯¯ï¼šå³å€¼å¼•ç”¨å˜é‡ä¹Ÿæ˜¯å·¦å€¼
int &&r4 = move(i); // å·¦å€¼è½¬ä¸ºå³å€¼ï¼Œä¹‹åä¸å¯å†ä½¿ç”¨içš„å€¼
```
* å¼•ç”¨çš„å¯¹è±¡æ˜¯ä¸´æ—¶å¯¹è±¡ï¼Œæ²¡æœ‰å…¶ä»–ä½¿ç”¨è€…ï¼Œå³å°†è¢«é”€æ¯
* å¤´æ–‡ä»¶`utility`å®šä¹‰`move`ï¼Œè½¬ç§»å¯¹è±¡æŒæœ‰çš„åŠ¨æ€å†…å­˜å¹¶ä¿è¯å¯¹è±¡å¯å®‰å…¨é”€æ¯
* å³å€¼å¼•ç”¨å˜é‡è‹¥è¦ä½œä¸ºå³å€¼ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼Œéœ€è¦ä½¿ç”¨`move`
* ä¼ é€’å³å€¼å‚æ•°ï¼ˆéconst T&&ï¼‰æ—¶ï¼Œf(T)å’Œf(const T&)å†²çªï¼Œf(T)å’Œf(T&&)å†²çªï¼Œf(const T&)å’Œf(T&&)åŒ¹é…åè€…
### ç§»åŠ¨æ„é€ å‡½æ•°
* ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¯¥ç±»å‹çš„å³å€¼å¼•ç”¨ï¼Œå…¶ä»–å‚æ•°æœ‰é»˜è®¤å€¼
```c++
// æ¥æ·±æ‹·è´A
A::A(A &&a) noexcept : p(a.p) {
    a.p = nullptr; // ä¿è¯è¢«ç§»åŠ¨å¯¹è±¡å¯é”€æ¯ã€å€¼æœ‰æ•ˆ
}
```
* å®¹å™¨æ“ä½œä¿è¯å¼‚å¸¸å‘ç”Ÿæ—¶å®¹å™¨å†…å®¹ä¸å˜ï¼Œå¦‚`vector`é‡æ–°åˆ†é…å†…å­˜å¤±è´¥ä¸å½±å“åŸå…ˆå†…å®¹ï¼›è‹¥è¦åœ¨é‡æ–°åˆ†é…æ—¶ç§»åŠ¨è€Œéå¤åˆ¶å…ƒç´ ï¼Œå…ƒç´ ç±»å‹çš„ç§»åŠ¨æ„é€ å‡½æ•°å¿…é¡»ä¸º`noexcept`
### ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦
```c++
// æ¥æ·±æ‹·è´A
A& A::operator=(A &&a) noexcept {
    if(this != &a) { // aæœ‰å¯èƒ½é€šè¿‡moveå¾—åˆ°
        delete p;
        p = a.p;
        a.p = nullptr;
    }
    return *this;
}
```
### ç§»åŠ¨ä¸å¤åˆ¶
* è‹¥æœªå®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°ã€å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦å’Œææ„å‡½æ•°ï¼Œä¸”æˆå‘˜å‡å¯ç§»åŠ¨æ„é€ /èµ‹å€¼ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆç§»åŠ¨æ„é€ å‡½æ•°/åˆæˆç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦
* è‹¥å®šä¹‰äº†ç§»åŠ¨æ„é€ å‡½æ•°/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼Œåˆ™åˆæˆå¤åˆ¶æ„é€ å‡½æ•°/åˆæˆå¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦`=delete`
* ç¼–è¯‘å™¨é»˜è®¤ä¸ç”Ÿæˆ`=delete`åˆæˆç§»åŠ¨å‡½æ•°ï¼Œé™¤éæ˜¾å¼æŒ‡å®šç§»åŠ¨å‡½æ•°ä¸º`=default`ä¸”æœ‰æˆå‘˜æ— æ³•ç§»åŠ¨ï¼ˆè§ä¸‹ï¼‰
* è‹¥ç±»æœ‰æˆå‘˜çš„ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œåˆ™åˆæˆç§»åŠ¨æ„é€ å‡½æ•°`=delete`
* è‹¥ç±»æœ‰æˆå‘˜çš„ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œæˆ–æœ‰æˆå‘˜ä¸º`const`æˆ–å¼•ç”¨ï¼Œåˆ™åˆæˆç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦`=delete`
* å¤åˆ¶ã€ç§»åŠ¨å‡½æ•°åŒæ—¶å­˜åœ¨æ—¶ï¼Œå·¦å€¼åŒ¹é…å¤åˆ¶å‡½æ•°ï¼Œå³å€¼åŒ¹é…ç§»åŠ¨å‡½æ•°ï¼›åªæœ‰å¤åˆ¶å‡½æ•°æ—¶ä¸€å¾‹å¤åˆ¶ï¼ˆåŒ…æ‹¬ä½¿ç”¨`move`ï¼‰
### ç§»åŠ¨è¿­ä»£å™¨
```c++
move_iterator<T> make_move_iterator(T iter)
```
* è§£å¼•ç”¨è¿”å›å³å€¼å¼•ç”¨ï¼Œå¯ç”¨äº`uninitialized_copy`å®ç°ç§»åŠ¨è¯­ä¹‰
* æ ‡å‡†åº“ä¸ä¿è¯å“ªä¸ªç®—æ³•å¯ä»¥ä½¿ç”¨ç§»åŠ¨è¿­ä»£å™¨
### å·¦/å³å€¼å¼•ç”¨æˆå‘˜å‡½æ•°
```c++
class A {
    void f() &; // å·¦å€¼å¯è°ƒç”¨
    void g() &&; // å³å€¼å¯è°ƒç”¨
    void h() const &; // constå¿…é¡»å‡ºç°åœ¨å·¦è¾¹
}
void A::f() & {} // å£°æ˜å’Œå®šä¹‰çš„&å¿…é¡»ä¸€è‡´
```
* å¼•ç”¨æˆå‘˜å‡½æ•°å’Œå‚æ•°ç›¸åŒçš„æ™®é€šæˆå‘˜å‡½æ•°å†²çª
## 14
* é™¤`()`å¤–ï¼Œè¿ç®—ç¬¦å‡½æ•°ä¸èƒ½æœ‰é»˜è®¤å‚æ•°
* è¿ç®—ç¬¦å‡½æ•°ä½œä¸ºæˆå‘˜å‡½æ•°æ—¶ï¼Œ`this`ä¸ºç¬¬ä¸€ä¸ªè¿ç®—æ•°ï¼Œå‚æ•°æ¯”æ­£å¸¸å°‘ä¸€ä¸ªï¼Œæ˜¾å¼è°ƒç”¨ï¼š`obj1.operator+(obj2)`
* è¿ç®—ç¬¦å‡½æ•°ä¸ä½œä¸ºæˆå‘˜å‡½æ•°æ—¶ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°ä¸ºç±»ç±»å‹ï¼Œæ˜¾å¼è°ƒç”¨ï¼š`operator+(obj1, obj2)`
* è¿ç®—ç¬¦é‡è½½ä¿æŒä¼˜å…ˆçº§å’Œç»“åˆå¾‹
* è¿ç®—ç¬¦é‡è½½ä¸ä¿æŒæ±‚å€¼é¡ºåºã€çŸ­è·¯æ±‚å€¼ç‰¹æ€§ï¼Œ`&&`ã€`||`ã€`,`ï¼ˆä»¥åŠæœ‰é»˜è®¤è¯­ä¹‰çš„`&`ï¼‰ä¸åº”é‡è½½
* `::`ã€`.*`ã€`.`ã€`?:`ä¸èƒ½é‡è½½
* `=`ã€`[]`ã€`()`ã€`->`å¿…é¡»ä½œä¸ºæˆå‘˜å‡½æ•°
* å¤åˆèµ‹å€¼ã€è‡ªå¢è‡ªå‡ã€è§£å¼•ç”¨åº”ä½œä¸ºæˆå‘˜å‡½æ•°
* ç®—æœ¯ã€å…³ç³»ç­‰äºŒå…ƒè¿ç®—ç¬¦ä¸åº”ä½œä¸ºæˆå‘˜å‡½æ•°
### è¾“å…¥è¾“å‡º
```c++
ostream& operator<<(ostream&, const T&);
istream& operator>>(istream&, T&);
```
* ç”±äºè¦è¯»å†™ç§æœ‰æˆå‘˜ï¼Œä¸€èˆ¬ä¸ºç±»çš„å‹å…ƒå‡½æ•°
* è¾“å…¥å‡½æ•°ä¸€èˆ¬è¦å¤„ç†è¯»å–å¤±è´¥
### ç®—æœ¯/å…³ç³»
```c++
T operator+(const T &a, const T &b) {
    T temp = a;
    temp += b;
    return temp;
}
```
* è‹¥ç”¨`+`å®ç°`+=`ï¼Œå°†äº§ç”Ÿä¸å¿…è¦çš„ä¸´æ—¶å¯¹è±¡
* è‹¥å®ç°äº†`==`ï¼Œåˆ™å…³ç³»è¿ç®—ç¬¦åº”ä¸`==`åè°ƒ
### èµ‹å€¼
```c++
conatiner<T>& conatiner<T>::operator=(initializer_list<T>);
T& T::operator+=(const T &a);
```
### ä¸‹æ ‡
```c++
T& container<T>::operator[](size_t);
const T& container<T>::operator[](size_t) const;
```
### è‡ªå¢
```c++
T& T::operator++(); // å‰ç½®
T T::operator++(int) { // åç½®ï¼Œintå‚æ•°ä»…ç”¨äºåŒºåˆ†
    T temp = *this;
    ++*this;
    return temp;
}
obj.operator++(); // å‰ç½®
obj.operator++(0); // åç½®
```
### è®¿é—®æˆå‘˜
```c++
T& iterator<T>::operator*() const;
T* iterator<T>::operator->() const {
    return &this->operator*();
}
```
* `->`çš„è¿”å›å€¼å¿…é¡»æ˜¯æŒ‡é’ˆæˆ–é‡è½½äº†`->`çš„å¯¹è±¡ï¼Œåè€…å°†è‡ªåŠ¨ç»§ç»­è°ƒç”¨`->`ç›´åˆ°è¿”å›æŒ‡é’ˆï¼Œå†è®¿é—®æˆå‘˜
### å‡½æ•°è°ƒç”¨
```c++
return_t T::operator()(args);
```
* lambdaæœ¬è´¨ä¸ºå‡½æ•°å¯¹è±¡ï¼Œé»˜è®¤`()`ä¸º`const`ï¼Œé™¤éå£°æ˜ä¸º`mutable`
### å‡½æ•°å¯¹è±¡
```c++
#include <functional>
logical_and<int> intAnd; // bool operator()(int, int)
intAnd(1, 2) // 1 && 2
```
ç®—æœ¯|å…³ç³»|é€»è¾‘
-|-|-
plus|equal_to|logical_and
minus|not_equal_to|logical_or
multiplies|greater|logical_not
divides|greater_equal
modulus|less
negate|less_equal
* æ¥å—ä¸€ä¸ªæ¨¡æ¿å‚æ•°
* æ— å…³æŒ‡é’ˆçš„æ¯”è¾ƒæœªå®šä¹‰ï¼Œä½†`sort(b, e, less<T*>())`å¯ä»¥æŒ‰å€¼æ’åºæŒ‡é’ˆ
* æœ‰åºå…³è”å®¹å™¨é»˜è®¤ä½¿ç”¨`less<T>`
### function
```c++
function<int(int, int)> f1 = [](int a, int b) { return a + b; } // å‡½æ•°æŒ‡é’ˆã€functorã€lambda
int (*fp)(int, int) = add;
function<int(int, int)> f2(fp); // è‹¥addæœ‰é‡è½½å‡½æ•°ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨å‡½æ•°å
function<int(int)> f3, f4(nullptr); // ç©ºå‡½æ•°ï¼Œä¸å¯è°ƒç”¨
f3 // æ˜¯å¦ä¸ºç©º
f1(1, 2)
function<>::result_type
function<>::argument_type // ä¸€å…ƒå‡½æ•°å‚æ•°ç±»å‹
function<>::first_argument_type // äºŒå…ƒå‡½æ•°å‚æ•°ç±»å‹
function<>::second_argument_type
```
### ç±»å‹è½¬æ¢
```c++
class Integer {
    int i;
public:
    Integer(int i = 0) : i(i) {}
    operator int() const { return i; }
};
Integer i = 2;
int j = i + 3;
```
* `explicit`ç¦ç”¨å¤§å¤šæ•°éšå¼ç±»å‹è½¬æ¢ï¼Œä½†å¯ç”¨`static_cast`æ˜¾å¼ç±»å‹è½¬æ¢
* `explicit`çš„ä¾‹å¤–ï¼š`if`/å¾ªç¯/`?:`çš„æ¡ä»¶ï¼Œé€»è¾‘è¿ç®—ç¬¦çš„è¿ç®—æ•°
* ä¸åº”åŒæ—¶å®šä¹‰`A::A(const B&)`å’Œ`B::operator A()`
* ä¸åº”ä»å¤šç§ç®—æœ¯ç±»å‹è½¬æ¢ï¼Œä¹Ÿä¸åº”è½¬æ¢ä¸ºå¤šç§ç®—æœ¯ç±»å‹
```c++
void f(A);
void f(B);
// f(0) // ä¸æ˜¯åŒä¸€ç±»å‹è½¬æ¢ï¼ŒA::A(int)ä¸æ¯”B::B(double)ä¼˜å…ˆ
void g(C);
g((short)0) // åŒä¸€ç±»å‹è½¬æ¢short->Cï¼Œæ¯”è¾ƒè½¬æ¢å‡½æ•°ä¹‹å‰æˆ–ä¹‹åçš„æ ‡å‡†è½¬æ¢ï¼ŒC::C(int)æ¯”C::C(double)ä¼˜å…ˆ
```
## 15
```c++
struct Base {
    Base() {}
    Base(const Base &b) {}
    Base(Base &&b) noexcept {}
    Base& operator=(const Base &b) { return *this; }
    Base& operator=(Base &&b) noexcept { return *this; }
    virtual ~Base() = default;

    void f() {}
    virtual void vf() const {}
    static void sf() {}
};
struct Derived; // æ´¾ç”Ÿç±»å£°æ˜ä¸åŒ…æ‹¬æ´¾ç”Ÿåˆ—è¡¨
struct Derived : public Base { // åŸºç±»å¿…é¡»å·²å®šä¹‰
    Derived() {}
    Derived(const Derived &d) : Base(d) {} // çœç•¥Base(d)åˆ™åŸºç±»é»˜è®¤åˆå§‹åŒ–
    Derived(Derived &&d) noexcept : Base(move(d)) {}
    Derived& operator=(const Derived &d) {
        Base::operator=(d);
        return *this;
    }
    Derived& operator=(Derived &&d) {
        Base::operator=(move(d));
        return *this;
    }

    auto vf() const -> void override final { // ä¸å¯è¢«é‡å†™
        Derived::sf(); // Base::sf()
        sf();
    }
};
class Last final : Derived {}; // ä¸å¯è¢«ç»§æ‰¿
```
### ç»§æ‰¿
* æ´¾ç”Ÿç±»æŒ‡é’ˆ/å¯¹è±¡å¯ä»¥è‡ªåŠ¨è½¬æ¢ä¸ºåŸºç±»æŒ‡é’ˆ/å¼•ç”¨ï¼Œä½†åä¹‹ä¸è¡Œ
* è‹¥åŸºç±»è‡³å°‘æœ‰ä¸€ä¸ªè™šå‡½æ•°ï¼Œå¯ç”¨`dynamic_cast`å°†åŸºç±»æŒ‡é’ˆ/å¼•ç”¨è½¬ä¸ºæ´¾ç”Ÿç±»æŒ‡é’ˆ/å¼•ç”¨ï¼Œè¿è¡Œæ—¶æ£€æŸ¥ï¼›å·²çŸ¥è¯¥è½¬æ¢åˆæ³•æ—¶ï¼Œå¯ç”¨`static_cast`
* `åŸºç±»(æ´¾ç”Ÿç±»å¯¹è±¡)`ä¸ºå¤åˆ¶æ„é€ ï¼Œåªæ¶‰åŠæ´¾ç”Ÿç±»ä¸­å±äºåŸºç±»çš„éƒ¨åˆ†
* æ´¾ç”Ÿç±»çš„æˆå‘˜å±è”½åŸºç±»çš„åŒåæˆå‘˜ï¼Œè®¿é—®åŸºç±»åŒåæˆå‘˜éœ€åŠ `åŸºç±»::`
* æ´¾ç”Ÿç±»é‡å†™åŸºç±»çš„éƒ¨åˆ†é‡è½½å‡½æ•°ï¼Œå¯ç”¨`using`å–æ¶ˆå¯¹æœªé‡å†™çš„é‡è½½å‡½æ•°çš„å±è”½
### è™šå‡½æ•°
* é™¤æ„é€ å‡½æ•°å¤–çš„éé™æ€æˆå‘˜å‡½æ•°ï¼Œç±»å†…å£°æ˜ä¸º`virtual`åˆ™ä¸ºè™šå‡½æ•°ï¼Œé€šè¿‡æŒ‡é’ˆ/å¼•ç”¨è°ƒç”¨æ—¶åŠ¨æ€ç»‘å®šï¼›éè™šå‡½æ•°æˆ–ä¸é€šè¿‡æŒ‡é’ˆ/å¼•ç”¨è°ƒç”¨çš„è™šå‡½æ•°ç¼–è¯‘æ—¶ç»‘å®š
* åŸºç±»å£°æ˜çš„è™šå‡½æ•°ï¼Œåœ¨æ´¾ç”Ÿç±»ä¸­é»˜è®¤ä¹Ÿä¸ºè™šå‡½æ•°
* `override`æ˜¾å¼å£°æ˜è¯¥å‡½æ•°ä¸ºé‡å†™çš„è™šå‡½æ•°
* ä¸é‡å†™å‡½æ•°åˆ™é»˜è®¤åŸºç±»ç‰ˆæœ¬
* é‡å†™å‡½æ•°å‚æ•°å¿…é¡»ä¸åŸºç±»ç›¸åŒï¼Œè¿”å›å€¼å¯ä»¥ä¸åŒï¼Œä½†ä»…é™æœ‰ç»§æ‰¿å…³ç³»çš„æŒ‡é’ˆ/å¼•ç”¨
* æŒ‡é’ˆã€å¼•ç”¨çš„é™æ€ï¼ˆç¼–è¯‘æ—¶ï¼‰/åŠ¨æ€ï¼ˆè¿è¡Œæ—¶ï¼‰ç±»å‹å¯ä»¥ä¸åŒï¼Œå…¶ä»–è¡¨è¾¾å¼çš„é™æ€/åŠ¨æ€ç±»å‹ç›¸åŒ
* è‹¥è™šå‡½æ•°ä½¿ç”¨é»˜è®¤å‚æ•°ï¼Œåˆ™é»˜è®¤å€¼ä¸ºé™æ€è°ƒç”¨æ—¶çš„é»˜è®¤å€¼ï¼Œå› æ­¤åŸºç±»å’Œæ´¾ç”Ÿç±»çš„è™šå‡½æ•°çš„å‚æ•°é»˜è®¤å€¼åº”ç›¸åŒ
* `åŸºç±»æŒ‡é’ˆ->åŸºç±»::è™šå‡½æ•°()`å¼ºåˆ¶ç¼–è¯‘æ—¶ç»‘å®šï¼Œä¸€èˆ¬ä»…ç”¨äºæˆå‘˜å‡½æ•°/å‹å…ƒå‡½æ•°ä¸­
* è™šå‡½æ•°å£°æ˜ä¸º`=0`åˆ™ä¸ºçº¯è™šå‡½æ•°ï¼Œå«çº¯è™šå‡½æ•°çš„ç±»æˆ–ç»§æ‰¿è‡ªæŠ½è±¡ç±»ä½†æœªé‡å†™çº¯è™šå‡½æ•°çš„ç±»ä¸ºæŠ½è±¡ç±»ï¼Œä¸å¯å®ä¾‹åŒ–ï¼Œä½†æ„é€ å‡½æ•°ä»è¢«æ´¾ç”Ÿç±»è°ƒç”¨
### è®¿é—®æ§åˆ¶
* `protected`æˆå‘˜å…è®¸æ´¾ç”Ÿç±»åŠå…¶å‹å…ƒè®¿é—®ï¼Œç¦æ­¢å…¶ä»–ç±»è®¿é—®
* æ´¾ç”Ÿç±»å®šä¹‰ä¸º`class`åˆ™é»˜è®¤`private`ç»§æ‰¿ï¼Œå®šä¹‰ä¸º`struct`åˆ™é»˜è®¤`public`ç»§æ‰¿
* ç»§æ‰¿æ–¹å¼å†³å®šäº†ç”¨æˆ·ä»£ç è®¿é—®æ´¾ç”Ÿç±»ç»§æ‰¿è‡ªåŸºç±»çš„æˆå‘˜çš„æƒé™ï¼Œæ´¾ç”Ÿç±»åŠå…¶å‹å…ƒä¸å—ç»§æ‰¿æ–¹å¼é™åˆ¶
* åªæœ‰`public`ç»§æ‰¿å…è®¸ç”¨æˆ·ä»£ç åœ¨ä½¿ç”¨åŸºç±»çš„åœ°æ–¹ä½¿ç”¨æ´¾ç”Ÿç±»
* `protected`ç»§æ‰¿å…è®¸æ´¾ç”Ÿç±»çš„æ´¾ç”Ÿç±»åŠå…¶å‹å…ƒè®¿é—®åŸºç±»çš„`public`å’Œ`protected`æˆå‘˜
* å‹å…ƒç±»çš„æ´¾ç”Ÿç±»ä¸æ˜¯å‹å…ƒç±»
* æ´¾ç”Ÿç±»è®¿é—®æ§åˆ¶ç¬¦åçš„`using åŸºç±»::æˆå‘˜;`ä½¿å¾—åŸºç±»çš„æˆå‘˜ï¼ˆè¦æ±‚æ´¾ç”Ÿç±»å¯ä»¥è®¿é—®è¯¥æˆå‘˜ï¼‰ä½œä¸ºæ´¾ç”Ÿç±»çš„æˆå‘˜æœä»è®¿é—®æ§åˆ¶ç¬¦ï¼ˆè€Œéæœä»åŸºç±»çš„è®¿é—®æ§åˆ¶ç¬¦æˆ–ç»§æ‰¿æ–¹å¼ï¼‰
### æ„é€ /å¤åˆ¶/ææ„
* åŸºç±»å…ˆäºæ´¾ç”Ÿç±»æ„é€ ï¼Œåˆå§‹åŒ–åˆ—è¡¨å¯ä»¥è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ï¼Œä¸æŒ‡å®šåˆ™è°ƒç”¨åŸºç±»çš„é»˜è®¤æ„é€ å‡½æ•°
* æ´¾ç”Ÿç±»æ˜¾å¼å®šä¹‰çš„æ„é€ å‡½æ•°ã€èµ‹å€¼è¿ç®—ç¬¦éœ€è¦æ˜¾å¼è°ƒç”¨åŸºç±»ç›¸å…³å‡½æ•°
* `using åŸºç±»::åŸºç±»`ç»§æ‰¿åŸºç±»é™¤é»˜è®¤ã€å¤åˆ¶ã€ç§»åŠ¨æ„é€ å‡½æ•°å¤–çš„å…¶ä»–æ„é€ å‡½æ•°ï¼Œæ´¾ç”Ÿç±»çš„æˆå‘˜é»˜è®¤åˆå§‹åŒ–ï¼Œè¯¥æ„é€ å‡½æ•°å¯è®¿é—®æ€§ã€`explicit`ã€`constexpr`ä¸å…¶åœ¨åŸºç±»ä¸­çš„æ€§è´¨ç›¸åŒï¼›å¯¹æœ‰é»˜è®¤å€¼çš„åŸºç±»æ„é€ å‡½æ•°ï¼Œæ´¾ç”Ÿç±»ç»§æ‰¿å¤šä¸ªä¸å¸¦é»˜è®¤å€¼çš„æ„é€ å‡½æ•°ï¼›æ´¾ç”Ÿç±»å®šä¹‰çš„æ„é€ å‡½æ•°è¦†ç›–ç»§æ‰¿çš„ç›¸åŒå‚æ•°çš„æ„é€ å‡½æ•°ï¼›è‹¥æ´¾ç”Ÿç±»åªæœ‰ç»§æ‰¿çš„æ„é€ å‡½æ•°ï¼ˆåŒ…æ‹¬ç›¸åŒå‚æ•°è¦†ç›–ï¼‰ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆé»˜è®¤æ„é€ å‡½æ•°
* æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°åªè´Ÿè´£é”€æ¯è‡ªå·±çš„èµ„æºï¼Œå®Œæˆåè‡ªåŠ¨è°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°
* åŸºç±»çš„ææ„å‡½æ•°åº”ä¸ºè™šå‡½æ•°ï¼Œä»¥ä¿è¯åŠ¨æ€åˆ†é…å¯¹è±¡çš„æ­£å¸¸é‡Šæ”¾ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨ä¸ç”Ÿæˆåˆæˆç§»åŠ¨æ„é€ å‡½æ•°/åˆæˆç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼Œä»è€Œæ´¾ç”Ÿç±»ä¹Ÿä¸ç”Ÿæˆï¼›è‹¥è¦æ´¾ç”Ÿç±»ç”Ÿæˆåˆæˆç§»åŠ¨å‡½æ•°ï¼ŒåŸºç±»å¯ä»¥å®šä¹‰ç§»åŠ¨å‡½æ•°`=default`ï¼ˆä»è€Œä¹Ÿè¦å®šä¹‰å¤åˆ¶å‡½æ•°ï¼‰
* æ„é€ å‡½æ•°/ææ„å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼ŒåŠ¨æ€ç±»å‹ä¸æ„é€ /ææ„å‡½æ•°æ‰€åœ¨ç±»å‹ç›¸åŒ
* è‹¥åŸºç±»çš„é»˜è®¤æ„é€ å‡½æ•°/å¤åˆ¶æ„é€ å‡½æ•°/å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦/ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œåˆ™æ´¾ç”Ÿç±»çš„ç›¸åº”åˆæˆå‡½æ•°`=delete`
* è‹¥åŸºç±»çš„ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œåˆ™æ´¾ç”Ÿç±»çš„åˆæˆé»˜è®¤ã€å¤åˆ¶æ„é€ å‡½æ•°`=delete`
* è‹¥åŸºç±»çš„ç§»åŠ¨æ„é€ å‡½æ•°/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œåˆ™æ´¾ç”Ÿç±»ä¸ç”Ÿæˆåˆæˆç§»åŠ¨æ„é€ å‡½æ•°/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼Œ`=default`åˆ™ç”Ÿæˆ`=delete`
### å®¹å™¨
* åœ¨å®¹å™¨ä¸­ä½¿ç”¨ç»§æ‰¿ï¼Œåº”å­˜æ”¾ï¼ˆæ™ºèƒ½ï¼‰æŒ‡é’ˆï¼ŒåŸºç±»æ™ºèƒ½æŒ‡é’ˆå¯ä»¥è‡ªåŠ¨è½¬æ¢ä¸ºæ´¾ç”Ÿç±»æ™ºèƒ½æŒ‡é’ˆ
* ä¸ºå‘å®¹å™¨æ’å…¥åŸºç±»ï¼ˆæ™ºèƒ½ï¼‰æŒ‡é’ˆï¼Œå¯ä»¥åœ¨åŸºç±»ã€æ´¾ç”Ÿç±»å®šä¹‰è™šå‡½æ•°cloneè¿”å›æŒ‡å‘åŠ¨æ€åˆ†é…å¯¹è±¡çš„æŒ‡é’ˆ
## 16
### å‡½æ•°æ¨¡æ¿
```c++
template <typename T>
int compare(const T &a, const T &b) {
    if(less<T>()(a, b)) return -1;
    if(less<T>()(b, a)) return 1;
    return 0;
}
compare(1, 0) // T = int

template <size_t N>
size_t len(const char (&s)[N])
{
    return N - 1;
}
len("123"); // 3
```
* `typename`å¯æ¢æˆ`class`
* éç±»å‹æ¨¡æ¿å‚æ•°å¿…é¡»ä¸ºå¸¸é‡è¡¨è¾¾å¼
* `inline`ã€`constexpr`å¯å‡ºç°åœ¨æ¨¡æ¿å‚æ•°åˆ—è¡¨å
* ç¼–è¯‘å™¨ä¸å¯¹æ¨¡æ¿å®šä¹‰ç”Ÿæˆä»£ç ï¼Œè€Œåœ¨æ¨¡æ¿å®ä¾‹åŒ–æ—¶ç”Ÿæˆä»£ç 
* ä¸€èˆ¬åœ¨å¤´æ–‡ä»¶å®šä¹‰ç±»ã€å£°æ˜ï¼ˆæˆå‘˜ï¼‰å‡½æ•°ï¼Œä½†æ¨¡æ¿ç±»çš„æˆå‘˜å‡½æ•°ã€æ¨¡æ¿å‡½æ•°åº”åœ¨å¤´æ–‡ä»¶å®šä¹‰
### ç±»æ¨¡æ¿
```c++
template <typename> struct C; // é™å®šå‹å…ƒçš„æ¨¡æ¿å‚æ•°æ—¶å¿…é¡»æå‰å£°æ˜
template <typename> struct Blob;
template <typename T> bool operator==(const Blob<T>&, const Blob<T>&);
template <typename T>
struct Blob {
    Blob(); // ç±»ä½œç”¨åŸŸå†…ä½¿ç”¨ç±»åä¸éœ€è¦å¸¦æ¨¡æ¿å‚æ•°
    friend T; // Tæ˜¯Blob<T>çš„å‹å…ƒ
    friend class A; // Aæ˜¯Blobæ‰€æœ‰å®ä¾‹çš„å‹å…ƒ
    template <typename X> friend class B; // Bçš„æ‰€æœ‰å®ä¾‹æ˜¯Blobæ‰€æœ‰å®ä¾‹çš„å‹å…ƒ
    friend class C<T>; // C<T>æ˜¯Blob<T>çš„å‹å…ƒ
    friend bool operator==<T>(const Blob<T>&, const Blob<T>&); // operator==<T>æ˜¯Blob<T>çš„å‹å…ƒ
};
template <typename T>
Blob<T>::Blob() {}
```
* æˆå‘˜å‡½æ•°æŒ‰éœ€å®ä¾‹åŒ–
* é™æ€æˆå‘˜å±äºæ¨¡æ¿å®ä¾‹
* `unique_ptr`çš„ç±»æ¨¡æ¿åŒ…æ‹¬deleterç±»å‹ï¼Œæ— è¿è¡Œæ—¶å¼€é”€ï¼›`shared_ptr`çš„deleterè¿è¡Œæ—¶éœ€è¦é—´æ¥è®¿é—®
### æ¨¡æ¿ç±»å‹åˆ«å
```c++
template <typename T> using twin = pair<T, T>;
twin<string> name; // pair<string, string>
template <typename T> using score = pair<T, unsigned>;
score<twin<string>> midterm; // pair<twin<string>, unsigned>
```
### æ¨¡æ¿å‚æ•°
* æ¨¡æ¿å‚æ•°ä¸èƒ½åœ¨ä½œç”¨åŸŸå†…é‡å®šä¹‰
* `å«æ¨¡æ¿çš„ç±»å‹::æˆå‘˜`ä¸­æˆå‘˜å¯èƒ½æ˜¯é™æ€æˆå‘˜æˆ–ç±»å‹æˆå‘˜ï¼Œå‰ç½®`typename`è¡¨ç¤ºç±»å‹æˆå‘˜
```c++
template <typename T, typename F = less<T>>
int compare(const T &a, const T &b, F f = F()) {
    if(f(a, b)) return -1;
    if(f(b, a)) return 1;
    return 0;
}

template <typename T = int>
struct A {};
A<> a; // A<int>
```
### æˆå‘˜æ¨¡æ¿å‡½æ•°
```c++
template <typename T>
struct A {
    template <typename U>
    void f(U);
};
template <typename T>
template <typename U>
void A<T>::f(U) {}
```
* ä¸èƒ½ä¸ºè™šå‡½æ•°
* åœ¨æ¨¡æ¿ç±»å¤–å®šä¹‰æˆå‘˜æ¨¡æ¿å‡½æ•°ï¼Œè¦åŒæ—¶æä¾›ç±»æ¨¡æ¿å’Œå‡½æ•°æ¨¡æ¿
### æ¨¡æ¿å®ä¾‹åŒ–
```c++
// A.h
template <typename T>
struct A {};
template <typename T>
void f(T) {}
// a.cpp
#include "A.h"
template class A<int>; // å®ä¾‹åŒ–å®šä¹‰ï¼Œæ°å¥½å‡ºç°ä¸€æ¬¡
template void f(int);
// main.cpp
#include "A.h"
extern template class A<int>; // å®ä¾‹åŒ–å£°æ˜ï¼Œä¸ç”Ÿæˆæ¨¡æ¿å®ä¾‹åŒ–ä»£ç 
extern template void f(int);
```
* è§£å†³ä¸åŒç¼–è¯‘å•å…ƒå¯¹åŒä¸€æ¨¡æ¿åŒæ ·å‚æ•°å®ä¾‹åŒ–ï¼Œæµªè´¹æ—¶é—´ç©ºé—´çš„é—®é¢˜
* ç±»æ¨¡æ¿çš„å®ä¾‹åŒ–å®šä¹‰ä¼šå®ä¾‹åŒ–æ‰€æœ‰æˆå‘˜ï¼ˆæ­¤å¤„å­˜ç–‘ï¼Œæˆå‘˜æ¨¡æ¿å‡½æ•°ä¸å®ä¾‹åŒ–ï¼‰ï¼Œå› æ­¤åªé€‚ç”¨å¯ä½¿ç”¨æ‰€æœ‰æˆå‘˜å‡½æ•°çš„ç±»
### æ¨¡æ¿å‚æ•°æ¨æ–­
* å¿½ç•¥é¡¶å±‚`const`
* ä»…æœ‰çš„è½¬æ¢ä¸ºéåº•å±‚`const`ä¼ é€’ç»™åº•å±‚`const`ï¼Œå½“å‚æ•°ä¸æ˜¯å¼•ç”¨æ—¶æ•°ç»„ã€å‡½æ•°è½¬æ¢ä¸ºç›¸åº”æŒ‡é’ˆ
* åŒä¸€æ¨¡æ¿å‚æ•°åœ¨ä¸åŒä½ç½®æ¨æ–­ä¸ºä¸åŒç±»å‹æ—¶æŠ¥é”™
* å‡½æ•°ååå¯æ˜¾å¼æŒ‡å®šå‰å‡ ä¸ªæ¨¡æ¿å‚æ•°ç±»å‹ï¼Œç”±æ­¤ç¡®å®šç±»å‹çš„å‚æ•°é€‚ç”¨æ™®é€šçš„è½¬æ¢è§„åˆ™
* ä»…ç”¨äºè¿”å›å€¼çš„æ¨¡æ¿ç±»å‹ä¸å¯æ¨æ–­ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®š
* å¯ç”¨åç½®è¿”å›ç±»å‹å’Œ`decltype`ä»å‡½æ•°å‚æ•°æ¨æ–­è¿”å›ç±»å‹
```c++
template <typename T>
void f(T) {}
void (*fp)(int) = f; // f<int>
void g(void (*fp)(int)) {}
void g(void (*fp)(double)) {}
// g(f); // é”™è¯¯ï¼Œå¤šä¸ªåŒ¹é…
```
### ç±»å‹è½¬æ¢æ¨¡æ¿
Mod|T|Mod&lt;T>::type
-|-|-
remove_reference|X&ï¼ŒX&&ï¼Œå…¶ä»–|Xï¼ŒXï¼ŒT
add_lvalue_reference|X&ï¼ŒX&&ï¼Œå…¶ä»–|Tï¼ŒX&ï¼ŒT&|
add_rvalue_reference|X&ã€X&&ï¼Œå…¶ä»–|Tï¼ŒT&&
remove_const|const Xï¼Œå…¶ä»–|Xï¼ŒT
add_const|X&ã€const Xã€å‡½æ•°ï¼Œå…¶ä»–|Tï¼Œconst T
remove_pointer|X*ï¼Œå…¶ä»–|Xï¼ŒT
add_pointer|X&ã€X&&ï¼Œå…¶ä»–|X*ï¼ŒT*
make_signed|unsigend Xï¼Œå…¶ä»–|Xï¼ŒT
make_unsigend|signedç±»å‹ï¼Œå…¶ä»–|unsigned Tï¼ŒT
remove_extent|X\[n]ï¼Œå…¶ä»–|Xï¼ŒT
remove_all_extent|X\[n1]\[n2]...ï¼Œå…¶ä»–|Xï¼ŒT
### æ¨¡æ¿å‚æ•°å¼•ç”¨
* `T&`åªæ¥å—å·¦å€¼ï¼Œå½“å‚æ•°ä¸º`const`æ—¶`T`ä¹Ÿä¸º`const`
* `const T&`æ¥å—å·¦å€¼å’Œå³å€¼ï¼Œå½“å‚æ•°ä¸º`const`æ—¶`T`ä¸ä¸º`const`
* `T&&`æ¥å—å·¦å€¼å’Œå³å€¼ï¼Œæ¥å—å·¦å€¼æ—¶`T`ä¸ºå·¦å€¼å¼•ç”¨
* é—´æ¥ä½¿ç”¨å¼•ç”¨çš„å¼•ç”¨æ—¶ï¼Œå¼•ç”¨æŠ˜å ï¼š`X& &`ã€`X& &&`ã€`X&& &`ç­‰ä»·äº`X&`ï¼Œ`X&& &&`ç­‰ä»·äº`X&&`
* `T&&`ä¸€èˆ¬ç”¨äºè½¬å‘æˆ–é‡è½½ï¼Œå½“å’Œ`const T&`å¹¶å­˜æ—¶ï¼Œå‰è€…æ¥å—é`const`å³å€¼ï¼Œåè€…æ¥å—å·¦å€¼å’Œ`const`å³å€¼
### move
```c++
template <typename T>
typename remove_reference<T>::type&& move(T &&t) {
    return static_cast<typename remove_reference<T>::type&&>(t);
}
```
-|move(string(""))|move(s)
-|-|-
T|string|string&
å‚æ•°ç±»å‹|string&&|string&
remove_reference&lt;T>::type|string|string
è¿”å›ç±»å‹|string&&|string&&
static_cast|æ— ä½œç”¨|å·¦å€¼è½¬å³å€¼
### è½¬å‘
* `T&&`å½¢å‚ä¿æŒå®å‚çš„å·¦å³å€¼å’Œ`const`å±æ€§
```c++
template <typename T>
T&& forward(typename remove_reference<T>::type &&t) {
    return static_cast<T&&>(t);
}
template <typename T>
T&& forward(typename remove_reference<T>::type &t) {
    return static_cast<T&&>(t);
}
template <typename T, typename U>
void use_forward(T &&t, U &&u) {
    pass_to_function(forward<T>(t), forward<U>(u));
}
```
-|use_forward(string(""))|use_forward(s)
-|-|-
T|string|string&
å‚æ•°ç±»å‹|string&&|string&
static_castã€è¿”å›ç±»å‹|string&&|string&
* å®Œç¾è½¬å‘å°†æ¨¡æ¿å‡½æ•°çš„`T&&`å½¢å‚æŒ‰å®å‚å±æ€§ä¼ é€’ç»™å…¶ä»–ï¼ˆæŒ‰å±æ€§é‡è½½çš„ï¼‰å‡½æ•°
### é‡è½½
* æ¨æ–­æˆåŠŸçš„æ¨¡æ¿å‡½æ•°éƒ½æ˜¯å€™é€‰å‡½æ•°ã€å¯è¡Œå‡½æ•°
* è‹¥å¯è¡Œå‡½æ•°æ— å”¯ä¸€æœ€ä½³åŒ¹é…ï¼Œåœ¨ä¸¤ç§æƒ…å†µä¸‹ä¸æŠ¥é”™ï¼šæœ‰å”¯ä¸€éæ¨¡æ¿å‡½æ•°ï¼›æ²¡æœ‰éæ¨¡æ¿å‡½æ•°ï¼Œä½†æœ‰ä¸€ä¸ªæ¨¡æ¿å‡½æ•°æ¯”å…¶ä»–æ›´ç‰¹åŒ–
```c++
template <typename T>
void f(const T&) {}
template <typename T>
void f(const T*) {}
const string s;
f(&s); // const T*
```
### å˜é•¿æ¨¡æ¿
```c++
template <typename... Args> // Argsæ¨¡æ¿å‚æ•°åŒ…ï¼Œ...è¡¨ç¤º0æˆ–å¤šä¸ªæ¨¡æ¿å‚æ•°
void f(const Args &... rest) { // restå‡½æ•°å‚æ•°åŒ…
    cout << sizeof...(Args) << sizeof...(rest); // constexpr
}
f();
f(1.0, 2, string("")); // f(const double&, const int&, const string&)

template <typename T>
ostream& print(ostream &os, const T &t) {
    return os << t;
}
template <typename T, typename... Args>
ostream& print(ostream &os, const T &t, const Args &... rest) { // å±•å¼€Args
    os << t << ", ";
    return print(os, rest...); // å±•å¼€rest
}

template <typename T, typename... Args>
shared_ptr<T> make_shared(Args &&... args) {
    return shared_ptr<T>(new T(forward<Args>(args)...)); // å±•å¼€Argså’Œargs
}
```
### æ¨¡æ¿ç‰¹åŒ–
```c++
template <typename T>
void f(const T&) {}
template <>
void f(char *const &) {}
```
* ç‰¹åŒ–æ˜¯ä¸€ç§è¦†ç›–é»˜è®¤å®ç°çš„å®ä¾‹åŒ–è€Œéé‡è½½ï¼Œå› æ­¤ä¸å½±å“å‡½æ•°åŒ¹é…
```c++
class A {
    int i;
    string s;
    friend class std::hash<A>;
public:
    A(int i, string s) : i(i), s(s) {}
    bool operator==(const A &a) const {
        return i == a.i && s == a.s;
    }
};
namespace std { // å¿…é¡»ä¸æ¨¡æ¿åœ¨åŒä¸€å‘½åç©ºé—´
    template <>
    struct hash<A> {
        typedef size_t result_type; // å¿…é¡»å®šä¹‰çš„ç±»å‹
        typedef A argument_type;
        size_t operator()(const A &a) const { // ==çš„å¯¹è±¡hashå€¼å¿…é¡»ç›¸åŒ
            return hash<int>()(a.i) ^ hash<string>()(a.s);
        }
    };
}
```
### æ¨¡æ¿åç‰¹åŒ–
```c++
template <typename T>
struct remove_reference {
    typedef T type;
};
template <typename T>
struct remove_reference<T&> {
    typedef T type;
}
template <typename T>
struct remove_reference<T&&> {
    typedef T type;
}
```
* åªæœ‰ç±»æ¨¡æ¿å¯ä»¥åç‰¹åŒ–
```c++
template <typename T>
struct A {
    void f() {}
    void g() {}
};
template <>
void A<int>::f() {} // åç‰¹åŒ–å¯ä»¥åªé’ˆå¯¹éƒ¨åˆ†æˆå‘˜
```
## 17
### tuple
```c++
#include <tuple>
tuple<T1, ..., Tn> t; // å€¼åˆå§‹åŒ–
tuple<T1, ..., Tn> t(v1, ..., vn); // explicit
make_tuple(v1, ..., vn) // æ ¹æ®å‚æ•°æ¨æ–­ç±»å‹
==, != // å¯¹åº”å…ƒç´ ç›¸ç­‰ï¼ˆå¿…é¡»é•¿åº¦ç›¸åŒï¼Œä¸‹åŒï¼‰
<, <=, >, >= // å­—å…¸åº
get<i>(t) // tç¬¬iä¸ªæˆå‘˜çš„å¼•ç”¨ï¼Œå·¦å³å€¼å–å†³äºtçš„å·¦å³å€¼
tuple_size<å…ƒç»„ç±»å‹>::value // å…ƒç»„é•¿åº¦ï¼Œconstexpr
tuple_element<i, å…ƒç»„ç±»å‹>::type // ç¬¬iä¸ªæˆå‘˜çš„ç±»å‹
```
### bitset
```c++
#include <bitset>
bitset<n> b; // nä½ï¼Œ0ï¼Œé»˜è®¤æ„é€ å‡½æ•°ä¸ºconstexpr
bitset<n> b(ull); // unsigned long longçš„ä½nä½ï¼Œn>8*sizeof(ull)åˆ™é«˜ä½ä¸º0
bitset<n> b(s[, i, len, zero, one]) // å­—ç¬¦ä¸²sä»ä¸‹æ ‡iå¼€å§‹ï¼ˆé•¿lençš„ï¼‰å­ä¸²ï¼Œs[i]ä¸ºbçš„æœ€é«˜ä½ï¼Œzeroå’Œoneä¸ºè¡¨ç¤º0/1çš„å­—ç¬¦ï¼Œé‡åˆ°éæ³•å­—ç¬¦æŠ›å‡ºinvalid_argumentå¼‚å¸¸
bitset<n> b(ca[, n, zero, one]) // å­—ç¬¦æ•°ç»„caçš„å‰nä¸ªå­—ç¬¦
```
bitsetæ“ä½œ|æ„ä¹‰
-|-
b.any()|æ˜¯å¦æœ‰1
b.all()|æ˜¯å¦å…¨1
b.none()|æ˜¯å¦å…¨0
b.count()|1çš„ä¸ªæ•°
b.size()|ä½æ•°ï¼Œconstexpr
b.test(i)|iä½æ˜¯å¦ä¸º1
b.set(i, v = true)ã€b.set()|iä½è®¾ä¸ºv/è®¾ä¸ºå…¨1
b.reset(i)ã€b.reset()|iä½æ¸…0/å…¨éƒ¨æ¸…0
b.flip(i)ã€b.flip()|iä½å–å/å…¨éƒ¨å–å
b\[i]|ç¬¬iä½
b.to_ulong()ã€b.to_ullong|è½¬ä¸ºunsigned longæˆ–unsigned long longï¼Œæº¢å‡ºæŠ›å‡ºoverflow_errorå¼‚å¸¸
b.to_string(\[zero, one])|è½¬ä¸ºå­—ç¬¦ä¸²
os << b|è¾“å‡º01åºåˆ—
is >> b|è¾“å…¥01åºåˆ—ï¼Œé‡åˆ°é01å­—ç¬¦æˆ–è¾¾åˆ°b.size()ç»ˆæ­¢
* ä¸‹æ ‡å¯¹`const`é‡è½½ï¼Œé`const`æ—¶å¯å¯¹è¿”å›å€¼æ“ä½œï¼Œå¦‚`b[0].flip()`
* bitsetæ”¯æŒä½è¿ç®—ç¬¦ï¼Œæ•ˆæœåŒunsigned
### æ­£åˆ™è¡¨è¾¾å¼
```c++
#include <regex>
regex r(args, flag = regex::ECMAScript); // argsä¸ºstringæ„é€ å‡½æ•°çš„å‚æ•°
r.assign(args, flag)
r = arg // argä¸ºstringä¸€å…ƒæ„é€ å‡½æ•°çš„å‚æ•°
r.flags()
r.mark_count() // å­æ­£åˆ™è¡¨è¾¾å¼æ•°
```
flag|æ„ä¹‰
-|-
icase|å¿½ç•¥å¤§å°å†™
nosubs|ä¸å­˜å‚¨å­è¡¨è¾¾å¼åŒ¹é…
optimize|ä¼˜åŒ–æ‰§è¡Œé€Ÿåº¦è€Œéæ„é€ é€Ÿåº¦
ECMAScriptã€basicã€extendedã€awkã€grepã€egrep|æ­£åˆ™æ–¹è¨€
* regexè¿è¡Œæ—¶compileï¼Œåº”å°½é‡é¿å…åˆ›å»ºä¸å¿…è¦çš„regex
* è¯­æ³•é”™è¯¯æŠ›å‡ºregex_errorå¼‚å¸¸ï¼Œå…¶codeæˆå‘˜å‡½æ•°è¿”å›å®ç°ç›¸å…³çš„é”™è¯¯ç 
* wregexå¤„ç†wchar_tå’Œwstring
```c++
smatch match;
regex_match(sæˆ–cs[, match], r[, mft]) // è¿”å›æ˜¯å¦åŒ¹é…çš„boolï¼Œè‹¥æŒ‡å®šmatchåˆ™è®¾å…¶ä¸ºåŒ¹é…
regex_search(sæˆ–cs[, match], r[, mft]) // è¿”å›æ˜¯å¦æœ‰å­ä¸²åŒ¹é…çš„bool
regex_replace(sæˆ–cs, r, fmt, mft = regex_constants::match_default) // ä½¿ç”¨regex_searchæŒ‰fmtå…¨éƒ¨æ›¿æ¢ï¼Œè¿”å›æ›¿æ¢åçš„å­—ç¬¦ä¸²
regex_replace(dest, b, e, r, fmt[, mft]) // æ›¿æ¢ç»“æœå†™å…¥destæŒ‡å‘çš„ä½ç½®ï¼Œè¿”å›å°¾è¿­ä»£å™¨
sregex_iterator it(b, e, r); // forwardï¼Œè‡ªåŠ¨è°ƒç”¨regex_searchï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªsmatch
sregex_iterator end; // é»˜è®¤åˆå§‹åŒ–ä¸ºå°¾è¿­ä»£å™¨
```
smatchæ“ä½œ|æ„ä¹‰
-|-
m.ready()|æ˜¯å¦æœ‰æ•ˆï¼ˆè¢«regex_matchæˆ–regex_searchè®¾ç½®ï¼‰
m.size()|åŒ¹é…å¤±è´¥è¿”å›0ï¼Œå¦åˆ™è¿”å›å­æ­£åˆ™è¡¨è¾¾å¼æ•°+1
m.empty()|m.size()æ˜¯å¦ä¸º0
m.prefix()ã€m.suffix()|åŒ¹é…éƒ¨åˆ†ä¹‹å‰/ä¹‹åçš„ssub_match
m.format(dest, string fmt, mft = regex_constants::format_default)ã€m.format(dest, const char \*fmt_first, const char *fmt_last[, mft])|æ›¿æ¢ç»“æœå†™å…¥destæŒ‡å‘çš„ä½ç½®ï¼Œè¿”å›å°¾è¿­ä»£å™¨
m.format(fmt[, mft])|fmtä¸ºstringæˆ–Cå­—ç¬¦ä¸²ï¼Œè¿”å›æ›¿æ¢åçš„å­—ç¬¦ä¸²
m.length(n = 0)|åŒ¹é…å­è¡¨è¾¾å¼çš„å­ä¸²é•¿åº¦ï¼Œé»˜è®¤å®Œæ•´è¡¨è¾¾å¼ï¼Œä¸‹åŒ
m.position(n)|åŒ¹é…çš„å­ä¸²èµ·å§‹ä¸‹æ ‡
m.str(n = 0)|åŒ¹é…çš„å­ä¸²
m\[n]|ssub_match
m.begin()ã€m.end()ã€m.cbegin()ã€m.cend()|æŒ‡å‘ssub_matchçš„è¿­ä»£å™¨

ssub_matchæ“ä½œ|æ„ä¹‰
-|-
m.matched|æ˜¯å¦åŒ¹é…äº†å­ä¸²
m.firstã€m.second|å­ä¸²é¦–å°¾è¿­ä»£å™¨
m.length()|åŒ¹é…å­ä¸²é•¿åº¦ï¼ŒæœªåŒ¹é…ä¸º0
m.str()|åŒ¹é…çš„å­ä¸²
s = m|è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç­‰ä»·äºs=m.str()
* så¼€å¤´çš„ç±»å‹é€‚ç”¨äº`string`åŒ¹é…ï¼Œcå¼€å¤´çš„ç±»å‹é€‚ç”¨`const char*`åŒ¹é…

regex_constants::match_flag_type|æ„ä¹‰
-|-
match_default|ç­‰ä»·äºformat_default
match_not_bolã€match_not_bow|ä¸è§†ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºè¡Œé¦–/è¯é¦–
match_not_eolã€match_not_eow|ä¸è§†æœ€åä¸€ä¸ªå­—ç¬¦ä¸ºè¡Œå°¾/è¯å°¾
match_any|å¤šäºä¸€ä¸ªåŒ¹é…æ—¶å¯è¿”å›ä»»ä¸€åŒ¹é…
match_not_null|ä¸åŒ¹é…ç©ºä¸²
match_continuous|å¿…é¡»ä»ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹åŒ¹é…
match_prev_avail|ç¬¬ä¸€ä¸ªå­—ç¬¦å‰æœ‰å­—ç¬¦
format_default|ä½¿ç”¨ECMAScriptè§„åˆ™æ›¿æ¢
format_sed|ä½¿ç”¨sedè§„åˆ™æ›¿æ¢
format_no_copy|ä¸è¾“å‡ºæœªåŒ¹é…çš„éƒ¨åˆ†
format_first_only|åªæ›¿æ¢ä¸€æ¬¡
### éšæœºæ•°
```c++
default_random_engine e; // é»˜è®¤ç§å­
default_random_engine e(s); // æŒ‡å®šç§å­
e.seed(s) // é‡è®¾ç§å­
default_random_engine::result_type e() // éšæœºéè´Ÿæ•´æ•°
e.min() e.max() // æœ€å°/æœ€å¤§éšæœºæ•°
e.discard(ull) // å‰è¿›ullæ­¥
uniform_int_distribution<unsigned> d(0, 9); // åŒ…å«é¦–å°¾ï¼Œé»˜è®¤int
d(e)
d.min() d.max()
d.reset() // é‡è®¾çŠ¶æ€ï¼Œä½¿åç»­éšæœºæ•°ä¸å·²ç”Ÿæˆçš„æ— å…³
uniform_real_distribution<> u(0, 1); // é»˜è®¤double
normal_distribution<> n(0, 1); // æœŸæœ›ã€æ ‡å‡†å·®
bernoulli_distribution b(p = 0.5); // éæ¨¡æ¿ç±»ï¼Œç”Ÿæˆboolï¼Œå‚æ•°ä¸ºtrueæ¦‚ç‡
```
### æ ¼å¼æ§åˆ¶
æ§åˆ¶ç¬¦|æ„ä¹‰
-|-
boolalphaã€no*|ä»¥æ–‡å­—å½¢å¼è¾“å‡ºbool
showposã€no*|éè´Ÿæ•°å…ˆå¯¼+
hexã€octã€dec|æ•´æ•°è¿›åˆ¶
showbaseã€no*|å…«è¿›åˆ¶å…ˆå¯¼0å’Œåå…­è¿›åˆ¶å…ˆå¯¼0x
uppercaseã€no*|0Xã€ABCDEFã€1E+06
fixed|ä¸ä½¿ç”¨ç§‘å­¦æŠ€æœ¯æ³•ï¼Œå›ºå®šç²¾åº¦
scientific|ä½¿ç”¨ç§‘å­¦æŠ€æœ¯æ³•ï¼Œå›ºå®šç²¾åº¦
hexfloat|åå…­è¿›åˆ¶æµ®ç‚¹æ•°
defaultfloat|é»˜è®¤çš„ä¾æ®æ•°å€¼å¤§å°å†³å®šæ˜¯å¦ä½¿ç”¨ç§‘å­¦æŠ€æœ¯æ³•
showpointã€no*|æµ®ç‚¹æ•°æ€»æ˜¯è¾“å‡ºå°æ•°ç‚¹
left|å·¦å¯¹é½
right|å³å¯¹é½
internal|è´Ÿå·å±…å·¦ï¼Œæ•°å€¼å±…å³
skipwsã€no*|è·³è¿‡è¾“å…¥ç©ºç™½ç¬¦ï¼Œé»˜è®¤skipws
* æµ®ç‚¹æ•°ç²¾åº¦é»˜è®¤6
* `cout.precision(\[n])`ï¼šæ— å‚åˆ™è¿”å›å½“å‰ç²¾åº¦ï¼Œå«å‚åˆ™è®¾ç½®ç²¾åº¦å¹¶è¿”å›æ—§ç²¾åº¦

iomanipå®šä¹‰æ¥å—å‚æ•°çš„æ§åˆ¶ç¬¦|æ„ä¹‰
-|-
setprecision(n)|è®¾ç½®ç²¾åº¦
setw(n)|æ•°å€¼æˆ–å­—ç¬¦ä¸²æœ€å°å®½åº¦ï¼Œåªé€‚ç”¨ä¸‹ä¸€é¡¹
setfill(c)|å¡«å……å­—ç¬¦ï¼Œé»˜è®¤ç©ºæ ¼
setbase(b)|è®¾ç½®è¿›åˆ¶ï¼Œåªæ¥å—8ã€10ã€16
### æ— æ ¼å¼IO
å•å­—èŠ‚IO|æ„ä¹‰
-|-
is.get(c)|è¯»å–å•å­—èŠ‚ï¼Œè¿”å›is
os.put(c)|å†™å…¥å•å­—èŠ‚
is.get()|è¯»å–å•å­—èŠ‚ï¼Œè¿”å›int
is.putback(c)|æ”¾å›å•å­—èŠ‚ï¼ˆåº”ä¸ºä¸Šæ¬¡è¯»å–çš„å­—èŠ‚ï¼‰ï¼Œè¿”å›is
is.unget()|å›é€€å•å­—èŠ‚ï¼Œè¿”å›is
is.peek()|æŸ¥çœ‹å•å­—èŠ‚ï¼Œè¿”å›int
* ä¿è¯èƒ½æ”¾å›ä¸€ä¸ªå­—èŠ‚
* `cstdio`å¤´æ–‡ä»¶å®šä¹‰`EOF`ï¼Œå¯ä¸intè¿”å›å€¼æ¯”è¾ƒ

å¤šå­—èŠ‚IO|æ„ä¹‰
-|-
is.get(ca, n, c)|è¯»å–æœ€å¤šn-1ä¸ªå­—ç¬¦å­˜åˆ°caï¼Œç»“å°¾è¡¥'\0'ï¼Œé‡åˆ°cåˆ™è¿”å›
is.getline(ca, n, c)|åŒä¸Šï¼Œä½†é‡åˆ°cä¸¢å¼ƒå¹¶è¿”å›
is.read(ca, n)|è¯»å–æœ€å¤šnä¸ªå­—èŠ‚å­˜åˆ°ca
is.gcount()|ä¸Šä¸€æ¬¡æ— æ ¼å¼è¾“å…¥è¯»å–çš„å­—èŠ‚æ•°ï¼Œè‹¥æ˜¯putbackã€ungetæˆ–peekåˆ™è¿”å›0
os.write(ca, n)|å†™å…¥caä¸­çš„nä¸ªå­—èŠ‚
is.ignore(n = 1, c = EOF)|è¯»å–å¹¶ä¸¢å¼ƒæœ€å¤šnä¸ªå­—èŠ‚åŒ…æ‹¬c
### éšæœºè¯»å†™
æ“ä½œ|æ„ä¹‰
-|-
tellg()ã€tellp()|è¿”å›å½“å‰ä½ç½®ï¼Œç±»å‹ä¸ºpos_type
seekg(pos)ã€seekp(pos)|è·³è½¬åˆ°posï¼Œposä¸ºtellg/tellpçš„è¿”å›å€¼
seekp(off, from)|è·³è½¬åˆ°ç›¸å¯¹fromçš„ä½ç½®offï¼Œfromä¸ºbegã€curæˆ–endï¼Œoffç±»å‹ä¸ºoff_type
* ä¸Šè¿°ç±»å‹ã€å¯¹è±¡å‡ä¸ºæµçš„æˆå‘˜
* éšæœºè¯»å†™åº”åœ¨`fstream`å’Œ`sstream`ä½¿ç”¨
* gç‰ˆæœ¬é€‚ç”¨è¾“å…¥æµï¼Œpç‰ˆæœ¬é€‚ç”¨è¾“å‡ºæµï¼Œå¯¹è¾“å…¥è¾“å‡ºæµä¸åŒºåˆ†è¯»å†™ä½ç½®ï¼Œä¸¤ç‰ˆæœ¬ç­‰ä»·
## 18
### å¼‚å¸¸
* å¼‚å¸¸å‘ç”Ÿåçš„æ ˆå±•å¼€è¿‡ç¨‹ï¼Œç¼–è¯‘å™¨ä¿è¯é€€å‡ºçš„å—ä¸­çš„å¯¹è±¡æ­£å¸¸é”€æ¯ï¼›å³ä½¿å¼‚å¸¸å‘ç”Ÿåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œå½“å‰ï¼ˆä¸å®Œæ•´ï¼‰å¯¹è±¡ä¹Ÿå°†æ­£å¸¸é”€æ¯
* ææ„å‡½æ•°ä¸åº”æŠ›å‡ºå¼‚å¸¸ï¼Œäº§ç”Ÿçš„å¼‚å¸¸å¿…é¡»å¤„ç†ï¼›æ ˆå±•å¼€æ—¶è‹¥ææ„å‡½æ•°æŠ›å‡ºå¼‚å¸¸ï¼Œç¨‹åºç»ˆæ­¢
* å¼‚å¸¸å¯¹è±¡ç”±`throw`çš„è¡¨è¾¾å¼å¤åˆ¶åˆå§‹åŒ–ï¼Œè‹¥è¡¨è¾¾å¼ä¸ºç±»å¯¹è±¡åˆ™è¯¥ç±»å¿…é¡»æœ‰å¯è®¿é—®çš„ææ„å‡½æ•°å’Œå¤åˆ¶/ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œè‹¥è¡¨è¾¾å¼ä¸ºæ•°ç»„/å‡½æ•°åˆ™è‡ªåŠ¨è½¬ä¸ºæŒ‡é’ˆ
* å¼‚å¸¸å¯¹è±¡ä½¿ç”¨é™æ€ç±»å‹ï¼Œåœ¨å®Œå…¨å¤„ç†åé”€æ¯
* `catch`çš„å¼‚å¸¸å¯¹è±¡å¯ä»¥ä¸ºå·¦å€¼å¼•ç”¨ï¼Œä¸èƒ½ä¸ºå³å€¼å¼•ç”¨
* `catch`å—æˆ–å—å†…è°ƒç”¨çš„å‡½æ•°å¯ä»¥ä½¿ç”¨`throw;`é‡æŠ›å½“å‰å¼‚å¸¸ï¼Œä»…å½“å¼‚å¸¸ä¸ºå¼•ç”¨æ—¶å¯¹å…¶çš„ä¿®æ”¹æœ‰æ•ˆ
* `catch(...)`æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œåº”ä¸ºæœ€åä¸€ä¸ª`catch`ï¼Œç»å¸¸ä¸é‡æŠ›å…±åŒä½¿ç”¨
```c++
struct A {};
struct B {
    A a;
    B() try : a() {
        // æ„é€ å‡½æ•°ä½“
    } catch(exception &e) {}
};
```
* `noexcept`ä½äº`const`ã€`&`åï¼Œåç½®è¿”å›å€¼ã€`final`ã€`override`ã€`=0`å‰
* `noexcept`çš„å‡½æ•°å¦‚æœæŠ›å‡ºå¼‚å¸¸ï¼Œç›´æ¥è°ƒç”¨`terminate`ï¼Œä¿è¯è°ƒç”¨è€…ä¸éœ€å¤„ç†å¼‚å¸¸
* `noexcept(true)`å£°æ˜ç­‰ä»·äº`noexcept`ï¼Œ`noexcept(false)`å£°æ˜ç­‰ä»·äºæ— `noexcept`
* `noexcept`è¿ç®—ç¬¦ï¼š`noexcept(è¡¨è¾¾å¼)`ï¼Œè¡¨è¾¾å¼æ˜¯å¦`noexcept`ï¼Œè¿”å›`constexpr bool`å³å€¼ï¼Œä¸æ±‚å€¼è¡¨è¾¾å¼
* `noexcept`çš„å‡½æ•°æŒ‡é’ˆåªèƒ½æŒ‡å‘`noexcept`çš„å‡½æ•°ï¼Œé`noexcept`çš„å‡½æ•°æŒ‡é’ˆå¯ä»¥æŒ‡å‘`noexcept`çš„å‡½æ•°
* åŸºç±»çš„è™šå‡½æ•°`noexcept`åˆ™æ´¾ç”Ÿç±»çš„é‡å†™å¿…é¡»`noexcept`
* ç¼–è¯‘å™¨è‡ªåŠ¨å£°æ˜åˆæˆå‡½æ•°ã€è‡ªå®šä¹‰çš„ææ„å‡½æ•°æ˜¯å¦ä¸º`noexcept`
* å¼‚å¸¸ç±»å®šä¹‰äº†å¤åˆ¶æ„é€ å‡½æ•°ã€å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ã€è™šå‡½æ•°`what`ã€è™šææ„å‡½æ•°
### å‘½åç©ºé—´
* å¯ä»¥åˆ†å—å®šä¹‰
* å‘½åç©ºé—´å†…å®šä¹‰çš„æ¨¡æ¿ï¼Œè‹¥è¦åœ¨å‘½åç©ºé—´å¤–ç‰¹åŒ–ï¼Œç‰¹åŒ–å¿…é¡»åœ¨å‘½åç©ºé—´å†…å£°æ˜
```c++
inline namespace name {} // inlineå¿…é¡»å‡ºç°åœ¨ç¬¬ä¸€æ¬¡å®šä¹‰
namespace name { // è‡ªåŠ¨inline
    int i;
}
void f() {
    i = 0; // name::i
}
```
* æ¯ä¸ªæ–‡ä»¶å¯ä»¥å®šä¹‰è‡ªå·±çš„åŒ¿åå‘½åç©ºé—´ï¼Œæ•ˆæœç­‰åŒäºï¼ˆè¿‡æ—¶çš„ï¼‰`static`æ–‡ä»¶ä½œç”¨åŸŸ
* ä¸åŒæ–‡ä»¶åŒ…å«åŒä¸€å¤´æ–‡ä»¶ï¼Œå…¶åŒ¿åå‘½åç©ºé—´å†…çš„åç§°åœ¨è¿™äº›æ–‡ä»¶ä¸­åˆ†åˆ«ä¸ºç‹¬ç«‹çš„å®ä½“
* `namespace åˆ«å = å‘½åç©ºé—´;`
```c++
namespace name {
    int i = 0, j = 0, k = 0;
}
int i = 1;
void f() {
    using namespace name;
    // ++i; // é”™è¯¯ï¼š::iå’Œname::iå†²çª
    int j = name::i + ::i; // å±è”½name::j
    using name::k;
    // int k; // é”™è¯¯ï¼škå·²åœ¨å½“å‰ä½œç”¨åŸŸ
}
```
* `using`å£°æ˜åœ¨å£°æ˜æ—¶æ£€æµ‹å†²çªï¼Œ`using`æŒ‡ä»¤åœ¨ä½¿ç”¨åç§°æ—¶æ£€æµ‹å†²çª
```c++
operator<<(std::cout, std::string()); // ä¼ é€’ç±»å¯¹è±¡ï¼ˆå¼•ç”¨/æŒ‡é’ˆï¼‰å‚æ•°æ—¶ï¼Œè¿˜ä¼šæœç´¢ç±»åŠå…¶åŸºç±»æ‰€åœ¨çš„å‘½åç©ºé—´
```
* `using`æ‰©å……å½“å‰ä½œç”¨åŸŸçš„é‡è½½å‡½æ•°ï¼Œå±è”½å¤–éƒ¨ä½œç”¨åŸŸçš„é‡è½½å‡½æ•°
### å¤šç»§æ‰¿
* æ´¾ç”Ÿç±»æ‹¥æœ‰æ¯ä¸ªåŸºç±»çš„å­å¯¹è±¡ï¼ŒæŒ‡é’ˆèµ‹å€¼æ—¶åœ°å€è‡ªåŠ¨æ”¹å˜
* æ´¾ç”Ÿç±»æ„é€ å‡½æ•°è°ƒç”¨æ¯ä¸ªåŸºç±»çš„æ„é€ å‡½æ•°ï¼Œè°ƒç”¨é¡ºåºå–å†³äºåŸºç±»åœ¨æ´¾ç”Ÿåˆ—è¡¨å‡ºç°çš„é¡ºåº
* æ´¾ç”Ÿç±»ç»§æ‰¿å¤šä¸ªåŸºç±»çš„æ„é€ å‡½æ•°ï¼Œè‹¥å…¶ä¸­æœ‰ç›¸åŒå‚æ•°åˆ—è¡¨çš„å‡½æ•°ï¼Œæ´¾ç”Ÿç±»å¿…é¡»é‡å†™è¯¥å‡½æ•°
* ææ„å‡½æ•°è°ƒç”¨é¡ºåºä»ä¸æ„é€ å‡½æ•°ç›¸åï¼Œå¤åˆ¶æ§åˆ¶å‡½æ•°çš„åˆæˆä¹Ÿä¸å•ç»§æ‰¿ç›¸åŒ
* æ¯ä¸ªåŸºç±»åœ¨é‡è½½å‡½æ•°åŒ¹é…ä¸­ç­‰ä»·ï¼Œå¯å¼•èµ·å†²çª
* å¤šä¸ªåŸºç±»æœ‰åŒåæˆå‘˜æ—¶ï¼Œæ— è®ºï¼ˆè‹¥æ˜¯å‡½æ•°ï¼‰å‚æ•°åˆ—è¡¨æ˜¯å¦ç›¸åŒã€åŸºç±»æˆå‘˜æ˜¯å¦å¯è§ï¼Œæ´¾ç”Ÿç±»ä¸èƒ½è®¿é—®è¯¥æˆå‘˜ï¼Œé™¤éé‡å†™æˆ–æ˜¾å¼æŒ‡å®šåŸºç±»
### è™šç»§æ‰¿
* è±å½¢ç»§æ‰¿æ—¶ï¼Œæ´¾ç”Ÿç±»åŒ…å«å¤šä¸ªé—´æ¥åŸºç±»å­å¯¹è±¡ï¼Œè§£å†³æ–¹æ³•ï¼šç›´æ¥åŸºç±»è™šç»§æ‰¿è‡ªé—´æ¥åŸºç±»ï¼Œå…±äº«ä¸€ä¸ªåŸºç±»å¯¹è±¡
```c++
struct B {};
struct B1 : virtual B {};
struct B2 : virtual B {};
struct D : B1, B2 {
    D() : B(), B1(), B2() {}
};
```
* è™šåŸºç±»ç”±æœ€derivedç±»è´Ÿè´£æ„é€ ï¼Œå¦‚ä¸Šä¾‹æ„é€ Dæ—¶ä¾æ¬¡æ„é€ Bã€B1ã€B2ï¼ŒB1ã€B2çš„æ„é€ å‡½æ•°ä¸å†è°ƒç”¨Bçš„æ„é€ å‡½æ•°
* æ— è®ºç»§æ‰¿ç»“æ„å¦‚ä½•ï¼Œè™šåŸºç±»å…ˆäºï¼ˆè‡ªå·±çš„åŸºç±»å¤–çš„ï¼‰éè™šåŸºç±»æ„é€ ï¼›åˆæˆå¤åˆ¶ã€ç§»åŠ¨å‡½æ•°çš„å¤„ç†é¡ºåºä¸æ„é€ ç›¸åŒï¼Œææ„ç›¸å
