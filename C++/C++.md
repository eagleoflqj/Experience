# C++ Primer
## 1
* é»˜è®¤`cerr`å’Œ`clog`å®šå‘è‡³æ ‡å‡†é”™è¯¯ï¼›`cerr`ä¸ç¼“å†²ï¼Œ`clog`ç¼“å†²
* `endl`æ¢è¡Œå¹¶åˆ·æ–°ç¼“å†²åŒºï¼Œä¿è¯ç¨‹åºå´©æºƒæ—¶ä¸ä¸¢å¤±è¾“å‡º
* æ ‡å‡†åº“å®šä¹‰çš„åç§°å…¨éƒ¨ä½äº`std`å‘½åç©ºé—´
* `if(cin >> value)`æ£€æµ‹æµçŠ¶æ€ï¼Œå½“é‡åˆ°EOFæˆ–éæ³•è¾“å…¥æ—¶æ¡ä»¶ä¸ºå‡
* æ— åˆå€¼å®ä¾‹åˆå§‹åŒ–ç”±ç±»å†³å®šï¼Œæ— åˆå€¼å±€éƒ¨è‡ªåŠ¨å†…ç½®ç±»å‹å˜é‡åˆå€¼æœªå®šä¹‰
## 2
### å†…ç½®ç±»å‹
* `wchar_t`è‡³å°‘2å­—èŠ‚ï¼Œä¿è¯èƒ½è¦†ç›–æœºå™¨çš„æœ€å¤§å­—ç¬¦é›†ï¼ˆUnicode 4å­—èŠ‚ï¼‰ï¼Œliteralå‰ç¼€`L`
* `char16_t`ã€`char32_t`å­˜å‚¨Unicodeå­—èŠ‚ï¼Œliteralå‰ç¼€ä¸º`u`ã€`U`
* `long double`ä¸€èˆ¬ç”¨äºä¸“ç”¨æµ®ç‚¹ç¡¬ä»¶
* å¯¹`bool`èµ‹éé›¶å€¼ç»“æœä¸º`true`
* å¯¹æ— ç¬¦å·ç±»å‹è¶…èŒƒå›´èµ‹å€¼å¯¼è‡´å–æ¨¡ï¼Œå¯¹æœ‰ç¬¦å·ç±»å‹è¶…èŒƒå›´èµ‹å€¼ç»“æœæœªå®šä¹‰
* decimal literalç±»å‹ä¸º`int`ã€`long`ã€`long long`ä¸­æœ€å°èƒ½å®¹çº³å…¶å€¼çš„ï¼Œoctalã€hex literalç±»å‹ä¸º`int`ã€`unsigned`ã€`long`ã€`unsigned long`ã€`long long`ã€`unsigned long long`ä¸­æœ€å°èƒ½å®¹çº³å…¶å€¼çš„
* string literalçš„ç±»å‹ä¸º`const char []`

ğŸ˜€ï¼ˆU+1F600ï¼‰çš„å‰ç¼€|å¯èƒ½çš„å­—ç¬¦sizeof|å¯èƒ½çš„å­—ç¬¦ä¸²sizeof
-|-|-
æ— |æº¢å‡º|5
u8|éæ³•|5
L|4|8
u|æº¢å‡º|6
U|4|8
### åˆ—è¡¨åˆå§‹åŒ–
```cpp
int a = 0;
int a(0);
int a = {0};
int a{0};
```
* åä¸¤ç§æ–¹å¼ï¼Œè‹¥åˆå€¼è½¬æ¢ä¸ºç±»å‹å¯èƒ½ä¸¢å¤±ç²¾åº¦ï¼Œç¼–è¯‘å™¨å°†æŠ¥é”™
### å…¨å±€å˜é‡
* å…¨å±€`int a;`ä¸ºå®šä¹‰ï¼Œå£°æ˜å¿…é¡»åŠ `extern`
* ä¸ºé¿å…ä¸æ ‡å‡†åº“çš„åç§°å†²çªï¼Œæ ‡è¯†ç¬¦ä¸åº”åŒ…å«ä¸¤ä¸ªè¿ç»­çš„`_`ï¼Œä¸åº”ä»¥`_`+å¤§å†™å­—æ¯å¼€å¤´ï¼Œå…¨å±€å˜é‡ä¸åº”ä»¥`_`å¼€å¤´
* `::å˜é‡`å–åŒåå…¨å±€å˜é‡
* å…¨å±€`const`é»˜è®¤æ–‡ä»¶ä½œç”¨åŸŸï¼Œ`extern const`å®šä¹‰å…¨å±€ä½œç”¨åŸŸ
* å¯ä»¥è°ƒç”¨å‡½æ•°åˆå§‹åŒ–å…¨å±€å˜é‡ï¼Œä½†è‹¥å‡½æ•°æœ‰çŠ¶æ€ï¼Œä¸åŒç¼–è¯‘å•å…ƒå†…çš„å…¨å±€å˜é‡å€¼ä¸ç¡®å®šï¼ˆåˆå§‹åŒ–é¡ºåºä¸ç¡®å®šï¼‰
### å¼•ç”¨å’ŒæŒ‡é’ˆ
* `int &ref = var;`å¼•ç”¨ä¸å¯æ›´æ”¹ç»‘å®šï¼Œå¿…é¡»è¢«åˆå§‹åŒ–
* å¼•ç”¨ä¸æ˜¯å¯¹è±¡ï¼Œåªæ˜¯å¦ä¸€ä¸ªå˜é‡çš„åˆ«åï¼Œæ‰€ä»¥ä¸èƒ½å®šä¹‰å¼•ç”¨çš„å¼•ç”¨ã€å¼•ç”¨çš„æŒ‡é’ˆ
* æŒ‡é’ˆå€¼å¯ä¸ºå˜é‡åœ°å€ã€å˜é‡åçš„ä½ç½®ã€`nullptr`ã€æ— æ•ˆå€¼ï¼Œåä¸‰è€…æ—¶è§£å¼•ç”¨ç»“æœæœªå®šä¹‰
### const
* é`const &`åªèƒ½ç»‘å®šåŒ¹é…ç±»å‹çš„å˜é‡
* `const &`å¯ä»¥ç»‘å®šåˆ°ä»»ä½•èƒ½è½¬æ¢æˆå¯¹åº”ç±»å‹çš„è¡¨è¾¾å¼ï¼Œæ­¤æ—¶ç»‘å®šçš„æ˜¯ä¸€ä¸ªä¸´æ—¶å¯¹è±¡
* `const &`å¯ä»¥ç»‘å®šåˆ°å¯¹åº”ç±»å‹çš„æ™®é€šå˜é‡ï¼Œæ­¤æ—¶å¯¹å˜é‡çš„ä¿®æ”¹å¯ä»¥ååº”åˆ°å¼•ç”¨ä¸Š
* é¡¶å±‚`const`ï¼šä¸å¯ä¿®æ”¹å†…å­˜å€¼ï¼›åº•å±‚`const`ï¼šä¸å¯ä¿®æ”¹æŒ‡å‘çš„å†…å­˜å€¼
* `l = r`å¯¹è±¡å¤åˆ¶æ—¶`r`çš„é¡¶å±‚`const`å±æ€§è¢«å¿½ç•¥ï¼Œåº•å±‚`const`å±æ€§ä¸å¯å¿½ç•¥
### constexpr
* å¸¸é‡è¡¨è¾¾å¼ï¼š`const`ä¸”ç¼–è¯‘æœŸå€¼ç¡®å®š
* `constexpr int a = å¸¸é‡è¡¨è¾¾å¼`ï¼Œ`a`å¯ç”¨äºéœ€è¦å¸¸é‡è¡¨è¾¾å¼çš„åœ°æ–¹ï¼Œ`constexpr`å¯¼è‡´é¡¶å±‚`const`
* å¸¸é‡è¡¨è¾¾å¼å¿…é¡»ä¸ºå­—é¢ç±»å‹ï¼šå¯ä»¥æ˜¯ç®—æœ¯ç±»å‹ã€æŒ‡é’ˆã€å¼•ç”¨ã€å­—é¢ç±»ï¼Œä½†æŒ‡é’ˆ/å¼•ç”¨å¿…é¡»æŒ‡å‘/ç»‘å®šåˆ°å›ºå®šåœ°å€
### åˆ«å
```c++
typedef int i_t, *p_t; // å®šä¹‰äº†intå’Œint*çš„åˆ«å
const p_t p; // int *const p;
const p_t *pp; // int *const *pp;
using integer = int;
```
### auto
* `auto [ä¿®é¥°ç¬¦1]å˜é‡1 = åˆå€¼1[, ...];`
* åˆå€¼åº”å…·æœ‰ç›¸åŒåŸºæœ¬ç±»å‹
* `auto`ä¸€èˆ¬å¿½ç•¥åˆå€¼çš„å¼•ç”¨ç±»å‹å’Œé¡¶å±‚`const`å±æ€§
* `auto &`ä¿ç•™åˆå€¼çš„é¡¶å±‚`const`å±æ€§
* `const auto`å£°æ˜é¡¶å±‚`const`
```c++
const int ci = 0;
auto &r1 = ci; // const int &r1 = ci;
// auto &r2 = 0; // é”™è¯¯ï¼š0æ¨æ–­ä¸ºintï¼Œä½†int&ä¸å¯ç»‘å®šå¸¸é‡ï¼Œéœ€è¦const auto &r2 = 0;
```
### decltype
* `decltype(è¡¨è¾¾å¼) [ä¿®é¥°ç¬¦1]å˜é‡1[ = åˆå€¼1][, ...];`æ¨æ–­ç±»å‹ä½†ä¸æ±‚å€¼
* `decltype(å˜é‡)`ä¿ç•™å˜é‡çš„å¼•ç”¨ç±»å‹å’Œé¡¶å±‚`const`ï¼Œè¿™æ˜¯ä½¿ç”¨å¼•ç”¨ä¸ä½œä¸ºå˜é‡åˆ«åçš„å”¯ä¸€åœºæ™¯
* `decltype(éå˜é‡çš„è¡¨è¾¾å¼)`è‹¥ä¸ºå·¦å€¼åˆ™ä¸ºå¼•ç”¨ç±»å‹
```c++
const int a = 0, &r = a, *p = &a;
decltype(a) b = 0; // const int b = 0;
decltype(r) c = a; // const int &c = a;
decltype((a)) d = a; // const int &d = a;
decltype(*p) e = a; // const int &e = a;
```
* `=`èµ‹å€¼è¡¨è¾¾å¼è¿”å›å·¦å€¼
### struct
* ç±»å†…åˆå§‹åŒ–å¯ä»¥ä½¿ç”¨`=`æˆ–`{}`ï¼Œä¸å¯ä½¿ç”¨`()`
## 3
### using
* `using std::cin;`
* å¤´æ–‡ä»¶ä¸åº”åŒ…å«`using`
### stringæ„é€ 
```c++
#include <string>
string s1; // ""
string s2(s1); // å¤åˆ¶s1
string s2 = s1; // ç­‰ä»·
string s3("a"); // å¤åˆ¶å­—ç¬¦ä¸²å¸¸é‡
string s3 = "a"; // ç­‰ä»·
string s4(3, 'a'); // "aaa"
string s4 = string(3, 'a'); // ç­‰ä»·
```
### stringæ“ä½œ
```c++
os << s
is >> s // éç©ºç™½å­—ç¬¦ä¸²
getline(is, s) // ä¸ä¿å­˜'\n'ï¼Œè¿”å›is
s.empty()
string::size_type s.size() // å­—èŠ‚æ•°
s[n] // n >= 0 && n < s.size()ï¼Œå¦åˆ™ç»“æœæœªå®šä¹‰
s1 + s2
s1 = s2 // æ·±æ‹·è´
s1 == s2
!=, <, <=, >, >=
```
* ä½¿ç”¨`cname`ç‰ˆæœ¬çš„Cåº“ï¼ˆå‡½æ•°ä½äº`std`ï¼‰ï¼Œè€Œä¸æ˜¯`name.h`
```c++
for (auto c : s) // å¤åˆ¶
for (auto &c : s) // å¯ä¿®æ”¹
for (decltype(s.size()) i = 0; i != s.size(); ++i)
```
### vectoræ„é€ 
```c++
#include <vector>
vector<vector<string>> vv;
vector<int> v1; // ç©ºå‘é‡
vector<int> v2(v1);
vector<int> v2 = v1; // ç­‰ä»·
vector<int> v3 = {3, 1};
vector<int> v3{3, 1}; // ç­‰ä»·
vector<int> v4(3, 1); // {1, 1, 1}ï¼›æ„é€ åˆå§‹åŒ–
vector<int> v5(2); // {0, 0}ï¼›å€¼åˆå§‹åŒ–
vector<int> v6{2}; // {2}ï¼›å°è¯•è§£é‡Šä¸ºåˆ—è¡¨åˆå§‹åŒ–
vector<string> v7{2, "1"}; // {"1", "1"}ï¼›æ— æ³•è§£é‡Šä¸ºåˆ—è¡¨åˆå§‹åŒ–ï¼Œå°è¯•è§£é‡Šä¸ºæ„é€ åˆå§‹åŒ–
vector<string> v7 = {2, "1"}; // ç­‰ä»·
```
* å€¼åˆå§‹åŒ–ï¼šç±»å¯¹è±¡è‹¥æœ‰åˆæˆé»˜è®¤æ„é€ å‡½æ•°åˆ™é›¶åˆå§‹åŒ–åé»˜è®¤åˆå§‹åŒ–ï¼Œå¦åˆ™é»˜è®¤åˆå§‹åŒ–ï¼›æ•°ç»„å¯¹è±¡çš„æ¯ä¸ªå…ƒç´ å€¼åˆå§‹åŒ–ï¼›å…¶ä»–å¯¹è±¡é›¶åˆå§‹åŒ–
### vectoræ“ä½œ
```c++
v1.push_back(1);
v.empty()
vector<int>::size_type v1.size()
v[n]
v1 = v2 // æ·±æ‹·è´
v = {1, 2} // ç”¨å…ƒç´ çš„å‰¯æœ¬é‡å»ºå‘é‡
v1 == v2 // é•¿åº¦ç›¸åŒï¼Œå¯¹åº”å…ƒç´ ç›¸ç­‰ï¼ˆéœ€è¦å…ƒç´ ç±»å‹æ”¯æŒæ¯”è¾ƒï¼Œä¸‹åŒï¼‰
v1 != v2
<, <=, >, >= // å­—å…¸åº
```
* ä¸ºäº†æ•ˆç‡ä¸åº”æŒ‡å®šå‘é‡åˆå§‹å¤§å°ï¼Œé™¤éæ‰€æœ‰å…ƒç´ å€¼ç›¸åŒ
* å¯¹å‘é‡èŒƒå›´foræ—¶ä¸å¯å¢åˆ å…ƒç´ 
### è¿­ä»£å™¨
* åˆæ³•è¿­ä»£å™¨æŒ‡å‘å…ƒç´ æˆ–å…¶åçš„ä½ç½®
* ä½¿ç”¨è¿­ä»£å™¨æ—¶ä¸å¯å¢åˆ å…ƒç´ 
```c++
auto b = v.begin(), e = v.end(); // b == eç­‰ä»·äºvç©º
*iter
iter->æˆå‘˜
++iter
--iter
iter1 == iter2
iter1 != iter2
```
### è¿­ä»£å™¨ç±»å‹
```c++
vector<int>::iterator it1;
vector<int>::const_iterator it2; // åªè¯»
vector<int> v;
const vector<int> cv;
auto it3 = v.cbegin(), it4 = cv.begin(); // vector<int>::const_iterator
```
### vectorå’Œstringçš„è¿­ä»£å™¨ç®—æœ¯
```c++
iter + n
iter - n
iter += n
iter -= n
?::difference_type iter1 - iter2 // æœ‰ç¬¦å·
<, <=, >, >=
```
### äºŒåˆ†æœç´¢
```c++
auto beg = v.begin(), end = v.end();
auto mid = beg + (end - beg) / 2;
while (mid != end && *mid != value) {
    if (*mid < value)
        beg = mid + 1;
    else
        end = mid;
    mid = beg + (end - beg) / 2;
}
```
### æ•°ç»„
* ä¸å¯ç”¨`auto`å£°æ˜
* é•¿åº¦å¿…é¡»ä¸ºæ­£çš„å¸¸é‡è¡¨è¾¾å¼
* é»˜è®¤åˆå§‹åŒ–ï¼šå†…ç½®ç±»å‹å˜é‡åˆå€¼æœªå®šä¹‰ï¼Œç±»å˜é‡è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°
* å±€éƒ¨éé™æ€æ•°ç»„ï¼Œæ— åˆå€¼åˆ™å…ƒç´ é»˜è®¤åˆå§‹åŒ–
```c++
int a[3] = {}; // {0, 0, 0}ï¼›å€¼åˆå§‹åŒ–
int (*pa)[3] = &a;
int (&ra)[3] = a;
auto b(a); // int *
decltype(a) c; // int[3]
int *beg = begin(a), *last = end(a);
ptrdiff_t diff = end - beg;
```
* `size_t`ã€`ptrdiff_t`ä½äº`cstddef`
* æ•°ç»„å¯ä»¥ä½¿ç”¨èŒƒå›´for
* å†…ç½®ç±»å‹`[]`å¯ä»¥æ¥å—è´Ÿä¸‹æ ‡ï¼Œåº“ç±»å‹`[]`åªæ¥å—éè´Ÿä¸‹æ ‡
### æ—§ä»£ç æ¥å£
```c++
string s;
char c_s[] = "hi";
s = c_s
s += c_s;
const char *p = s.c_str(); // å¯¹sçš„åç»­ä¿®æ”¹å¯èƒ½ä¼šä½¿pæ— æ•ˆ
strlen(p) == s.size(); // så†…éƒ¨æœ‰'\0'æ—¶ä¸ç­‰
```
* C++11ä¿è¯`string`è¿ç»­å­˜å‚¨ä¸”ä»¥'\0'ç»“å°¾
```c++
int a[] = {0, 1, 2, 3, 4};
vector<int> v(a + 1, a + 3); // {1, 2}
```
### é«˜ç»´æ•°ç»„
```c++
int a[3][2][1] = {{1}, {2}, {3}}; // {1, 0, 2, 0, 3, 0}
for (auto &row : a) // int (&row)[2][1]
for (auto row : a) // int (*row)[1]ï¼Œä¸‹ä¸€å±‚æ— æ³•èŒƒå›´for
```
## 4
### è¿ç®—ç¬¦
* å‰ç½®`++`ã€`--`è¿”å›å·¦å€¼ï¼Œåç½®è¿”å›å³å€¼ï¼ˆç±»å¯¹è±¡å¯èƒ½æœ‰æ€§èƒ½æŸå¤±ï¼‰
* `&&`ã€`||`ã€`?:`ã€`,`è§„å®šæ±‚å€¼é¡ºåº
* æ±‚å€¼é¡ºåºç‹¬ç«‹äºä¼˜å…ˆçº§ã€ç»“åˆå¾‹
* `m/n`å‘0å–æ•´ï¼Œ`m%n`å’Œ`m`åŒå·
```c++
int i;
i = {1};
string s = "s";
// i = {3.14}; // é”™è¯¯ï¼Œä¸¢å¤±ç²¾åº¦
i = {}; // 0ï¼›ç±»ä¼¼å€¼åˆå§‹åŒ–ï¼Œä¸‹åŒ
s = {}; // ""
```
* `?:`çš„ä¸¤ä¸ªç»“æœè¡¨è¾¾å¼éƒ½æ˜¯å·¦å€¼æ—¶è¿”å›å·¦å€¼
* æœ‰ç¬¦å·æ•°å³ç§»æ—¶ç¬¦å·ä½çš„å¤„ç†æœºå™¨ç›¸å…³ï¼Œå·¦ç§»æ—¶æ”¹å˜ç¬¦å·ä½ç»“æœæœªå®šä¹‰
```c++
sizeof char == 1 // size_t
sizeof(int) == sizeof(int&)
int i, *p;
sizeof i
sizeof *p // ä¸æ±‚å€¼
sizeof ç±»::å­—æ®µ
char a[10];
sizeof(1, a) // 10ï¼š,è¡¨è¾¾å¼å¦‚æœå³ä¾§æ˜¯å·¦å€¼åˆ™ç»“æœä¸ºå·¦å€¼
```
### éšå¼ç±»å‹è½¬æ¢
* å°æ•´å‹å¦‚æœæ­£å€¼èŒƒå›´åŒ…å«äº`int`åˆ™è¿ç®—æ—¶æå‡ä¸º`int`ï¼Œå¦åˆ™ä¸º`unsigned`
* `wchar_t`ã€`char16_t`ã€`char32_t`æŒ‰æ­£å€¼èŒƒå›´æå‡åˆ°`int`ã€`unsigned`ã€`long`ã€`unsigned long`ã€`long long`ã€`unsigned long long`ä¸­æœ€å°çš„
* å°unsignedå’Œå¤§signedç›¸é‡ï¼Œè‹¥unsignedèŒƒå›´åŒ…å«äºsignedï¼ˆLinux amd64çš„unsignedå’Œlong longï¼‰åˆ™è½¬æ¢ä¸ºå¤§signedï¼Œå¦åˆ™ï¼ˆLinux amd64çš„unsigned longå’Œlong longï¼‰éƒ½è½¬æ¢ä¸ºå¤§unsigned
### æ˜¾å¼ç±»å‹è½¬æ¢
* `è½¬æ¢å<ç±»å‹>(è¡¨è¾¾å¼)`ï¼Œç±»å‹ä¸ºå¼•ç”¨æ—¶ç»“æœä¸ºå·¦å€¼
* `static_cast`è½¬æ¢æ•°å€¼ç±»å‹ï¼Œæˆ–æŠŠ`void *`è½¬æˆå…·ä½“ç±»å‹ï¼ˆå¿…é¡»å®é™…ä¸ºè¯¥ç±»å‹ï¼Œå¦åˆ™ç»“æœæœªå®šä¹‰ï¼‰
* `const_cast`ä»…å¯ç”¨äºä¿®æ”¹åº•å±‚`const`ï¼Œä½†è‹¥å¯¹è±¡æœ¬èº«ä¸º`const`ï¼Œå¯¹å…¶å†™å…¥ç»“æœæœªå®šä¹‰ï¼›å…¶ä»–castä¸å¯ä¿®æ”¹åº•å±‚`const`
* `reinterpret_cast`ä¿ç•™åº•å±‚bitï¼Œè½¬æ¢è§£é‡Šæ–¹å¼
* `const_cast`ä¸»è¦ç”¨äºé‡è½½å‡½æ•°ï¼Œæ…ç”¨`reinterpret_cast`
* æ—§å¼ç±»å‹è½¬æ¢å°è¯•`const_cast`æˆ–`static_cast`ï¼Œè‹¥éƒ½ä¸åˆæ³•åˆ™é‡‡ç”¨`reinterpret_cast`
```c++
int i;
char *p = (char *)&i; // reinterpret_cast<char *>
```
## 5
```c++
if (int i = get_num()) { // whileã€switch
    // å¯ä½¿ç”¨i
} else {
    // å¯ä½¿ç”¨i
}
```
* `switch`éæœ€åä¸€ä¸ªåˆ†æ”¯ä¸å¯ä»¥åˆå§‹åŒ–ï¼ˆåŒ…æ‹¬é»˜è®¤åˆå§‹åŒ–ï¼‰å˜é‡ï¼Œåªå¯ä»¥å£°æ˜ï¼›è‹¥åˆå§‹åŒ–å˜é‡åˆ™éœ€åŒ…å«åœ¨`{}`
* `do while`æ¡ä»¶ä¸å¯å®šä¹‰å˜é‡ï¼Œå‡ºç°çš„å˜é‡å¿…é¡»åœ¨å¾ªç¯ä½“å¤–å®šä¹‰
* `goto`çš„æ ‡ç­¾å’Œå…¶ä»–æ ‡è¯†ç¬¦ä¸å†²çªï¼ŒåŒ`switch`ä¸€æ ·`goto`ä¸å¯è·³è¿‡å˜é‡åˆå§‹åŒ–åˆ°è¾¾å˜é‡ä½œç”¨åŸŸå†…
### å¼‚å¸¸
```c++
try {
    int i;
    throw std::runtime_error("reason");
} catch (std::runtime_error err) {
    cout << err.what(); // const char *
} catch (std::exception) { // åŸºç±»å¼‚å¸¸é å
    // ä¸å¯ä½¿ç”¨i
}
```
* è‹¥å¼‚å¸¸æœ€ç»ˆä¸è¢«æ•è·ï¼Œè‡ªåŠ¨è°ƒç”¨åº“å‡½æ•°`terminate`ï¼ˆ`exception`å¤´æ–‡ä»¶å®šä¹‰ï¼‰ç»ˆæ­¢ç¨‹åº
* `exception`å¤´æ–‡ä»¶å®šä¹‰åŸºç±»`exception`
* `stdexcept`å¤´æ–‡ä»¶å®šä¹‰`runtime_error`ã€`logic_error`åŠå…¶æ´¾ç”Ÿç±»

runtime_erroræ´¾ç”Ÿç±»|æ„ä¹‰|æ ‡å‡†åº“ç¤ºä¾‹
-|-|-
range_error|ç»“æœè¶…å‡ºæœ‰æ„ä¹‰èŒƒå›´|`wstring_convert::from_bytes`, `wstring_convert::to_bytes`
overflow_error|ç»“æœä¸Šæº¢|`bitset::to_ulong`, `bitset::to_ullong`
underflow_error|ç»“æœä¸‹æº¢|æ— 

logic_erroræ´¾ç”Ÿç±»|æ„ä¹‰|æ ‡å‡†åº“ç¤ºä¾‹
-|-|-
domain_error|å‚æ•°ä¸åœ¨å®šä¹‰åŸŸ|æ— 
invalid_argument|éæ³•å‚æ•°|`stoi("x")`
length_error|è¯•å›¾åˆ›å»ºè¶…é•¿å¯¹è±¡|`v.reserve(v.max_size() + 1)`
out_of_range|å‚æ•°è¶…é™|`stoi("2147483648")`
* `new`å¤´æ–‡ä»¶å®šä¹‰`bad_alloc`
* `type_info`å¤´æ–‡ä»¶å®šä¹‰`bad_cast`
* `exception`ã€`bad_alloc`ã€`bad_cast`åªèƒ½é»˜è®¤åˆå§‹åŒ–ï¼ˆ`what`è¿”å›å€¼ç”±ç¼–è¯‘å™¨å†³å®šï¼‰ï¼Œå…¶ä»–å¼‚å¸¸åªèƒ½ç”¨å­—ç¬¦ä¸²æˆ–å­—ç¬¦æ•°ç»„åˆå§‹åŒ–
## 6
### å‚æ•°
* å½¢å‚å¯ä»¥ä¸å‘½å
* å±€éƒ¨é™æ€å˜é‡åœ¨æ§åˆ¶æµç¬¬ä¸€æ¬¡åˆ°è¾¾å…¶å®šä¹‰å‰åˆå§‹åŒ–
* åœ¨å‡½æ•°å†…ä¸æ›´æ”¹çš„å¼•ç”¨å‚æ•°åº”å£°æ˜ä¸ºå¸¸å¼•ç”¨ï¼ŒæŒ‡é’ˆåŒç†
* `argv[0]`å¯èƒ½ä¸º`""`
### initializer_list
```c++
#include <initializer_list>
initializer_list<int> l1; // ç©ºåˆ—è¡¨
auto l2 = {1, 2, 3};
auto l3(l2); // ä¸å¤åˆ¶å…ƒç´ ï¼Œä¸‹åŒ
l1 = l2
const int *beg = l1.begin(), *last = l1.end();
void f(initializer_list<string> l, int i) {
    for(auto &s : l)
        cout << s;
}
f({"1", "2", "3"}, 1);
```
### è¿”å›å€¼
* voidå‡½æ•°`return`åçš„è¡¨è¾¾å¼åªèƒ½ä¸ºvoidå‡½æ•°çš„è°ƒç”¨
* ç¼–è¯‘å™¨å¯èƒ½æ— æ³•æ£€æµ‹évoidå‡½æ•°ç»“å°¾æœ‰`return`
* ä¸å¯è¿”å›å±€éƒ¨å¯¹è±¡çš„æŒ‡é’ˆï¼ˆå¦‚ä¸´æ—¶çš„`initializer_list`ï¼‰æˆ–å¼•ç”¨
* å¼•ç”¨è¿”å›å€¼æ˜¯å·¦å€¼ï¼Œå…¶ä»–ä¸ºå³å€¼
```c++
vector<int> f() {
    return {1, 2, 3}; // è¿”å›ç±»å¯¹è±¡ï¼Œç±»å†³å®šåˆå§‹åŒ–åˆ—è¡¨çš„è§£é‡Šæ–¹å¼
}
int g() {
    return {3}; // ä¸å¯ä»¥{3.0}
}
```
* `main`å¯ä¸è¿”å›å€¼ï¼Œé»˜è®¤è¿”å›0
```c++
int a[3];
int (*f(int i))[3];
auto f(int i) -> int (*)[3];
decltype(a) *f(int i);
```
### å‡½æ•°é‡è½½
* ä¸å¯å®šä¹‰ä»…è¿”å›å€¼ä¸åŒçš„é‡è½½å‡½æ•°
* ä¸åŒºåˆ†å‚æ•°é¡¶å±‚`const`ï¼ŒåŒºåˆ†åº•å±‚`const`
* éåº•å±‚`const`å¯¹è±¡ä¼˜å…ˆåŒ¹é…å¸¦éåº•å±‚`const`å‚æ•°çš„å‡½æ•°
```c++
const string &f(const string &s) {
    return s;
}
string &f(string &s) {
    auto &r = f(const_cast<const string &>(s));
    return const_cast<string &>(r);
}
```
* é‡è½½å‡½æ•°çš„è°ƒç”¨å¯èƒ½æœ‰å”¯ä¸€æœ€ä½³åŒ¹é…ã€æ— åŒ¹é…ã€å¤šé‡åŒ¹é…ï¼Œåä¸¤è€…æŠ¥é”™
```c++
void f(double);
void f(string);
int main() {
    void f(int); // ç³Ÿç³•å®è·µï¼šå±€éƒ¨å£°æ˜å‡½æ•°
    f(3.14); // å¤–éƒ¨å£°æ˜è¢«å±è”½ï¼Œè°ƒç”¨f(int)
}
```
### é»˜è®¤å‚æ•°
```c++
char g();
double h = 1;
void f(int i, double d, char c = g());
void f(int, double = h, char); // åœ¨æ—§å£°æ˜åŸºç¡€ä¸Šå¢åŠ äº†ä¸€ä¸ªé»˜è®¤å‚æ•°
int main() {
    h = 2; // æ”¹å˜é»˜è®¤å€¼
    int h = 3; // å±è”½å…¨å±€å˜é‡ï¼Œä¸å½±å“é»˜è®¤å€¼
    f(0); // f(0, 2.0, g())
}
```
### å†…è”å‡½æ•°
* è¿”å›å€¼å‰åŠ `inline`ï¼Œç¼–è¯‘å™¨ä¸ä¿è¯å±•å¼€
### constexprå‡½æ•°
* å‚æ•°å’Œè¿”å›å€¼ä¸ºå­—é¢ç±»å‹ï¼Œå‡½æ•°ä½“æ°å¥½æ˜¯ä¸€ä¸ª`return`
* `constexpr`å‡½æ•°éšå«ä¸ºå†…è”å‡½æ•°
* ä¼ é€’é`constexpr`å‚æ•°æ—¶ï¼Œè¿”å›é`constexpr`å€¼
```c++
constexpr int f(int i) { return i+1; }
int a[f(1)];
int i = 2;
// int b[f(i)]; // é”™è¯¯ï¼Œä½†æœ‰çš„ç¼–è¯‘å™¨æ”¯æŒ
```
* å†…è”å‡½æ•°ã€`constexpr`å‡½æ•°å¯é‡å¤å®šä¹‰ï¼Œä½†å®šä¹‰å¿…é¡»ä¸€è‡´ï¼Œä¸”ç¼–è¯‘å™¨éœ€è¦å®šä¹‰æ‰èƒ½å±•å¼€ï¼Œå› æ­¤å¸¸äºå¤´æ–‡ä»¶å®šä¹‰
### è°ƒè¯•
* `cassert`å¤´æ–‡ä»¶å®šä¹‰å®`assert`ï¼Œå½“è¡¨è¾¾å¼ä¸ºå‡æ—¶ç»ˆæ­¢ç¨‹åº
* è‹¥å®šä¹‰äº†`NDEGUG`ï¼Œåˆ™`assert`ä¸èµ·ä½œç”¨
* `__func__`ä¸ºå½“å‰å‡½æ•°åï¼Œç±»å‹`static const char[]`
* `__FILE__`ã€`__LINE__`ã€`__TIME__`ã€`__DATE__`å®šä¹‰åŒC
### å‡½æ•°åŒ¹é…
* å€™é€‰å‡½æ•°ï¼šå£°æ˜å¯è§ï¼Œå‡½æ•°ååŒ¹é…
* å¯è¡Œå‡½æ•°ï¼šå€™é€‰å‡½æ•°ä¸­å¯ç”¨ç»™å®šå‚æ•°è°ƒç”¨çš„
* æœ€ä½³åŒ¹é…ï¼šç›¸å¯¹äºå…¶ä»–å¯è¡Œå‡½æ•°ï¼Œæ¯ä¸ªå‚æ•°çš„è½¬æ¢ç¨‹åº¦ç›¸åŒæˆ–æ›´ä¼˜ï¼Œä¸”æœ‰å‚æ•°çš„è½¬æ¢ç¨‹åº¦æ›´ä¼˜
* æœ‰å”¯ä¸€æœ€ä½³åŒ¹é…æ—¶ï¼Œè°ƒç”¨æ— æ­§ä¹‰ï¼Œå¦åˆ™æŠ¥é”™
* è‹¥éœ€è¦å¯¹å‚æ•°å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œåˆ™é‡è½½å‡½æ•°è®¾è®¡æœ‰é—®é¢˜
* è½¬æ¢ç¨‹åº¦æ’åºï¼šç²¾ç¡®åŒ¹é…ï¼ˆç›¸åŒç±»å‹ã€æ•°ç»„/å‡½æ•°->ç›¸åº”æŒ‡é’ˆã€åªå·®é¡¶å±‚`const`ï¼‰ï¼Œåº•å±‚`const`è½¬æ¢ï¼Œæ•´å‹æå‡ï¼Œç®—æœ¯/æŒ‡é’ˆç±»å‹è½¬æ¢ï¼Œç±»è½¬æ¢
### å‡½æ•°æŒ‡é’ˆ
* å£°æ˜ä¸ºå‡½æ•°çš„å‚æ•°è‡ªåŠ¨ä¸ºå‡½æ•°æŒ‡é’ˆ
* è¿”å›å‡½æ•°æŒ‡é’ˆæ—¶ä¸èƒ½å£°æ˜è¿”å›å€¼ä¸ºå‡½æ•°
```c++
double f(int);
decltype(f) g; // å‡½æ•°
decltype(f) *p; // å‡½æ•°æŒ‡é’ˆ
```
## 7
### æˆå‘˜å‡½æ•°
* æˆå‘˜å‡½æ•°å¿…é¡»åœ¨ç±»å†…å£°æ˜ï¼Œå¯åœ¨ç±»å¤–å®šä¹‰ï¼ˆå‡½æ•°åå‰åŠ `ç±»::`ï¼›è‹¥è¿”å›ç±»å‹ä¹Ÿæ˜¯ç±»æˆå‘˜ï¼Œç”±äºå‡ºç°åœ¨å‡½æ•°åå‰ï¼Œä¹Ÿéœ€è¦åŠ `ç±»::`ï¼‰
* ç±»å†…å®šä¹‰çš„å‡½æ•°éšå«ä¸ºå†…è”å‡½æ•°
* æˆå‘˜å‡½æ•°ä¸­`this`ä¸ºæŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆå¸¸é‡ï¼ˆé¡¶å±‚`const`ï¼‰
* æˆå‘˜å‡½æ•°å‚æ•°è¡¨åæ¥`const`åˆ™`this`ä¸ºå¸¸é‡æŒ‡é’ˆï¼ˆåº•å±‚`const`ï¼‰
* è‹¥è¦è¿”å›`*this`ï¼Œåˆ™å¯æ ¹æ®`const`é‡è½½æˆå‘˜å‡½æ•°ï¼Œé`const`å¯¹è±¡ä¼˜å…ˆè°ƒç”¨é`const`æˆå‘˜å‡½æ•°
* æˆå‘˜å‡½æ•°æœ€åç¼–è¯‘ï¼Œå› æ­¤å¯å‡ºç°åœ¨å…¶ä½¿ç”¨çš„æˆå‘˜å®šä¹‰ä¹‹å‰
* æˆå‘˜å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡å±è”½åŒåæˆå‘˜å˜é‡ï¼Œä½¿ç”¨åè€…åº”ç”¨`this->`æˆ–`ç±»::`
### æ„é€ å‡½æ•°
* æ„é€ å‡½æ•°ä¸èƒ½ä¸º`const`
* æœªå®šä¹‰æ„é€ å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆé»˜è®¤æ„é€ å‡½æ•°ï¼šå¯¹æœ‰åˆå€¼çš„æˆå‘˜å˜é‡ç±»å†…åˆå§‹åŒ–ï¼Œå¯¹å…¶ä»–æˆå‘˜å˜é‡é»˜è®¤åˆå§‹åŒ–
* `ç±»() {}`ä¸åˆæˆé»˜è®¤æ„é€ å‡½æ•°è¯­ä¹‰ç›¸åŒä½†å½±å“ç±»å±æ€§ï¼ˆ`is_trival`ã€`is_pod`ã€å€¼åˆå§‹åŒ–ï¼‰
* æ˜¾å¼å®šä¹‰åˆæˆé»˜è®¤æ„é€ å‡½æ•°ï¼š`ç±»() = default;`
* åˆå§‹åŒ–åˆ—è¡¨ï¼š`ç±»(...) : æˆå‘˜1(...), æˆå‘˜2{...} ... {...}`ï¼Œåˆå§‹åŒ–é¡ºåºåŒå£°æ˜é¡ºåºï¼ˆä¸åˆå§‹åŒ–åˆ—è¡¨çš„é¡ºåºæ— å…³ï¼‰ï¼Œæœªåœ¨åˆå§‹åŒ–åˆ—è¡¨å‡ºç°çš„æˆå‘˜å˜é‡ç±»å†…åˆå§‹åŒ–æˆ–é»˜è®¤åˆå§‹åŒ–ï¼Œæ‰€æœ‰æˆå‘˜å˜é‡åˆå§‹åŒ–å®Œæˆåæ„é€ å‡½æ•°ä½“æ‰§è¡Œ
* å§”æ‰˜æ„é€ ï¼šæ„é€ å‡½æ•°çš„åˆå§‹åŒ–åˆ—è¡¨ä¸ºå¯¹å¦ä¸€ä¸ªæ„é€ å‡½æ•°çš„è°ƒç”¨
### è®¿é—®é™å®š
* è®¿é—®é™å®šç¬¦å¯å‡ºç°ä»»æ„å¤šæ¬¡
* `class`å’Œ`struct`çš„å”¯ä¸€åŒºåˆ«æ˜¯ç¬¬ä¸€ä¸ªè®¿é—®é™å®šç¬¦å‰çš„æˆå‘˜å£°æ˜æ˜¯`private`è¿˜æ˜¯`public`
### å‹å…ƒ
* å‹å…ƒå‡½æ•°ï¼šç±»å†…å£°æ˜ï¼Œè¿”å›å€¼å‰åŠ `friend`ï¼Œå‡½æ•°ä½“å¯è®¿é—®ç±»çš„é`public`æˆå‘˜
* å‹å…ƒå‡½æ•°ä¸æ˜¯æˆå‘˜å‡½æ•°ï¼Œå¯åœ¨ç±»çš„ä»»æ„ä½ç½®å£°æ˜ï¼Œä¸å—è®¿é—®é™å®šç¬¦å½±å“
* ç±»å†…å£°æ˜çš„å‹å…ƒå‡½æ•°åªè´Ÿè´£è®¿é—®æ§åˆ¶ï¼Œåº”åœ¨ç±»æ‰€åœ¨å¤´æ–‡ä»¶å†æ¬¡å£°æ˜ï¼ˆä¸€äº›ç¼–è¯‘å™¨ä¸ä½œæ­¤è¦æ±‚ï¼‰
* `friend class å‹å…ƒç±»;`ï¼Œå‹å…ƒç±»çš„æ‰€æœ‰æˆå‘˜å‡½æ•°å¯è®¿é—®æœ¬ç±»ç§æœ‰æˆå‘˜ï¼›å‹å…ƒç±»ä¸å¯ä¼ é€’
* `friend è¿”å›ç±»å‹ å…¶ä»–ç±»::æˆå‘˜å‡½æ•°(...);`ï¼Œä»…è¯¥æˆå‘˜å‡½æ•°å¯è®¿é—®
```c++
class A;
struct B {
    void modifyA(A &);
};
class A {
    int x;
    friend void B::modifyA(A &); // å¿…é¡»æå‰å£°æ˜
    friend void f(); // å¯ä¸æå‰å£°æ˜ï¼Œä¸‹åŒ
    friend class C;
};
void B::modifyA(A &a) {
    a.x = 0;
}
```
### æ‚é¡¹
* å¯ç”¨`typedef`æˆ–`using`å®šä¹‰ç±»å‹æˆå‘˜ï¼Œéµå¾ªè®¿é—®é™å®šï¼Œä¸”å¿…é¡»å…ˆå®šä¹‰åä½¿ç”¨ï¼›ä¸å¯ä¸ç±»å¤–çš„ç±»å‹é‡åï¼ˆä¸€äº›ç¼–è¯‘å™¨ä¸ä½œæ­¤è¦æ±‚ï¼‰
* æˆå‘˜å˜é‡å£°æ˜ä¸º`mutable`ï¼Œåˆ™`const`å¯¹è±¡ä¹Ÿå¯ä¿®æ”¹è¯¥æˆå‘˜
* æ‹¥æœ‰ç›¸åŒæˆå‘˜çš„ç±»æ˜¯ä¸åŒçš„ç±»
* å£°æ˜ç±»å¯¹è±¡å¯ä»¥åƒCä¸€æ ·åœ¨ç±»åå‰åŠ `struct`æˆ–`class`
* å‰å‘å£°æ˜ï¼š`class ç±»;`ï¼Œç”¨äºå®šä¹‰æŒ‡é’ˆæˆ–å¼•ç”¨ã€å£°æ˜ï¼ˆä½†ä¸æ˜¯å®šä¹‰ï¼‰ä»¥è¯¥ç±»å¯¹è±¡ä¸ºå‚æ•°æˆ–è¿”å›å€¼çš„å‡½æ•°
* ä¸æä¾›ç›¸åº”å‡½æ•°æ—¶ï¼Œæ‰§è¡Œé»˜è®¤çš„å¤åˆ¶ã€èµ‹å€¼ã€ææ„
### éšå¼ç±»å‹è½¬æ¢
* å¯ç”¨å•å‚æ•°è°ƒç”¨çš„æ„é€ å‡½æ•°å®šä¹‰äº†ä»å‚æ•°ç±»å‹åˆ°è¯¥ç±»çš„éšå¼è½¬æ¢
* ç±»å†…å£°æ˜æ—¶`explicit`ç¦ç”¨éšå¼è½¬æ¢ï¼ˆå¦‚`vector`æ¥å—å…ƒç´ ä¸ªæ•°å‚æ•°çš„æ„é€ å‡½æ•°ï¼‰ï¼Œç±»å¤–å®šä¹‰ä¸é‡å¤å£°æ˜`explicit`
```c++
struct A {
    A(const string &s) {}
    explicit A(int i);
};
A::A(int i) {}
void f(const A &a) {}
int main() {
    string s;
    A a1 = s;
    f(s);
    // f(""); // é”™è¯¯ï¼Œéšå¼è½¬æ¢æœ€å¤šä¸€æ¬¡
    // f(0); // é”™è¯¯
    // A a2 = 0; // é”™è¯¯ï¼Œå¿…é¡»ç›´æ¥åˆå§‹åŒ–
    A a3 = static_cast<A>(0);
}
```
### èšåˆç±»
* æ‰€æœ‰æˆå‘˜å˜é‡éƒ½æ˜¯`public`ï¼Œä¸”æ²¡æœ‰åˆå€¼
* æ²¡æœ‰å®šä¹‰æ„é€ å‡½æ•°
* æ²¡æœ‰åŸºç±»å’Œè™šå‡½æ•°
```c++
struct A {
    int i;
    string s;
    double d;
};
A a = {1, "a"}; // å‰©ä½™å…ƒç´ å€¼åˆå§‹åŒ–
```
### å­—é¢ç±»
* æ‰€æœ‰æˆå‘˜å˜é‡éƒ½æ˜¯å­—é¢ç±»å‹
* å¯¹äºéèšåˆç±»è¿˜éœ€æ»¡è¶³ï¼šè‡³å°‘æœ‰ä¸€ä¸ª`constexpr`æ„é€ å‡½æ•°ï¼›æœ‰åˆå€¼çš„å†…ç½®ç±»å‹æˆå‘˜å˜é‡åˆå€¼ä¸º`constexpr`ï¼Œæœ‰åˆå€¼çš„ç±»æˆå‘˜å˜é‡ä½¿ç”¨è¯¥æˆå‘˜æ‰€å±ç±»çš„`constexpr`æ„é€ å‡½æ•°ï¼›ä½¿ç”¨é»˜è®¤çš„ææ„å‡½æ•°
* `constexpr`æ„é€ å‡½æ•°å¯ä»¥æ˜¯`=default`æˆ–`{}`ï¼Œåˆå§‹åŒ–åˆ—è¡¨éœ€åŒ…å«æ‰€æœ‰æ— åˆå€¼çš„æˆå‘˜å˜é‡ä¸”æä¾›`constexpr`åˆå€¼
### é™æ€æˆå‘˜
* ä½œç”¨åŸŸå¤–è®¿é—®æ–¹å¼ï¼š`ç±»::é™æ€æˆå‘˜`ï¼Œ`å¯¹è±¡æˆ–å¼•ç”¨.é™æ€æˆå‘˜`ï¼Œ`æŒ‡é’ˆ->é™æ€æˆå‘˜`
* `static constexpr`æˆå‘˜å˜é‡å¿…é¡»ç±»å†…åˆå§‹åŒ–ï¼Œ`static const`æ•´å‹æˆå‘˜å˜é‡å¯åœ¨ç±»å†…åˆå§‹åŒ–ï¼ˆåˆå€¼å¿…é¡»ä¸º`constexpr`ï¼‰ï¼Œå…¶ä»–`static`æˆå‘˜å˜é‡å¿…é¡»åœ¨ç±»å¤–å®šä¹‰
```c++
struct A {
    static int i1;
    static const int i2 = 0;
    static constexpr double d = 0;
};
int A::i1 = 0;
const int A::i2; // ç”±äºä¸èƒ½å°†æ‰€æœ‰i2çš„å‡ºç°æ›¿æ¢ä¸ºå¸¸é‡ï¼Œå¿…é¡»åœ¨ç±»å¤–å®šä¹‰
void f(const int &i) {}
int main() {
    f(A::i2);
}
```
* `static`æˆå‘˜å˜é‡å¯ä»¥ä¸ºè¯¥ç±»ç±»å‹ï¼Œå¯ä»¥ä½œä¸ºæˆå‘˜å‡½æ•°å‚æ•°é»˜è®¤å€¼
## 8
### IOç±»
* `iostream`å¤´æ–‡ä»¶å®šä¹‰`istream`ã€`ostream`ã€`iostream`
* `fstream`å¤´æ–‡ä»¶å®šä¹‰`ifstream`ã€`ofstream`ã€`fstream`
* `sstream`å¤´æ–‡ä»¶å®šä¹‰`istringstream`ã€`ostringstream`ã€`stringstream`
* ä¸Šè¿°ç±»éƒ½æœ‰å¯¹åº”çš„`w*`ç±»å¤„ç†`wchar_t`
* `fstream`ã€`stringstream`ç­‰ç±»ç»§æ‰¿è‡ªå¯¹åº”çš„`iostream`ç±»
* IOå¯¹è±¡ä¸å¯å¤åˆ¶ã€èµ‹å€¼
### æµçŠ¶æ€
```c++
strm::iostate // æœºå™¨ç›¸å…³æ•´æ•°ç±»å‹
strm::badbit // ä¸å¯æ¢å¤é”™è¯¯ä½
strm::failbit // å¯æ¢å¤é”™è¯¯ä½
strm::eofbit // æµç»“æŸä½ï¼ŒåŒæ—¶è®¾ç½®failbit
strm::goodbit // 0
bool s.eof() // eofbitç½®ä½åˆ™ä¸ºtrue
bool s.fail() // failbitæˆ–badbitç½®ä½åˆ™ä¸ºtrueï¼Œif(s)ç­‰ä»·äºif(!s.fail())
bool s.bad() // badbitç½®ä½åˆ™ä¸ºtrue
bool s.good() // é”™è¯¯ä½å‡æœªç½®ä½åˆ™ä¸ºtrue
void s.clear() // é‡ç½®æ‰€æœ‰é”™è¯¯ä½
void s.clear(flags) // è®¾ç½®ä¸ºç»™å®šé”™è¯¯ä½
void s.setstate(flags) // ç½®ä½ç»™å®šé”™è¯¯ä½
strm::iostate s.rdstate() // è¿”å›å½“å‰çŠ¶æ€
```
### è¾“å‡ºç¼“å†²
* åˆ·æ–°è¾“å‡ºç¼“å†²åŒºçš„æ¡ä»¶ï¼šç¨‹åºæ­£å¸¸ç»ˆæ­¢ã€ç¼“å†²åŒºæ»¡ã€æ˜¾å¼åˆ·æ–°ã€`unitbuf`ï¼ˆå¦‚`cerr`ï¼‰ã€ç›¸å…³çš„å¦ä¸€ä¸ªæµæœ‰è¯»å†™è¡Œä¸ºï¼ˆè¯»å–`cin`æˆ–å†™å…¥`cerr`ä¼šåˆ·æ–°`cout`ï¼‰
```c++
cout << "1" << flush; // åˆ·æ–°
cout << "2" << ends; // å†™ç©ºå­—ç¬¦å¹¶åˆ·æ–°
cout << unitbuf; // ç¦ç”¨ç¼“å†²
cout << nounitbuf; // æ¢å¤ç¼“å†²
is.tie() // è¿”å›æŒ‡é’ˆï¼ŒæŒ‡å‘è¾“å…¥æµç»‘å®šçš„è¾“å‡ºæµï¼›è¾“å…¥æµã€è¾“å‡ºæµå¤šå¯¹ä¸€
is.tie(&os) // è¿”å›æ—§æŒ‡é’ˆï¼Œç»‘å®šæ–°è¾“å‡ºæµï¼Œè¯»å–isåˆ·æ–°os
```
### fstream
```c++
fstrm fs; // æœªç»‘å®šæ–‡ä»¶
fstrm fs(s); // æ‰“å¼€æ–‡ä»¶ï¼Œsä¸ºstringæˆ–Cå­—ç¬¦ä¸²ï¼Œå¤±è´¥ç½®ä½failbit
fstrm fs(s, mode); // æŒ‡å®šæ¨¡å¼
void fs.open(s) // è‹¥fså·²æ‰“å¼€æ–‡ä»¶åˆ™å¤±è´¥
void fs.open(s, mode)
void fs.close() // fsé”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨close
bool fs.is_open()
```
mode|æ„ä¹‰
-|-
fstrm::in|è¾“å…¥ï¼Œifstreamã€fstreamé»˜è®¤
out|è¾“å‡ºï¼Œofstreamã€fstreamé»˜è®¤
app|è¿½åŠ ï¼Œä¸truncå†²çªï¼Œéšå«out
ate|ç«‹å³æŒ‡å‘æ–‡ä»¶å°¾ï¼Œä¸å…¶ä»–æ¨¡å¼ä¸å†²çª
trunc|æˆªæ–­ï¼Œå¿…é¡»åŒæ—¶æŒ‡å®šout
binary|äºŒè¿›åˆ¶æ¨¡å¼ï¼Œä¸å…¶ä»–æ¨¡å¼ä¸å†²çª
* `ofstream`ä¸æŒ‡å®š`in`æˆ–`app`åˆ™éšå«`trunc`
### stringstream
```c++
sstrm ss; // æœªç»‘å®šå­—ç¬¦ä¸²
sstrm ss(s); // ç»‘å®šsçš„å‰¯æœ¬
string ss.str() // ç»‘å®šå­—ç¬¦ä¸²çš„å‰¯æœ¬
void ss.str(s) // ç»‘å®šæ–°å­—ç¬¦ä¸²ï¼Œä¸æ”¹å˜æµçŠ¶æ€
```
## 9
### å®¹å™¨æ“ä½œ
ç±»å‹åˆ«å|æ„ä¹‰
-|-
iterator|è¿­ä»£å™¨
const_iterator|åªè¯»è¿­ä»£å™¨
size_type|unsignedå¤§å°
difference_type|signedè·ç¦»
value_type|å…ƒç´ 
reference|value_type&
const_reference|const value_type&

æ„é€ |æ„ä¹‰
-|-
C c|ç©ºå®¹å™¨ï¼ˆé™¤arrayï¼‰
C c1(c2)|å¤åˆ¶
C c(b, e)|è¿­ä»£å™¨èŒƒå›´å¤åˆ¶ï¼ˆä¸é€‚ç”¨arrayï¼‰ï¼Œå®¹å™¨ç±»å‹å¯ä¸åŒï¼Œå…ƒç´ ç±»å‹å¯ä»¥è½¬æ¢
C c{a, b, ...}|åˆ—è¡¨åˆå§‹åŒ–

èµ‹å€¼å’Œäº¤æ¢|æ„ä¹‰
-|-
c1 = c2|ç”¨c2çš„å…ƒç´ æ›¿æ¢c1
c1 = {a, b, ...}|ç”¨åˆ—è¡¨å…ƒç´ æ›¿æ¢c1
a.swap(b)|äº¤æ¢aå’Œbçš„å…ƒç´ 
swap(a, b)|åŒa.swap(b)

å¤§å°|æ„ä¹‰
-|-
c.size()|å…ƒç´ ä¸ªæ•°ï¼ˆä¸é€‚ç”¨forward_listï¼‰
c.max_size()|å…ƒç´ ä¸ªæ•°æœ€å¤§å€¼
c.empty()|æ˜¯å¦ä¸ºç©º

æ’å…¥/åˆ é™¤å…ƒç´ |æ„ä¹‰ï¼ˆä¸é€‚ç”¨arrayï¼‰
-|-
c.insert(args)|æ’å…¥
c.emplace(inits)|æ„é€ å¹¶æ’å…¥
c.erase(args)|åˆ é™¤
void c.clear()|åˆ é™¤å…¨éƒ¨

æ¯”è¾ƒ|æ„ä¹‰
-|-
==ã€!=|é€‚ç”¨å…¨éƒ¨å®¹å™¨
<ã€<=ã€>ã€>=|ç±»ä¼¼å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œä¸é€‚ç”¨æ— åºå…³è”å®¹å™¨

è¿­ä»£å™¨|æ„ä¹‰
-|-
c.begin()ã€c.end()|iterator
c.cbegin()ã€c.cend()|const_iterator

ååºè¿­ä»£å™¨|æ„ä¹‰ï¼ˆä¸é€‚ç”¨forward_listï¼‰
-|-
c.rbegin()ã€c.rend()|reverse_iterator
c.crbegin()ã€c.crend()|const_reverse_iterator
### åºåˆ—å®¹å™¨æ“ä½œ
åºåˆ—å®¹å™¨åˆå§‹åŒ–|æ„ä¹‰
-|-
seq(n)|nä¸ªå€¼åˆå§‹åŒ–å…ƒç´ 
seq(n, v)|nä¸ªå…ƒç´ v
```c++
array<int, 3> a1; // é»˜è®¤åˆå§‹åŒ–
array<int ,3> a2 = {1, 2}; // {1, 2, 0}ï¼›å€¼åˆå§‹åŒ–
```
åºåˆ—å®¹å™¨èµ‹å€¼|æ„ä¹‰ï¼ˆä¸é€‚ç”¨arrayï¼‰
-|-
seq.assign(b, e)|ç±»ä¼¼è¿­ä»£å™¨åˆå§‹åŒ–ï¼Œbã€eä¸å¯ä¸ºseqçš„è¿­ä»£å™¨
seq.assign(il)|ç”¨initializer_listä¸­çš„å…ƒç´ ä»£æ›¿
seq.assign(n, t)|nä¸ªå…ƒç´ v
* èµ‹å€¼ä½¿è¢«èµ‹å€¼å®¹å™¨çš„è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆ
* äº¤æ¢ä¸ä½¿å®¹å™¨çš„è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆï¼ˆstringé™¤å¤–ï¼‰ï¼Œå®ƒä»¬éƒ½è½¬è€ŒæŒ‡å‘å¦ä¸€ä¸ªå®¹å™¨ï¼ˆarrayé™¤å¤–ï¼‰

åºåˆ—å®¹å™¨æ’å…¥|æ„ä¹‰
-|-
void seq.push_back(v)ã€void seq.emplace_back(args)|å°¾éƒ¨æ’å…¥/æ„é€ ï¼Œä¸é€‚ç”¨forward_list
void seq.push_front(v)ã€void seq.emplace_front(args)|å¤´éƒ¨æ’å…¥/æ„é€ ï¼Œä¸é€‚ç”¨vectorã€string
seq.insert(iter, v)ã€seq.emplace(iter, args)|åœ¨iterå‰æ’å…¥/æ„é€ 
seq.insert(iter, n, v)|åœ¨iterå‰æ’å…¥nä¸ªv
seq.insert(iter, b, e)|åœ¨iterå‰æ’å…¥båˆ°eçš„å…ƒç´ ï¼ˆbã€eä¸å¯ä¸ºseqçš„è¿­ä»£å™¨ï¼‰
seq.insert(iter, il)|åœ¨iterå‰æ’å…¥åˆå§‹åŒ–åˆ—è¡¨é‡çš„å…ƒç´ 
* insertã€emplaceä¸é€‚ç”¨forward_list
* insertã€emplaceè¿”å›æŒ‡å‘æ’å…¥çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ï¼Œè‹¥insertæœªæ’å…¥ä»»ä½•å…ƒç´ åˆ™è¿”å›iter
* æ’å…¥vectorã€stringä½¿è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆ
* æ’å…¥dequeé™¤å¤´å°¾çš„ä½ç½®ä½¿è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆï¼›æ’å…¥dequeå¤´å°¾ä½¿è¿­ä»£å™¨å¤±æ•ˆï¼Œä½†å…ƒç´ å¼•ç”¨/æŒ‡é’ˆä»æœ‰æ•ˆ
* emplaceåœ¨å®¹å™¨å†…æ„é€ ï¼Œä¸äº§ç”Ÿä¸´æ—¶å¯¹è±¡

åºåˆ—å®¹å™¨è®¿é—®å…ƒç´ |æ„ä¹‰
-|-
seq.back()|æœ€åä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œä¸é€‚ç”¨forward_listï¼Œå¯¹ç©ºå®¹å™¨æœªå®šä¹‰
seq.front()|ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œå¯¹ç©ºå®¹å™¨æœªå®šä¹‰
seq\[n]|ä¸‹æ ‡nå…ƒç´ çš„å¼•ç”¨ï¼Œå¯¹è¶Šç•Œæœªå®šä¹‰
seq.at(n)|ä¸‹æ ‡nå…ƒç´ çš„å¼•ç”¨ï¼Œè¶Šç•ŒæŠ›å‡ºout_of_rangeå¼‚å¸¸
* ä¸‹æ ‡ã€atåªé€‚ç”¨stringã€vectorã€dequeã€array

åºåˆ—å®¹å™¨åˆ é™¤|æ„ä¹‰
-|-
void seq.pop_back()|å°¾éƒ¨åˆ é™¤ï¼Œä¸é€‚ç”¨forward_list
void seq.pop_front()|å¤´éƒ¨åˆ é™¤ï¼Œä¸é€‚ç”¨vectorã€string
seq.erase(iter)|åˆ é™¤iteræ‰€æŒ‡å…ƒç´ ï¼Œiterä¸ºendæ—¶ç»“æœæœªå®šä¹‰
seq.erase(b, e)|åˆ é™¤båˆ°eçš„å…ƒç´ 
* eraseä¸é€‚ç”¨forward_list
* eraseè¿”å›æŒ‡å‘åˆ é™¤çš„æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„è¿­ä»£å™¨
* åˆ é™¤dequeå¤´ã€å°¾å¤–çš„å…ƒç´ ä½¿æ‰€æœ‰è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆï¼›åˆ é™¤dequeå°¾ä½¿endå¤±æ•ˆ
* åˆ é™¤vectorã€stringçš„å…ƒç´ ä½¿å…¶åçš„è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆ

forward_listæ“ä½œ|æ„ä¹‰
-|-
lst.before_begin()ã€lst.cbefore_begin()|æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ å‰çš„è¿­ä»£å™¨ï¼Œä¸å¯è§£å¼•ç”¨
lst.insert_after(iter, v)ã€lst.insert_after(iter, n, v)ã€lst.insert_after(iter, b, e)ã€lst.insert_after(iter, il)|åœ¨iteråæ’å…¥ï¼ˆbã€eä¸å¯ä¸ºlstçš„è¿­ä»£å™¨ï¼‰
lst.emplace_after(iter, args)|åœ¨iteråæ„é€ 
lst.erase_after(iter)|åˆ é™¤iterä¹‹åçš„å…ƒç´ ï¼Œiteræˆ–++iterä¸ºendæ—¶ç»“æœæœªå®šä¹‰
lst.erase_after(b, e)|åˆ é™¤++båˆ°eçš„å…ƒç´ 
* insert_afterã€emplace_afterè¿”å›æŒ‡å‘æ’å…¥çš„æœ€åä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ï¼Œè‹¥insertæœªæ’å…¥ä»»ä½•å…ƒç´ åˆ™è¿”å›iterï¼Œè‹¥iterä¸ºendåˆ™ç»“æœæœªå®šä¹‰
* erase_afterè¿”å›æŒ‡å‘åˆ é™¤çš„æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„è¿­ä»£å™¨

åºåˆ—å®¹å™¨æ›´æ”¹å¤§å°|æ„ä¹‰
-|-
void seq.resize(n)|å°¾éƒ¨ç¼©å®¹ï¼Œæˆ–æ‰©å®¹å¹¶å€¼åˆå§‹åŒ–
void seq.resize(n, v)|å°¾éƒ¨ç¼©å®¹ï¼Œæˆ–æ‰©å®¹å¹¶æ·»åŠ v
* vectorã€stringã€dequeçš„æ‰€æœ‰è¿­ä»£å™¨ã€å…ƒç´ å¼•ç”¨/æŒ‡é’ˆå¤±æ•ˆ

vectorã€stringå®¹é‡|æ„ä¹‰
-|-
v.capacity()|å®¹é‡
v.reserve(n)|å½“å®¹é‡ä¸è¶³næ—¶æ‰©å……å®¹é‡è‡³å°‘åˆ°n
v.shrink_to_fit()|è¯·æ±‚ä½†ä¸ä¿è¯å°†capacityå‡å°‘åˆ°sizeï¼ŒåŒæ—¶é€‚ç”¨deque
* å¢é•¿ç­–ç•¥å®ç°ç›¸å…³ï¼Œä½†ä»…å½“capacityæ— æ³•å®¹çº³sizeæ—¶æ‰é‡æ–°åˆ†é…ç©ºé—´
### å­—ç¬¦ä¸²æ“ä½œ
å­—ç¬¦ä¸²æ„é€ |æ„ä¹‰
-|-
s(ca, n)|å­—ç¬¦æ•°ç»„caçš„å‰nä¸ªå­—ç¬¦ï¼Œæ•°ç»„è‡³å°‘é•¿n
s(str, i[, len])|å­—ç¬¦ä¸²strä»ä¸‹æ ‡iå¼€å§‹ï¼ˆè‡³å¤šé•¿lenï¼‰çš„å­ä¸²ï¼Œi>str.size()æ—¶æŠ›å‡ºout_of_rangeå¼‚å¸¸

å­—ç¬¦ä¸²å­ä¸²|æ„ä¹‰
-|-
s.substr(i, len)|ç±»ä¼¼å­ä¸²æ„é€ å‡½æ•°ï¼Œié»˜è®¤0ï¼Œlené»˜è®¤å‰©ä½™é•¿åº¦

å­—ç¬¦ä¸²æ›´æ”¹|æ„ä¹‰
-|-
s.insert(i, args)|åœ¨ä½ç½®å‰æ’å…¥å…ƒç´ 
s.erase(i[, len])|ä»ièµ·åˆ é™¤ï¼ˆæœ€å¤šlenä¸ªï¼‰å…ƒç´ 
s.assign(args)|æ›¿æ¢
s.append(args)|è¿½åŠ 
s.replace(range, args)|æ›¿æ¢rangeæŒ‡ä»£çš„å­ä¸²
* ä¸Šè¿°å‡½æ•°å‡è¿”å›sçš„å¼•ç”¨
* argsè¿‡äºå¤æ‚ï¼Œè§æ–‡æ¡£

å­—ç¬¦ä¸²æœç´¢|æ„ä¹‰
-|-
s.find(args)|ç¬¬ä¸€æ¬¡å‡ºç°
s.rfind(args)|æœ€åä¸€æ¬¡å‡ºç°
s.find_first_of(args)|ç¬¬ä¸€æ¬¡å‡ºç°argsä¸­ä»»æ„å­—ç¬¦
s.find_last_of(args)|æœ€åä¸€æ¬¡å‡ºç°argsä¸­ä»»æ„å­—ç¬¦
s.find_first_not_of(args)|ç¬¬ä¸€æ¬¡å‡ºç°argså¤–ä»»æ„å­—ç¬¦
s.find_last_not_of(args)|æœ€åä¸€æ¬¡å‡ºç°argså¤–ä»»æ„å­—ç¬¦

æœç´¢å‡½æ•°çš„args|æ„ä¹‰
-|-
c, i=0|ä»s\[i]å¼€å§‹ï¼Œå¯»æ‰¾å­—ç¬¦c
s2, i=0|ä»s\[i]å¼€å§‹ï¼Œå¯»æ‰¾å­—ç¬¦ä¸²s2
cs, i=0|ä»s\[i]å¼€å§‹ï¼Œå¯»æ‰¾Cå­—ç¬¦ä¸²cs
ca, i, n|ä»s\[i]å¼€å§‹ï¼Œå¯»æ‰¾å­—ç¬¦æ•°ç»„caçš„å‰nä¸ªå­—ç¬¦
* ä¸Šè¿°å‡½æ•°æ— åŒ¹é…åˆ™è¿”å›`string::npos`ï¼Œå³`(string::size_type)-1`

s.compare(args)|æ„ä¹‰
-|-
s2|så’Œs2
i, len, s2|s.substr(i, len)å’Œs2
i, len, s2, i2, len2|s.substr(i, len)å’Œs2.substr(i2, len2)
cs|så’ŒCå­—ç¬¦ä¸²cs
i, len, cs|s.substr(i, len)å’Œcs
i, len, ca, n|s.substr(i, len)å’Œå­—ç¬¦æ•°ç»„caçš„å‰nä¸ªå­—ç¬¦

æ•°å€¼è½¬æ¢|æ„ä¹‰
-|-
to_string(v)|å°†æµ®ç‚¹æ•°æˆ–intåŠä»¥ä¸Šçš„æ•´æ•°è½¬ä¸ºå­—ç¬¦ä¸²
sto{i,l,ul,ll,ull}(s, size_t \*p = 0, b = 10)|å°†sçš„å¤´éƒ¨è½¬ä¸ºæ•´æ•°ï¼Œè‹¥pé0åˆ™å°†*pè®¾ä¸ºä¸‹ä¸€ä¸ªå­—ç¬¦çš„ä¸‹æ ‡ï¼Œbè¿›åˆ¶
sto{f,d,ld}(s, size_t *p = 0)|å°†sçš„å¤´éƒ¨è½¬ä¸ºæµ®ç‚¹æ•°
* éæ³•å­—ç¬¦ä¸²æŠ›å‡ºinvalid_argumentå¼‚å¸¸ï¼Œè¶…å‡ºè¡¨ç¤ºèŒƒå›´æŠ›å‡ºout_of_rangeå¼‚å¸¸
### å®¹å™¨é€‚é…å™¨
å…¬å…±æ¥å£|æ„ä¹‰
-|-
size_type|å¤§å°ç±»å‹
value_type|å…ƒç´ ç±»å‹
container_type|åº•å±‚å®¹å™¨ç±»å‹
A a;|ç©ºé€‚é…å™¨
A a(c);|ä»¥cä¸ºåº•å±‚å®¹å™¨çš„é€‚é…å™¨
a.empty()|æ˜¯å¦ä¸ºç©º
a.size()|å…ƒç´ ä¸ªæ•°
swap(a, b)ã€a.swap(b)|äº¤æ¢å…ƒç´ ï¼Œè¦æ±‚åº•å±‚å®¹å™¨ç±»å‹ä¹Ÿç›¸åŒ

é€‚é…å™¨|åº•å±‚å®¹å™¨|é»˜è®¤
-|-|-
stack|vectorã€dequeã€list|deque
queue|listã€deque|deque
priority_queue|vectorã€deque|vector
```c++
stack<string> stk(deq);
stack<int, vector<int>> stk2;
```
* ä¸å¯ä½¿ç”¨åº•å±‚å®¹å™¨æ¥å£
* priority_queueä½¿ç”¨å…ƒç´ ç±»å‹çš„<è¿ç®—ç¬¦

stackæ“ä½œ|æ„ä¹‰
-|-
void stk.push(v)|å…¥æ ˆ
void stk.emplace(args)|æ„é€ å¹¶å…¥æ ˆ
stk.top()|å–æ ˆé¡¶å…ƒç´ 
void stk.pop()|å‡ºæ ˆ

é˜Ÿåˆ—æ“ä½œ|æ„ä¹‰
-|-
void q.pop()|å‡ºé˜Ÿåˆ—
q.front()ã€q.back()|å–queueå¤´ã€å°¾å…ƒç´ 
q.top()|å–priority_queueå¤´å…ƒç´ 
q.push(v)|å…¥é˜Ÿåˆ—
q.emplace(args)|æ„é€ å¹¶å…¥é˜Ÿåˆ—
## 10
* ç®—æ³•ä½¿ç”¨è¿­ä»£å™¨ï¼Œä¸ä½¿ç”¨å®¹å™¨æ“ä½œ
* ä½äºå¤´æ–‡ä»¶algorithmå’Œnumeric

ç®—æ³•|æ„ä¹‰
-|-
find(b, e, v)|è¿”å›ç¬¬ä¸€æ¬¡å‡ºç°vçš„è¿­ä»£å™¨æˆ–e
find_if(b, e, pred)|è¿”å›ç¬¬ä¸€æ¬¡predéé›¶çš„è¿­ä»£å™¨æˆ–e
count(b, e, v)|è¿”å›vå‡ºç°çš„æ¬¡æ•°
count_if(b, e, pred)|è¿”å›predéé›¶çš„æ¬¡æ•°
T acumulate(b, e, T v)|è¿”å›båˆ°eç´¯åŠ åˆ°vä¸Šçš„ç»“æœï¼Œè¦æ±‚å®ç°v+*b
bool equal(b, e, b2)|båˆ°eæ˜¯å¦ç­‰äºä»b2å¼€å§‹çš„åºåˆ—ï¼Œè¦æ±‚å®ç°\*b==*b2ï¼Œä¸”ç¬¬ä¸€ä¸ªåºåˆ—ä¸çŸ­äºç¬¬äºŒä¸ª
void fill(b, e, v)|båˆ°eéƒ½èµ‹å€¼ä¸ºv
fill_n(b, n, v)|bå¼€å§‹çš„nä¸ªå…ƒç´ èµ‹å€¼ä¸ºvï¼Œè¿”å›å°¾è¿­ä»£å™¨
copy(b, e, dest)|båˆ°eå¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
copy_if(b, e, dest, pred)|båˆ°eä¸­predéé›¶å…ƒç´ å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
remove_if(b, e, pred)|æŒ¤å‹båˆ°eä¸­predéé›¶å…ƒç´ ï¼Œè¿”å›å°¾è¿­ä»£å™¨ï¼ˆå…¶åå…ƒç´ å€¼ä¸ç¡®å®šï¼‰
remove_copy_if(b, e, dest, pred)|båˆ°eä¸­é™¤predéé›¶å…ƒç´ å¤–å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
void replace(b, e, v, v2)|båˆ°eçš„væ›¿æ¢ä¸ºv2
void replace_if(b, e, pred, v2)|båˆ°eä¸­predéé›¶å…ƒç´ æ›¿æ¢ä¸ºv2
replace_copy(b, e, dest, v, v2)|båˆ°eçš„væ›¿æ¢ä¸ºv2å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
replace_copy_if(b, e, dest, pred, v2)|båˆ°eä¸­predéé›¶å…ƒç´ æ›¿æ¢ä¸ºv2å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
void reverse(b, e)|åè½¬båˆ°e
void reverse_copy(b, e, dest)|åè½¬båˆ°eå¤åˆ¶åˆ°dest
void sort(b, e[, cmp])|æ’åºbåˆ°eï¼Œè¦æ±‚å®ç°\*b<*b
void stable_sort(b, e[, cmp])|ç¨³å®šæ’åº
unique(b, e[, cmp])|æŒ¤å‹ç›¸é‚»é‡å¤å…ƒç´ ï¼Œè¿”å›å°¾è¿­ä»£å™¨ï¼ˆå…¶åå…ƒç´ å€¼ä¸ç¡®å®šï¼‰ï¼Œè¦æ±‚å®ç°\*b==*b
unique_copy(b, e, dest)|æŒ¤å‹ç›¸é‚»é‡å¤å…ƒç´ å¤åˆ¶åˆ°destï¼Œè¿”å›å°¾è¿­ä»£å™¨
partition(b, e, pred)|å°†båˆ°eä¹‹é—´predéé›¶çš„å…ƒç´ æ”¾åœ¨å‰é¢ï¼Œè¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªfalseçš„è¿­ä»£å™¨
stable_partition(b, e, pred)|ç¨³å®šåˆ†å‰²
for_each(b, e, f)|å¯¹båˆ°eè°ƒç”¨f
transform(b, e, dest, f)|å¯¹båˆ°eè°ƒç”¨få¹¶å†™å…¥destï¼Œdestå¯ç­‰äºb
### lambda
\[æ•è·åˆ—è¡¨](å½¢å‚è¡¨) mutable -> è¿”å›ç±»å‹ { å‡½æ•°ä½“ }
* `(å½¢å‚è¡¨)`å’Œ`->è¿”å›ç±»å‹`å¯çœç•¥ï¼Œçœç•¥è¿”å›ç±»å‹æ—¶è‹¥å‡½æ•°ä½“ä»…å«ä¸€ä¸ª`return`åˆ™è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦åˆ™è¿”å›`void`ï¼ˆæ­¤è§„åˆ™ä¸ºdefectï¼‰
* lambdaç±»å‹ç”±ç¼–è¯‘å™¨ç”Ÿæˆï¼Œå˜é‡èµ‹å€¼éœ€ç”¨`auto`ï¼›æ•è·çš„å˜é‡ä½œä¸ºå…¶ç±»å‹æˆå‘˜
* å‚æ•°æ— é»˜è®¤å€¼
* æ•è·åˆ—è¡¨é€‚ç”¨äºå±€éƒ¨éé™æ€å˜é‡
* æŒ‰å€¼æ•è·ï¼šå¤åˆ¶åˆ›å»ºlambdaæ—¶çš„å˜é‡å€¼ï¼Œè€Œéè°ƒç”¨æ—¶çš„å˜é‡å€¼
* è‹¥è¦æ”¹å˜æŒ‰å€¼æ•è·çš„å˜é‡ï¼Œä¸å¯çœç•¥å½¢å‚è¡¨ï¼Œå…¶åè·Ÿ`mutable`
* æŒ‰å¼•ç”¨æ•è·ï¼šlambdaæ‰§è¡Œæ—¶è¢«å¼•ç”¨çš„å˜é‡å¿…é¡»å­˜åœ¨ï¼ˆå¤–å±‚å‡½æ•°æœªè¿”å›ï¼‰ï¼Œå› æ­¤å¤–å±‚å‡½æ•°ä¸èƒ½è¿”å›æ•è·å¼•ç”¨çš„lambda

æ•è·åˆ—è¡¨|æ„ä¹‰
-|-
[]|ä¸æ•è·å˜é‡
\[å˜é‡åˆ—è¡¨]|`å˜é‡`æŒ‰å€¼ï¼Œ`&å˜é‡`æŒ‰å¼•ç”¨ï¼Œ`,`åˆ†éš”
\[=]|å‡½æ•°ä½“å‡ºç°çš„å˜é‡æŒ‰å€¼
\[&]|å‡½æ•°ä½“å‡ºç°çš„å˜é‡æŒ‰å¼•ç”¨
\[=, å˜é‡åˆ—è¡¨]|åˆ—è¡¨ä¸­çš„å˜é‡ï¼ˆå¸¦`&`ï¼‰æŒ‰å¼•ç”¨ï¼Œå…¶ä½™æŒ‰å€¼
\[&, å˜é‡åˆ—è¡¨]|åˆ—è¡¨ä¸­çš„å˜é‡ï¼ˆä¸å¸¦`&`ï¼‰æŒ‰å€¼ï¼Œå…¶ä½™æŒ‰å¼•ç”¨
### bind
* `function`å¤´æ–‡ä»¶å®šä¹‰`bind`ã€`placeholders`ã€`ref`ã€`cref`
```c++
using namespace std::placeholders;
void old_callable(int a, int b, int c);
void f(int d) {
    auto new_callable = bind(old_callable, _2, d, _1); // å¤åˆ¶dçš„å€¼
    new_callable(3, 4); // old_callable(4, d, 3);
}
void print(ostream &os, char c);
void g(ostream &os) {
    auto ref_bind = bind(print, ref(os), _1); // ä¸å¯å¤åˆ¶çš„å¯¹è±¡å¿…é¡»ä¼ é€’å¼•ç”¨
    ref_bind('x');
}
```
### insert iterator
```c++
#include <iterator>
back_insert_iterator<T> back_inserter(T c) // push_backï¼Œè¿ç»­èµ‹å€¼åæ’
front_insert_iterator<T> front_inserter(T c) // push_frontï¼Œè¿ç»­èµ‹å€¼å‰æ’
insert_iterator<T> inserter(T c, iter) // insertï¼Œè¿ç»­èµ‹å€¼åæ’
iter = v // æ’å…¥
*iter, ++iter, iter++ // ç®€å•è¿”å›iter
```
### istream iterator
```c++
istream_iterator<int> int_iter(cin); // å®ç°å…è®¸æƒ°æ€§æ±‚å€¼ï¼Œå³æ¨è¿Ÿåˆ°*int_iteræ—¶è¯»å–è¾“å…¥æµ
istream_iterator<int> int_eof; // é»˜è®¤åˆå§‹åŒ–ä¸ºeof
// ç‰ˆæœ¬1
vector<int> v;
while(int_iter != int_eof)
    v.push_back(*int_iter++);
// ç‰ˆæœ¬2
vector<int> v(int_iter, int_eof);
```
### ostream iterator
```c++
ostream_iterator<int> iter(cout[, " "]); // ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»ä¸ºCå­—ç¬¦ä¸²
iter = 0; // è¾“å‡º
*iter, ++iter, iter++ // ç®€å•è¿”å›iter
```
### reverse iterator
```c++
reverse_iterator<vector<int>::iterator> rb(vec.end()); // vec.rbegin()
rb.base() == vec.end()
```
### 5ç§è¿­ä»£å™¨ç±»å‹
* input
* output
* forward
* bidirectional
* random-access
### åˆ—è¡¨ç‰¹å®šç®—æ³•
* ä¸ç”¨äº¤æ¢å…ƒç´ ï¼Œæ•ˆç‡é«˜äºé€šç”¨ç®—æ³•

listã€forward_listç®—æ³•|æ„ä¹‰
-|-
lst.merge(lst2[, cmp])|å½’å¹¶lst2è‡³lstï¼ˆæ¸…ç©ºlst2ï¼‰ï¼Œè¦æ±‚ä¸¤ä¸ªåˆ—è¡¨æœ‰åºï¼Œä½¿ç”¨<æˆ–cmp
lst.remove(v)ã€lst.remove_if(pred)|è°ƒç”¨eraseåˆ é™¤==væˆ–predéé›¶çš„å…ƒç´ 
lst.reverse()|åˆ—è¡¨åè½¬
lst.sort(\[cmp])|åˆ—è¡¨æ’åºï¼Œä½¿ç”¨<æˆ–cmp
lst.unique(\[pred])|è°ƒç”¨eraseåˆ é™¤ç›¸é‚»==æˆ–pred(l, r)éé›¶å…ƒç´ 

lst.spliceæˆ–flst.splice_afterçš„å‚æ•°|æ„ä¹‰
-|-
p, lst2|å°†lst2æˆ–flst2æ’å…¥lstçš„på‰æˆ–flstçš„påï¼Œæ¸…ç©ºlst2ï¼ˆå¿…é¡»ä¸ºä¸åŒåˆ—è¡¨ï¼‰
p, lst2, p2|å°†lst2çš„p2ç§»åŠ¨åˆ°lstçš„på‰ï¼Œæˆ–å°†flst2çš„p2åçš„å…ƒç´ ç§»åŠ¨åˆ°flstçš„påï¼ˆå¯ä»¥ä¸ºç›¸åŒåˆ—è¡¨ï¼‰
p, lst2, b, e|å°†lst2çš„båˆ°eç§»åŠ¨åˆ°lstçš„på‰æˆ–flstçš„påï¼ˆå¯ä»¥ä¸ºç›¸åŒåˆ—è¡¨ä½†på¿…é¡»åœ¨bã€eä¹‹å¤–ï¼‰
* ä¸Šè¿°å‡½æ•°å‡è¿”å›void
## 11
* `map`å¤´æ–‡ä»¶å®šä¹‰`map`ã€`multimap`ï¼Œ`set`å¤´æ–‡ä»¶å®šä¹‰`set`ã€`multiset`ï¼Œ`unorderd_*`å¤´æ–‡ä»¶å®šä¹‰å®ƒä»¬çš„æ•£åˆ—ç‰ˆæœ¬
* å…³è”å®¹å™¨è¿­ä»£å™¨ä¸ºbidirectional
* æœ‰åºå…³è”å®¹å™¨çš„é”®ç±»å‹å¿…é¡»æ”¯æŒ<æˆ–æŒ‡å®šæ¯”è¾ƒå‡½æ•°ï¼Œæ²¡æœ‰<å…³ç³»çš„ä¸¤ä¸ªå¯¹è±¡è®¤ä¸ºç›¸ç­‰
```c++
set<string> stop = {"a", "an", "the"};
map<string, int> count = {{"he", 3}, {"she", 2}};
bool cmp(int a, int b);
std::multiset<int, decltype(cmp) *> s(cmp); // ç¬¬äºŒä¸ªæ¨¡æ¿å‚æ•°ä¸ºå‡½æ•°æŒ‡é’ˆ
```
### pair
```c++
#include <utility>
pair<string, int> p1; // å€¼åˆå§‹åŒ–
pair<string, int> p2{"a", 1};
auto p3 = make_pair("a", 1);
auto p4 = pair<string, int>("a", 1);
p.first
p.second
p1 op p2 // å­—å…¸åº
```
### å…³è”å®¹å™¨æ“ä½œ
* set::key_type = set::value_type
* map::value_type = pair<const key_type, mapped_type>
* è¿­ä»£å™¨è§£å¼•ç”¨å¾—åˆ°value_type&
* setçš„è¿­ä»£å™¨ä¸ºconst
* å…³è”å®¹å™¨ä¸€èˆ¬ä¸ä½¿ç”¨ä½æ•ˆçš„é€šç”¨ç®—æ³•ï¼Œä½†å¯ä½œä¸ºé€šç”¨ç®—æ³•çš„æºæˆ–ç›®çš„å®¹å™¨

æ’å…¥|æ„ä¹‰
-|-
c.insert(v)ã€c.emplace(args)|æ’å…¥/æ„é€ ï¼Œå¯¹mapå’Œsetä»…å½“é”®ä¸å­˜åœ¨æ—¶æ‰§è¡Œæ’å…¥ï¼Œè¿”å›pair&lt;iterator, bool>ï¼ˆfirstæŒ‡å‘è¯¥é”®å…³è”å…ƒç´ ï¼Œè‹¥è¯¥é”®å·²å­˜åœ¨åˆ™secondä¸ºfalseï¼‰ï¼›å¯¹multimapå’Œmultisetæ‰§è¡Œæ’å…¥å¹¶è¿”å›æŒ‡å‘æ’å…¥å…ƒç´ çš„è¿­ä»£å™¨
c.insert(iter, v)ã€c.emplace(iter, args)|æ’å…¥ä½ç½®å¾ˆå¯èƒ½ä½äºiterå‰ï¼Œå¯¹mapå’Œsetè¿”å›æŒ‡å‘è¯¥é”®å…³è”å…ƒç´ çš„è¿­ä»£å™¨ï¼Œå¯¹multimapå’Œmultisetè¿”å›æŒ‡å‘æ’å…¥å…ƒç´ çš„è¿­ä»£å™¨
void c.insert(b, e)|bã€eä¸ºæŒ‡å‘value_typeçš„è¿­ä»£å™¨
void c.insert(il)|ilä¸ºvalue_typeçš„åˆå§‹åŒ–åˆ—è¡¨

åˆ é™¤|æ„ä¹‰
-|-
c.erase(key)|åˆ é™¤keyå…³è”çš„æ‰€æœ‰å…ƒç´ ï¼Œè¿”å›åˆ é™¤çš„ä¸ªæ•°
c.erase(iter)ã€c.erase(b, e)|åˆ é™¤iteræŒ‡å‘çš„/båˆ°eçš„å…ƒç´ ï¼Œè¿”å›æŒ‡å‘åˆ é™¤çš„æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„è¿­ä»£å™¨

mapã€unorderd_mapç´¢å¼•|æ„ä¹‰
-|-
mapped_type& m\[key]|è¿”å›keyå…³è”çš„å€¼çš„å¼•ç”¨ï¼ˆä¸é€‚ç”¨constå®¹å™¨ï¼‰ï¼Œè‹¥keyä¸å­˜åœ¨åˆ™æ·»åŠ keyå¹¶å€¼åˆå§‹åŒ–å€¼
mapped_type& m.at(key)|è‹¥keyå­˜åœ¨åˆ™è¿”å›å…³è”çš„å€¼å¼•ç”¨ï¼Œå¦åˆ™æŠ›å‡ºout_of_rangeå¼‚å¸¸

è®¿é—®å…ƒç´ |æ„ä¹‰
-|-
c.find(key)|è¿”å›æŒ‡å‘keyçš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨æˆ–end
c.count(key)|è¿”å›keyçš„å…ƒç´ ä¸ªæ•°
c.lower_bound(key)|è¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªé”®ä¸å°äºkeyçš„å…ƒç´ çš„è¿­ä»£å™¨
c.upper_bound(key)|è¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªé”®å¤§äºkeyçš„å…ƒç´ çš„è¿­ä»£å™¨
pair&lt;iterator, iterator> c.equal_range(key)|è¿”å›keyçš„å…ƒç´ èŒƒå›´æˆ–{end, end}
* lower_boundã€upper_boundä¸é€‚ç”¨unorderedï¼Œå¯ä½œä¸ºæ’å…¥keyçš„hint
### æ— åºå…³è”å®¹å™¨
ç®¡ç†æ“ä½œ|æ„ä¹‰
-|-
c.bucket_count()|å½“å‰æ¡¶ä¸ªæ•°
c.max_bucket_count()|æ¡¶ä¸ªæ•°æœ€å¤§å€¼
c.bucket_size(n)|nå·æ¡¶å…ƒç´ ä¸ªæ•°
c.bucket(key)|keyæ‰€åœ¨çš„æ¡¶å·
local_iterator|æ¡¶å†…è¿­ä»£å™¨ç±»å‹
const_local_iterator|æ¡¶å†…åªè¯»è¿­ä»£å™¨ç±»å‹
c.begin(n)ã€c.end(n)ã€c.cbegin(n)ã€c.cend(n)|nå·æ¡¶å†…è¿­ä»£å™¨
float c.load_factor()|å¹³å‡æ¯æ¡¶å…ƒç´ æ•°
c.max_load_factor()|è¯•å›¾ç»´æŒçš„å¹³å‡æ¯æ¡¶å…ƒç´ æ•°çš„ä¸Šé™
c.rehash(n)|é‡æ–°ç»„ç»‡ï¼Œä½¿æ¡¶ä¸ªæ•°>=nä¸”>size/max_load_factor
c.reserve(n)|é‡æ–°ç»„ç»‡ï¼Œä½¿å…ƒç´ æ•°ä¸è¶…è¿‡næ—¶æ— éœ€rehash
* å†…ç½®ç±»å‹ï¼ˆåŒ…æ‹¬æŒ‡é’ˆï¼‰ã€stringã€æ™ºèƒ½æŒ‡é’ˆå¯ç›´æ¥ç”¨ä½œkey
```c++
struct A {
    int i;
};
size_t hasher(const A &a) {
    return hash<int>()(a.i);
}
bool eq(const A &a, const A &b) {
    return a.i == b.i;
}
using A_set = unordered_set<A, decltype(hasher) *, decltype(eq) *>
A_set s(0, hasher, eq); // è‹¥Aé‡è½½äº†==åˆ™å¯çœç•¥eq
```
## 12
* `memory`å¤´æ–‡ä»¶å®šä¹‰shared_ptrã€unique_ptrã€weak_ptrã€allocator

shared_ptrã€unique_ptrå…¬å…±æ“ä½œ|æ„ä¹‰
-|-
shared_ptr&lt;T> sp; unique_ptr&lt;T> up;|æŒ‡å‘ç±»å‹Tçš„ç©ºæŒ‡é’ˆ
p|ï¼ˆä½œä¸ºæ¡ä»¶ï¼‰æ˜¯å¦éç©º
*p|è§£å¼•ç”¨
p.get()|è¿”å›è£¸æŒ‡é’ˆ
p.swap(q)ã€swap(p, q)|äº¤æ¢pã€qä¸­çš„æŒ‡é’ˆ
### shared_ptr
```c++
shared_ptr<int> p1 = make_shared<int>(); // åŠ¨æ€åˆ†é…å†…å­˜å¹¶å€¼åˆå§‹åŒ–
auto p2 = make_shared<string>(3, 'a');
auto p3(p2); // p3å’Œp2æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¼•ç”¨è®¡æ•°+1
auto p4 = make_shared<int>(1);
shared_ptr<int> p5(new int(2)); // explicit
shared_ptr<T> p6(uniq_ptr); // ä½¿uniq_pträ¸ºç©º
shared_ptr<T> p7(raw_ptr, callable); // é”€æ¯*raw_ptræ—¶ä»¥callableå–ä»£delete
p1 = p4; // p1å¼•ç”¨è®¡æ•°ä¸º0ï¼Œè‡ªåŠ¨é”€æ¯å¯¹è±¡å¹¶é‡Šæ”¾å†…å­˜
p.unique() // å¼•ç”¨è®¡æ•°æ˜¯å¦ä¸º1
p.use_count() // å¼•ç”¨è®¡æ•°ï¼Œå¯èƒ½è¾ƒæ…¢
p.reset() // ç½®ç©º
p.reset(raw_ptr[, callable])
```
* æ˜¯å¦ä½¿ç”¨å¼•ç”¨è®¡æ•°ç”±å®ç°å†³å®š
* å¤åˆ¶ã€å¤åˆ¶æ„é€ ã€è£¸æŒ‡é’ˆæ„é€ éœ€è¦æŒ‡é’ˆç±»å‹å¯è½¬æ¢
* è‡ªå®šä¹‰deleteré€‚ç”¨äºæˆå‘˜ä½¿ç”¨äº†åŠ¨æ€å†…å­˜ä½†æ— ææ„å‡½æ•°çš„å¯¹è±¡ï¼ˆå¦‚Cå¯¹è±¡ï¼‰
### å†…å­˜ç®¡ç†
```c++
string *ps1 = new string; // é»˜è®¤åˆå§‹åŒ–
string ps2 = new string(3, 'a');
int *pi = new int(); // å€¼åˆå§‹åŒ–
vector<int> *pv = new vector<int>{1, 2, 3};
auto p = new auto(obj); // å¤åˆ¶æ„é€ ï¼Œä¸å¯ç”¨{}
const int *cpi = new const int(3);
int *pn = new (nothrow) int; // å¤±è´¥è¿”å›ç©ºæŒ‡é’ˆï¼Œé»˜è®¤æŠ›å‡ºbad_allocå¼‚å¸¸
delete ps1; // ææ„+é‡Šæ”¾å†…å­˜ï¼Œå¯ä»¥æ¥å—ç©ºæŒ‡é’ˆ
```
* `new`å¤´æ–‡ä»¶å®šä¹‰nothrow
* deleteéåŠ¨æ€åˆ†é…å†…å­˜æˆ–é‡å¤deleteæ˜¯æœªå®šä¹‰è¡Œä¸º
* è‹¥ç”¨è£¸æŒ‡é’ˆåˆå§‹åŒ–shared_ptrï¼Œä¸åº”ç»§ç»­ä½¿ç”¨è£¸æŒ‡é’ˆ
* ä¸¥ç¦å¯¹getçš„æŒ‡é’ˆdeleteæˆ–åˆå§‹åŒ–å…¶ä»–æ™ºèƒ½æŒ‡é’ˆ
```c++
{
    // int *p = new int(); // æ— æ³•é‡Šæ”¾
    shared_ptr<int> p = make_shared<int>(); // æ­£å¸¸é‡Šæ”¾
    throw runtime_error();
}
```
### unique_ptr
```c++
unique_ptr<int> p1(new int(1));
// unique_ptr<int> p2(p1); // ä¸å¯å¤åˆ¶æ„é€ 
// p2 = p1; // ä¸å¯å¤åˆ¶
unique_ptr<T, D> p3, p4(raw_ptr, callable);
p = nullptr // é”€æ¯å¯¹è±¡å¹¶ç½®ç©ºp
p.release() // æ”¾å¼ƒæ‰€æœ‰æƒï¼Œè¿”å›å¯¹è±¡è£¸æŒ‡é’ˆå¹¶ç½®ç©ºp
p.reset([raw_ptr]) // é”€æ¯å¯¹è±¡ï¼Œè½¬è€ŒæŒæœ‰raw_ptræˆ–ç©º
```
* ä¸å¯å¤åˆ¶çš„ä¾‹å¤–ï¼šå‡½æ•°å¯ä»¥è¿”å›å³å°†é”€æ¯çš„unique_ptr
### weak_ptr
```c++
weak_ptr<T> p1;
weak_ptr<T> p2(sp); // ä¸shared_ptrå…±äº«å¯¹è±¡ä½†ä¸å¢åŠ å¼•ç”¨è®¡æ•°
p = wpæˆ–sp // å¯ç”¨weak_ptræˆ–shared_ptrèµ‹å€¼
p.reset() // ç½®ç©º
p.use_count() // shared_ptræ•°
p.expired() // use_countæ˜¯å¦ä¸º0
p.lock() // è‹¥expiredï¼Œè¿”å›ç©ºçš„shared_ptrï¼Œå¦åˆ™è¿”å›æŒ‡å‘è¯¥å¯¹è±¡çš„shared_ptr
```
### åŠ¨æ€æ•°ç»„
```c++
typedef string arr[10];
int *p = new arr; // æŒ‡é’ˆç±»å‹ï¼Œä¸å¯ä½¿ç”¨èŒƒå›´forã€begin/end
int *p1 = new int[3]; // é»˜è®¤åˆå§‹åŒ–
int *p2 = new int[3](); // å€¼åˆå§‹åŒ–
int *p3 = new int[3]{1, 2}; // {1, 2, 0}ï¼›å€¼åˆå§‹åŒ–
// int *p = new int[1]{1, 2}; // æŠ›å‡ºbad_array_new_lengthå¼‚å¸¸
int *p4 = new int[0];
delete[] p; // ä»åå‘å‰é”€æ¯å¯¹è±¡
unique_ptr<int[]> up(new int[3]);
up[1] // ä¸å¯ä½¿ç”¨*ã€->
shared_ptr<int> sp(new int[3], [](int *p) { delete[] p; }); // C++17æ‰å¯ä½¿ç”¨int[]
sp.get()[i]
```
* []å’Œå¾…é‡Šæ”¾æŒ‡é’ˆä¸åŒ¹é…æ˜¯æœªå®šä¹‰è¡Œä¸º
### allocator
* æŒ‰éœ€æ„é€ ï¼›é¿å…é‡å¤èµ‹å€¼ï¼›é€‚ç”¨æ— é»˜è®¤æ„é€ å‡½æ•°çš„ç±»
```c++
allocator<string> a;
auto const p = a.allocate(n); // å¯å­˜æ”¾nä¸ªstringï¼Œæœªæ„é€ 
a.construct(p + i, args) // ç”¨argsæ„é€ p[i]ï¼Œå…¶ä»–æ–¹å¼ä½¿ç”¨è¯¥å†…å­˜æ˜¯æœªå®šä¹‰è¡Œä¸º
a.destroy(p + i) // ææ„p[i]
a.deallocate(p, n) // é‡Šæ”¾å†…å­˜ï¼Œå¿…é¡»å…ˆææ„æ„é€ çš„æ‰€æœ‰å¯¹è±¡
```
* `construct`ã€`destroy`åœ¨C++17è¿‡æ—¶ï¼Œåœ¨C++20ç§»é™¤

æ„é€ ç®—æ³•|æ„ä¹‰
-|-
uninitialized_copy(b, e, dest)|båˆ°eå¤åˆ¶åˆ°æœªåˆå§‹åŒ–çš„destï¼Œè¿”å›å°¾è¿­ä»£å™¨
uninitialized_copy_n(b, n, dest)|å¤åˆ¶ä»bå¼€å§‹çš„nä¸ªå¯¹è±¡åˆ°æœªåˆå§‹åŒ–çš„destï¼Œè¿”å›å°¾è¿­ä»£å™¨
void uninitialized_fill(b, e, v)|æœªåˆå§‹åŒ–çš„båˆ°eéƒ½èµ‹å€¼ä¸ºv
uninitialized_fill_n(b, n, v)|æœªåˆå§‹åŒ–çš„bå¼€å§‹çš„nä¸ªå…ƒç´ èµ‹å€¼ä¸ºvï¼Œè¿”å›å°¾è¿­ä»£å™¨
## 13
### å¤åˆ¶æ„é€ å‡½æ•°
* ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¯¥ç±»å‹çš„å¼•ç”¨ï¼ˆå¦åˆ™ä¼ å‚ä¹Ÿéœ€è¦å¤åˆ¶æ„é€ ï¼Œæ²¡æœ‰å°½å¤´ï¼‰ï¼Œå…¶ä»–å‚æ•°æœ‰é»˜è®¤å€¼
* ç¬¬ä¸€ä¸ªå‚æ•°é€šå¸¸ä¸º`const`ï¼Œå‡½æ•°é€šå¸¸ä¸`explicit`
* æœªå®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆå¤åˆ¶æ„é€ å‡½æ•°ï¼Œé€æˆå‘˜å¤åˆ¶ï¼šç±»å˜é‡è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°ï¼Œå†…ç½®ç±»å‹å˜é‡ç›´æ¥å¤åˆ¶ï¼Œæ•°ç»„é€å…ƒç´ å¤åˆ¶ï¼ˆç±»å…ƒç´ å¤åˆ¶æ„é€ ï¼‰
### å¤åˆ¶åˆå§‹åŒ–
```c++
string s1(3, 'a'); // ç›´æ¥åˆå§‹åŒ–
string s2(s1); // ç›´æ¥åˆå§‹åŒ–ï¼Œè°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°
string s3 = s1; // å¤åˆ¶åˆå§‹åŒ–
string s4 = "x"; // éšå¼ç±»å‹è½¬æ¢+å¤åˆ¶åˆå§‹åŒ–
string s5 = string(3, 'a'); // å¤åˆ¶åˆå§‹åŒ–
```
* å¤åˆ¶åˆå§‹åŒ–è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°æˆ–ç§»åŠ¨æ„é€ å‡½æ•°
* é™¤ä½¿ç”¨`=`å®šä¹‰å˜é‡å¤–ï¼Œå¤åˆ¶åˆå§‹åŒ–è¿˜å‘ç”Ÿåœ¨ä¼ é€’éå¼•ç”¨å‚æ•°ã€è¿”å›éå¼•ç”¨å¯¹è±¡ã€åˆ—è¡¨åˆå§‹åŒ–æ•°ç»„å…ƒç´ /èšåˆç±»æˆå‘˜
* ä¸€äº›ç±»å¯¹å…¶åˆ†é…çš„å¯¹è±¡å¤åˆ¶åˆå§‹åŒ–ï¼Œå¦‚åˆå§‹åŒ–å®¹å™¨æˆ–è°ƒç”¨insertã€pushï¼Œè€Œemplaceé‡‡ç”¨ç›´æ¥åˆå§‹åŒ–
* å…è®¸ç¼–è¯‘å™¨å°†å¤åˆ¶åˆå§‹åŒ–è½¬æ¢ä¸ºç›´æ¥åˆå§‹åŒ–ï¼ˆè·³è¿‡å¤åˆ¶/ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä½†å®ƒä»¬å¿…é¡»å­˜åœ¨ä¸”å¯è®¿é—®ï¼‰
### å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦
* `ç±»& operator=(const ç±»&)`ï¼Œé€šå¸¸è¿”å›å¼•ç”¨
* æœªå®šä¹‰å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆå¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼šé€æˆå‘˜å¤åˆ¶èµ‹å€¼å¹¶è¿”å›è¢«èµ‹å€¼å¯¹è±¡çš„å¼•ç”¨
* å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ä¸€èˆ¬åŒ…å«ææ„å‡½æ•°å’Œå¤åˆ¶æ„é€ å‡½æ•°çš„åŠŸèƒ½
### ææ„å‡½æ•°
* `~ç±»() {}`ï¼Œå…ˆæ‰§è¡Œå‡½æ•°ä½“ï¼ˆä¸»è¦ä¸ºé‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼‰ï¼Œå†é”€æ¯æˆå‘˜ï¼šå†…ç½®ç±»å‹æˆå‘˜æ— åŠ¨ä½œï¼Œç±»æˆå‘˜è°ƒç”¨å…¶ææ„å‡½æ•°
* ææ„å‡½æ•°è°ƒç”¨æ—¶æœºï¼šå˜é‡ä½œç”¨åŸŸç»“æŸï¼Œæˆå‘˜æ‰€å±å¯¹è±¡é”€æ¯ï¼Œå…ƒç´ æ‰€å±å®¹å™¨é”€æ¯ï¼ŒåŠ¨æ€å†…å­˜çš„æŒ‡é’ˆdeleteï¼Œä¸´æ—¶å¯¹è±¡åˆ›å»ºçš„è¯­å¥ç»“æŸ
* æœªå®šä¹‰ææ„å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆææ„å‡½æ•°ï¼Œä¸ç©ºå‡½æ•°ä½“ææ„å‡½æ•°è¯­ä¹‰ç›¸åŒ
* åˆ†é…åŠ¨æ€å†…å­˜çš„ç±»éœ€è¦å®šä¹‰ææ„å‡½æ•°ï¼Œä¹Ÿéœ€è¦å®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°ã€å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼ˆå¦åˆ™å¤šä¸ªæŒ‡é’ˆå€¼ç›¸åŒï¼Œé”™è¯¯/å¤šæ¬¡é‡Šæ”¾å†…å­˜ï¼‰ï¼›ä¸ºé¿å…ä¸å¿…è¦çš„å¤åˆ¶å¼€é”€ï¼Œä¸€èˆ¬éœ€è¦å®šä¹‰ç§»åŠ¨æ„é€ å‡½æ•°ã€ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦
* éœ€è¦å¤åˆ¶æ„é€ å‡½æ•°çš„ç±»æœªå¿…éœ€è¦å®šä¹‰ææ„å‡½æ•°ï¼ˆå¦‚å¸¦ç‹¬ç‰¹åºå·çš„å¯¹è±¡ï¼‰ï¼Œä½†ä¸€èˆ¬éœ€è¦å®šä¹‰å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼Œåä¹‹äº¦ç„¶
### åˆæˆå‡½æ•°
* é»˜è®¤æ„é€ å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°ã€å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ã€ææ„å‡½æ•°å¯ç”¨`=default`æ˜¾å¼è®©ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆå‡½æ•°ï¼Œç±»å¤–`=default`åˆ™ä¸å†…è”
* ä»»ä½•å‡½æ•°å¯ç”¨`=delete`è®©ç¼–è¯‘å™¨ä¸å®šä¹‰è¯¥å‡½æ•°ï¼Œå¿…é¡»åœ¨ç±»å†…ï¼Œä¸€èˆ¬ç”¨äºç¦æ­¢å¤åˆ¶å¯¹è±¡
* è‹¥ææ„å‡½æ•°`=delete`ï¼Œåˆ™åªèƒ½åŠ¨æ€æ„é€ å¯¹è±¡ï¼Œä¸”ä¸èƒ½é”€æ¯
* è‹¥ç±»æœ‰æˆå‘˜çš„ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œåˆ™åˆæˆææ„å‡½æ•°`=delete`
* è‹¥ç±»æœ‰æˆå‘˜çš„å¤åˆ¶æ„é€ å‡½æ•°æˆ–ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œåˆ™åˆæˆå¤åˆ¶æ„é€ å‡½æ•°`=delete`
* è‹¥ç±»æœ‰æˆå‘˜çš„å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œæˆ–æœ‰æˆå‘˜ä¸º`const`æˆ–å¼•ç”¨ï¼Œåˆ™åˆæˆå¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦`=delete`
* è‹¥ç±»æœ‰æˆå‘˜çš„ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œæˆ–æœ‰æˆå‘˜ä¸ºå¼•ç”¨ä½†æ²¡æœ‰ç±»å†…åˆå€¼ï¼Œæˆ–æœ‰æˆå‘˜ä¸º`const`ä½†æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ä¸”æ²¡æœ‰ç±»å†…åˆå€¼ï¼Œåˆ™åˆæˆå¤åˆ¶æ„é€ å‡½æ•°`=delete`
* C++11å‰é€šè¿‡å£°æ˜å‡½æ•°ä¸º`private`ä½†ä¸æä¾›å®šä¹‰ï¼Œå¯è¾¾åˆ°`=delete`æ•ˆæœï¼ˆç±»å†…ã€å‹å…ƒä½¿ç”¨è¯¥å‡½æ•°äº§ç”Ÿé“¾æ¥é”™è¯¯ï¼‰
### æ·±æ‹·è´
```c++
class A {
    string *p;
public:
    A(const string &s = string()): p(new string(s)) {}
    A(const A &a): p(new string(*a.p)) {}
    A& operator=(const A &a) {
        auto temp = new string(*a.p); // å¤„ç†a=açš„æƒ…å†µï¼Œä¸”ä¸åœ¨å¼‚å¸¸å‘ç”Ÿå‰ä¿®æ”¹this
        delete p;
        p = temp;
        return *this;
    }
    ~A() {
        delete p;
    }
    friend void swap(A &a, A &b);
    A(A &&a) noexcept;
    A& operator=(A &&a) noexcept;
};
inline void swap(A &a, A &b) { // é¿å…3æ¬¡æ·±æ‹·è´
    using std::swap; // åç»­swapè°ƒç”¨è‡ªåŠ¨é€‰æ‹©åº“/è‡ªå®šä¹‰ç‰ˆæœ¬
    swap(a.p, b.p);
}
```
### æµ…æ‹·è´ï¼ˆå¼•ç”¨è®¡æ•°ï¼‰
```c++
class A {
    string *p;
    size_t *count;
public:
    A(const string &s = string()): p(new string(s)), count(new size_t(1)) {}
    A(const A &a): p(a.p), count(a.count) { ++*count; }
    A& operator=(const A &a) {
        ++*a.count;
        if(--*count == 0) {
            delete p;
            delete count;
        }
        p = a.p;
        count = a.count;
        return *this;
    }
    ~A() {
        if(--*count == 0) {
            delete p;
            delete count;
        }
    }
};
```
### swapå®ç°å¤åˆ¶/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦
```c++
A& operator=(A a) { // å¤åˆ¶æ„é€ ï¼Œè‡ªåŠ¨è§£å†³a=aå’Œå¼‚å¸¸é—®é¢˜
    swap(*this, a);
    return *this;
}
```
### å³å€¼å¼•ç”¨
```c++
int i = 0;
int &&r1 = i * 1; // å³å€¼
// int &&r2 = i; // é”™è¯¯ï¼šä¸å¯ç»‘å®šå·¦å€¼
// int &&r3 = r1; // é”™è¯¯ï¼šå³å€¼å¼•ç”¨å˜é‡ä¹Ÿæ˜¯å·¦å€¼
int &&r4 = move(i); // å·¦å€¼è½¬ä¸ºå³å€¼ï¼Œä¹‹åä¸å¯å†ä½¿ç”¨içš„å€¼
```
* å¼•ç”¨çš„å¯¹è±¡æ˜¯ä¸´æ—¶å¯¹è±¡ï¼Œæ²¡æœ‰å…¶ä»–ä½¿ç”¨è€…ï¼Œå³å°†è¢«é”€æ¯
* å¤´æ–‡ä»¶`utility`å®šä¹‰`move`ï¼Œè½¬ç§»å¯¹è±¡æŒæœ‰çš„åŠ¨æ€å†…å­˜å¹¶ä¿è¯å¯¹è±¡å¯å®‰å…¨é”€æ¯
* å³å€¼å¼•ç”¨å˜é‡è‹¥è¦ä½œä¸ºå³å€¼ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼Œéœ€è¦ä½¿ç”¨`move`
* ä¼ é€’å³å€¼å‚æ•°ï¼ˆéconst T&&ï¼‰æ—¶ï¼Œf(T)å’Œf(const T&)å†²çªï¼Œf(T)å’Œf(T&&)å†²çªï¼Œf(const T&)å’Œf(T&&)åŒ¹é…åè€…
### ç§»åŠ¨æ„é€ å‡½æ•°
* ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¯¥ç±»å‹çš„å³å€¼å¼•ç”¨ï¼Œå…¶ä»–å‚æ•°æœ‰é»˜è®¤å€¼
```c++
// æ¥æ·±æ‹·è´A
A::A(A &&a) noexcept : p(a.p) {
    a.p = nullptr; // ä¿è¯è¢«ç§»åŠ¨å¯¹è±¡å¯é”€æ¯ã€å€¼æœ‰æ•ˆ
}
```
* å®¹å™¨æ“ä½œä¿è¯å¼‚å¸¸å‘ç”Ÿæ—¶å®¹å™¨å†…å®¹ä¸å˜ï¼Œå¦‚`vector`é‡æ–°åˆ†é…å†…å­˜å¤±è´¥ä¸å½±å“åŸå…ˆå†…å®¹ï¼›è‹¥è¦åœ¨é‡æ–°åˆ†é…æ—¶ç§»åŠ¨è€Œéå¤åˆ¶å…ƒç´ ï¼Œå…ƒç´ ç±»å‹çš„ç§»åŠ¨æ„é€ å‡½æ•°å¿…é¡»ä¸º`noexcept`
### ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦
```c++
// æ¥æ·±æ‹·è´A
A& A::operator=(A &&a) noexcept {
    if(this != &a) { // aæœ‰å¯èƒ½é€šè¿‡moveå¾—åˆ°
        delete p;
        p = a.p;
        a.p = nullptr;
    }
    return *this;
}
```
### ç§»åŠ¨ä¸å¤åˆ¶
* è‹¥æœªå®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°ã€å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦å’Œææ„å‡½æ•°ï¼Œä¸”æˆå‘˜å‡å¯ç§»åŠ¨æ„é€ /èµ‹å€¼ï¼Œåˆ™ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆç§»åŠ¨æ„é€ å‡½æ•°/åˆæˆç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦
* è‹¥å®šä¹‰äº†ç§»åŠ¨æ„é€ å‡½æ•°/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼Œåˆ™åˆæˆå¤åˆ¶æ„é€ å‡½æ•°/åˆæˆå¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦`=delete`
* ç¼–è¯‘å™¨é»˜è®¤ä¸ç”Ÿæˆ`=delete`åˆæˆç§»åŠ¨å‡½æ•°ï¼Œé™¤éæ˜¾å¼æŒ‡å®šç§»åŠ¨å‡½æ•°ä¸º`=default`ä¸”æœ‰æˆå‘˜æ— æ³•ç§»åŠ¨ï¼ˆè§ä¸‹ï¼‰
* è‹¥ç±»æœ‰æˆå‘˜çš„ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ææ„å‡½æ•°`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œåˆ™åˆæˆç§»åŠ¨æ„é€ å‡½æ•°`=delete`
* è‹¥ç±»æœ‰æˆå‘˜çš„ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦`=delete`æˆ–ä¸å¯è®¿é—®ï¼Œæˆ–æœ‰æˆå‘˜ä¸º`const`æˆ–å¼•ç”¨ï¼Œåˆ™åˆæˆç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦`=delete`
* å¤åˆ¶ã€ç§»åŠ¨å‡½æ•°åŒæ—¶å­˜åœ¨æ—¶ï¼Œå·¦å€¼åŒ¹é…å¤åˆ¶å‡½æ•°ï¼Œå³å€¼åŒ¹é…ç§»åŠ¨å‡½æ•°ï¼›åªæœ‰å¤åˆ¶å‡½æ•°æ—¶ä¸€å¾‹å¤åˆ¶ï¼ˆåŒ…æ‹¬ä½¿ç”¨`move`ï¼‰
### ç§»åŠ¨è¿­ä»£å™¨
```c++
move_iterator<T> make_move_iterator(T iter)
```
* è§£å¼•ç”¨è¿”å›å³å€¼å¼•ç”¨ï¼Œå¯ç”¨äº`uninitialized_copy`å®ç°ç§»åŠ¨è¯­ä¹‰
* æ ‡å‡†åº“ä¸ä¿è¯å“ªä¸ªç®—æ³•å¯ä»¥ä½¿ç”¨ç§»åŠ¨è¿­ä»£å™¨
### å·¦/å³å€¼å¼•ç”¨æˆå‘˜å‡½æ•°
```c++
class A {
    void f() &; // å·¦å€¼å¯è°ƒç”¨
    void g() &&; // å³å€¼å¯è°ƒç”¨
    void h() const &; // constå¿…é¡»å‡ºç°åœ¨å·¦è¾¹
}
void A::f() & {} // å£°æ˜å’Œå®šä¹‰çš„&å¿…é¡»ä¸€è‡´
```
* å¼•ç”¨æˆå‘˜å‡½æ•°å’Œå‚æ•°ç›¸åŒçš„æ™®é€šæˆå‘˜å‡½æ•°å†²çª
