# MBR
* 第一个扇区，512B
* BIOS将引导代码加载到内存0x7c00，并跳转到该地址

长度|意义
-|-
446|引导代码
16*4|分区表
2|0x55 0xaa 启动标志

* 440B开始的4B为磁盘标识符
## 分区表项
长度|意义
-|-
1|启动标志，0x80系统分区，0x00不可启动
3|第一个扇区的CHS地址
1|分区类型
3|最后一个扇区的CHS地址
4|第一个扇区的LBA地址
4|扇区个数

分区类型|意义
-|-
0x00|空
0x05|CHS扩展分区
0x07|Windows
0x0f|LBA扩展分区
0x17|隐藏文件系统
0x82|Linux swap
0x83|Linux
0x8e|Linux LVM
0xee|PMBR，指示GPT

* CHS地址的第1个字节为H，第2个字节低6位为S，高2位（C的最高2位）和第3个字节为C
* LBA = (C * HPC + H) * SPT + S - 1
* CHS最多支持`2^10*2^8*(2^6-1)*512B`约为8GB的磁盘，对小于该限制的磁盘CHS和LBA必须匹配，对超出该限制的磁盘应使`C=1023, H=254/255, S=63`
* LBA最多支持`2^32*512B`约为2TB的磁盘
# GPT
LBA|意义
-|-
0|Protective MBR
1|GPT头
2~33|分区表
34~-34|分区
-33~-2|分区表
-1|GPT头

* UEFI规定分区表至少16384B，对于512B扇区即为32个
* 分区表项128B
## PMBR
* 防止基于MBR的磁盘工具误识别并覆写GPT
* 分区类型0xee，范围覆盖整个磁盘（可被MBR表示的范围）
## Hybrid MBR
* 对支持GPT+BIOS启动的OS，MBR仍可存储第一阶段的bootloader代码
* bootloader必须识别GPT，并不能假设512B扇区
## GPT头
长度|意义
-|-
8|标志：EFI PART
4|修订版，对GPT 1.0为0x10000
4|头长度，一般0x5c
4|头部CRC32，计算时置0
4|保留，必须为0
8|当前GPT头LBA
8|另一GPT头LBA
8|第一个可用于分区的LBA
8|最后一个可用于分区的LBA
16|混合端序的GUID
8|分区表项起始LBA
4|分区表项数
4|分区表项大小，一般0x80
4|分区表CRC32
剩余|保留，必须为0
## 分区表项
长度|意义
-|-
16|混合端序的分区类型GUID
16|混合端序的分区GUID
8|第一个LBA
8|最后一个LBA
8|属性标志
72|分区名，36个UTF16-LE
## 属性标志
比特|意义
-|-
0|平台需要的分区，磁盘分区工具应保留此分区
1|EFI固件应忽略此分区
2|可BIOS启动，等价于MBR分区表的启动标志
3-47|保留，未来使用
48-63|由特定分区类型定义、使用
